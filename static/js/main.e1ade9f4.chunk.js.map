{"version":3,"sources":["config/default/favicon-96x96.png","components/WidthProvider.jsx","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/ViewErrors.js","components/MouseOver.js","helpers/trace.js","helpers/OfficeGraph/index.js","helpers/LaunchPad.js","components/ViewTeams.js","config/index.js","helpers/index.js","components/BreakPointSelector.js","components/AddBoard.js","App.js","Home.js","Onboard.js","authenticate.js","helpers/License.js","components/DragableDetailsList.js","helpers/UserContext.js","index.js","components/ToolboxLayout.js"],"names":["module","exports","WidthProvider","ComposedComponent","fixedWidth","state","width","mounted","onWindowResize","node","ReactDOM","findDOMNode","HTMLElement","setState","offsetWidth","this","window","addEventListener","removeEventListener","prevProps","prevState","props","measureBeforeMount","rest","className","style","React","Component","defaultProps","Tags","references","display","flexWrap","map","group","key","padding","margin","backgroundColor","color","textColor","title","Highlight","text","filter","ix","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","tile","useState","tileSize","border","maxWidth","textcolor","height","maxHeight","borderRadius","overflow","cursor","onClick","marginTop","src","icon","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","ViewErrors","errors","error","context","JSON","stringify","theme","ContextualMenu","getTheme","EVENT","mergeStyleSets","container","flexFlow","header","fonts","xLargePlus","flex","borderTop","palette","themePrimary","neutralPrimary","fontWeight","FontWeights","semibold","body","overflowY","selectors","p","marginBottom","neutralDark","LANDING","ONBOARDING","SEARCHING","SEARCHCLICKED","TILECLICKED","TABCLICKED","DETAILSTOGGLED","MEMBERSHIPSREAD","who","upn","amplitude","amp","getInstance","setUserId","s","split","setDomain","trace","event","details","logEvent","console","log","Object","freeze","graph","analyseMembers","token","emailAddresses","cb","addresses","forEach","element1","element2","match","smtp","push","checked","results","x","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","response","addcrm","tag","msg","properties","property","value","post2","addmember","userId","groupId","getSharePointList","host","site","list","listfilter","itemfilter","get","items","itemList","next","item","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","readManager","userPrincipalName","index","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","_","find","targetFolders","destFolder","newDoc","parentReference","result","sourceGroupId","lookupFile","iterations","file","iteration","setTimeout","Client","url","options","Promise","resolve","reject","payload","patch","axios","headers","authorization","then","data","catch","put","getRaw","request","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","get2","put2","me","MyTeams","readTeam","getMyExtention","extensionName","getOneDriveFolder","folderNameWithOutInitialSlash","getOneDriveFolderContent","getOneDriveFile","filename","a","folder","saveOneDriveFile","createOneDriveFolder","createOneDriveFolderChild","parentFolderNameWithOutInitialSlash","driveItem","saveMyExtention","updateMyExtention","r","addMyExtention","patch2","teamMemberships","reportProgessPercent","client","memberships","pending","total","processed","readGroup","sort","b","displayName","description","photo","creationOptions","v","hasYammer","hasSharePoint","resourceProvisioningOptions","readChannels","channels","readEndpoints","endPoints","hasTeams","undefined","queue","channel","tabs","appendTo","retrycount","parsedBody","errCounter","parse","followNextLink","skipNextLink","concat","sessionStorage","getItem","extentionName","OURPATH","BOARDSPATH","BOARDS","OURCONFIGFILENAME","BOARDINDEXFILENAME","saveCache","membershipIndex","membership","cachedFileName","readCache","verifyAccessForLanuchPad","setCheckMe","setCheckMyExtention","setCheckOneDrive","setCheckOneDriveFiles","setCheckMemberships","setCheckTeam","checkAccessToConfig","version","projectInfo","message","checkAccessToContexts","m","hello","extention","teamId","member","buffer","layouts","delaywriteLayouts","writing","writeLayouts","isEqual","current","readBoards","ctx","fullname","content","myTeams","team","getHref","readLayouts","readBoardFiles","files","Axios","webUrl","uniqueEndPoints","groupBy","endPoint","providerName","jumpto","uri","part2","part4","part5","threadId","tenantId","conversationsHref","teamsLink","readIndexOfLaunzhBoards","breakpointColumnsObj","default","3600","3300","3000","2700","2400","2100","1800","1500","1200","900","600","ViewTeams","viewDates","memberShips","cloneDeep","tiles","sortBy","minWidth","breakpointCols","columnClassName","ViewTeam","viewChannels","onSaveTeam","clientId","directoryId","scopes","logo","defaultTableAPI","niels","teamsIntegration","components","borderBottom","position","left","top","zIndex","textDecoration","marginRight","getSearchParametersFromHRef","search","s1","s2","s3","decodeURIComponent","inIframe","self","BreakPointSelector","breakPoints","breakpoints","keys","breakPoint","selected","onSelect","dialogContentProps","mergeStyles","hiddenContentStyle","type","DialogType","normal","closeButtonAriaLabel","subText","AddBoard","hideDialog","setHideDialog","setName","useId","Dialog","hidden","onDismiss","TextField","autoFocus","label","onChange","newValue","placeholder","xiconProps","iconName","DialogFooter","PrimaryButton","disabled","onAdd","DefaultButton","logSearchTimer","searchInfo","dragOptions","moveMenuItemText","closeMenuItemText","menu","cancelIcon","contentStyles","minHeight","iconButtonStyles","root","rootHovered","initializeIcons","App","inFrame","searchIconRef","useRef","config","upnIs","showTabFeature","titlegraphics","setTitlegraphics","_setFilter","setSearch","setTiles","isZoomed","setIsZoomed","setCurrentTile","myTools","setMyTeams","ztickyRef","setZtickyRef","setErrors","setMemberships","contexts","setContexts","board","selectedBoard","setSelectedBoard","refreshing","setRefresing","progress","setProgress","progressPercent","setProgressPercent","showTable","showFilterOptions","tableUrl","setTableUrl","lg","setLayouts","setJoinedTeams","refreshCounter","setRefreshCounter","tags","showDetails","_setShowDetails","showCatalogue","_setShowCatalogue","editMode","_setEditMode","isFixedWidth","isLoaded","setIsLoaded","selectedGroup","setGroups","isModalOpen","setIsModalOpen","selectedBreakPoint","setSelectedBreakPoint","isMounted","setIsMounted","isDirty","setIsDirty","showWarning","setShowWarning","indexLaunzhContexts","setIndexLaunzhContexts","myDrive","setMyDrive","addingBoard","setAddingBoard","gotoBoard","boardName","location","setEditMode","on","setFilter","startsWith","removePin","pinId","splice","i","toString","addPin","_team","y","w","h","showSearch","readGrid","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","sortKey","toLower","correlation","initGraph","refresh","queueCount","teams","localCache","localStorage","cachedMemberships","setItem","percent","matchFilter","subTitle","boardFileName","useEffect","document","ztickyref","ctxs","endsWith","l","defaultTableKey","drive","load","filteredTiles","filteredMyTools","filteredMemberShips","URL","include","visibility","matchTeam","clearTimeout","editorCanvasWidth","ProgressIndicator","percentComplete","xlabel","xdescription","bottom","right","paddingRight","Dropdown","selectedKey","onChanged","option","styles","dropdown","xmarginTop","IconButton","iconProps","ariaLabel","saveLayout","Toggle","CommandBar","farItems","iconOnly","subMenuProps","navigate","signOut","ref","Spinner","MessageBar","messageBarType","MessageBarType","warning","isMultiline","dismissButtonAriaLabel","xactions","MessageBarButton","Coachmark","positioningContainerProps","directionalHint","DirectionalHint","topAutoEdge","doNotLayer","ariaAlertText","ariaDescribedBy","ariaLabelledBy","ariaDescribedByText","ariaLabelledByText","ToolboxLayout","tools","persist","newLayouts","getPin","parseInt","onRemovePin","onTileClick","Modal","titleAriaId","isOpen","isBlocking","containerClassName","xdragOptions","onSaveChannel","identify","messageBeforeLaunch","borderLeft","float","Office","initialize","joinedTeams","actions","Onboard","checkMe","checkMemberships","checkTeam","checkMyExtention","checkOneDrive","checkOneDriveFiles","run","dir","storageProvider","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","getReturnPath","subPath","hostname","protocol","port","selectAccount","client_id","scope","redirect_uri","removeItem","authenticate","callBackNotifyIfInteractionIsRequired","seq","getSearchParametersFromHash","search2","id_token","access_token","login","exp","expiresIn","moment","diff","isAccessTokenExpired","handled","error_description","expires","add","expires_in","toISOString","reload","getLicenseForUPN","domain","overflowProps","dragEnterClass","neutralLight","UserContext","Consumer","ErrorBoundary","hasError","info","primary","viewDetails","componentStack","readOnly","rows","cols","children","loadTheme","defaultFontStyle","fontFamily","small","medium","large","xLarge","Container","GotoDefault","GetAdminConsented","getAdminConsent","AdminConsented","SignedOut","SignOut","NoPage","Debug","InteractionRequired","interactionRequired","SpeedDateApp","setAuth","setLicense","setInteractionRequired","license","Customizer","FluentCustomizations","Fabric","render","getElementById","start","ResponsiveReactGridLayout","md","sm","xs","xxs","onBreakpointChange","breakpoint","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","compactType","onTakeItem","onPutItem","onLayoutChange","layout","global","onNewLayout","generateLayout","onResize","tool","Responsive","that","Date","now","editingLayout","data-grid","static","containerPadding","useCSSTransforms","preventCollision","isDraggable","isResizable","generateDOM","range","Math","ceil","random","floor","rowHeight","initialLayout"],"mappings":"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","file":"static/js/main.e1ade9f4.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII=\"","\r\nimport React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\n\r\n\r\n\r\n/*\r\n * A simple HOC that provides facility for listening to container resizes.\r\n */\r\nexport default function WidthProvider(\r\n  ComposedComponent,fixedWidth\r\n) {\r\n  return class WidthProvider extends React.Component {\r\n    static defaultProps = {\r\n      measureBeforeMount: false\r\n    };\r\n\r\n    static propTypes = {\r\n      // If true, will not render children until mounted. Useful for getting the exact width before\r\n      // rendering, to prevent any unsightly resizing.\r\n      measureBeforeMount: PropTypes.bool\r\n    };\r\n\r\n    state = {\r\n      width: 1200\r\n    };\r\n\r\n    mounted = false;\r\n\r\n    componentDidMount() {\r\n      this.mounted = true;\r\n\r\n      window.addEventListener(\"resize\", this.onWindowResize);\r\n      // Call to properly set the breakpoint and resize the elements.\r\n      // Note that if you're doing a full-width element, this can get a little wonky if a scrollbar\r\n      // appears because of the grid. In that case, fire your own resize event, or set `overflow: scroll` on your body.\r\n      this.onWindowResize();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      this.mounted = false;\r\n      window.removeEventListener(\"resize\", this.onWindowResize);\r\n    }\r\n    componentDidUpdate(prevProps,prevState) {\r\n      //debugger\r\n      if (this.props.fixedWidth && (this.props.fixedWidth  !== prevProps.fixedWidth) ){\r\n        //debugger\r\n        this.setState({width:this.props.fixedWidth })\r\n      }\r\n      \r\n    }\r\n    onWindowResize = () => {\r\n      if (!this.mounted) return;\r\n      // eslint-disable-next-line react/no-find-dom-node\r\n      const node = ReactDOM.findDOMNode(this); // Flow casts this to Text | Element\r\n            \r\n      if (node instanceof HTMLElement)\r\n        this.setState({ width:  node.offsetWidth < 1200 ? node.offsetWidth : 1200 });\r\n    };\r\n\r\n    render() {\r\n      const { measureBeforeMount, ...rest } = this.props;\r\n      if (measureBeforeMount && !this.mounted) {\r\n        return (\r\n          <div className={this.props.className} style={this.props.style} />\r\n        );\r\n      }\r\n\r\n      return <ComposedComponent {...rest} {...this.state} />;\r\n    }\r\n  };\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nexport const Tags = props => {\r\n  if (props && props.references) {\r\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\r\n      {props.references.map((group,key) => {\r\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\r\n          {group.title}\r\n        </div>;\r\n      })}\r\n    </div>);\r\n  }\r\n  else {\r\n    return null;\r\n  }\r\n};\r\nTags.propTypes = {\r\n  references: PropTypes.array\r\n};\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nexport const Highlight = props => {\r\n  \r\nif (!props.text) return null\r\nif (!props.filter) return  props.text\r\n\r\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\r\n   if (ix===-1){\r\n     return props.text\r\n   }\r\n\r\n   \r\n   var first = props.text.substr(0,ix)\r\n   var middle = props.text.substr(ix,props.filter.length)\r\n   var last = props.text.substr(ix+props.filter.length)\r\n  return (\r\n    <>\r\n   \r\n      <span>{first}</span>\r\n      <span style={props.style}>{middle}</span>\r\n       <span>{last}</span>\r\n    \r\n    </>\r\n  );\r\n};\r\nHighlight.propTypes = {\r\n  style: PropTypes.object,\r\n\r\n  filter: PropTypes.string,\r\n  text: PropTypes.string\r\n};\r\n","import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Tags } from \"./Tags\";\r\nimport { Highlight } from \"./Highlight\";\r\nimport  \"./tile.css\"\r\nexport const AppSuperTile = props => {\r\n  var tile = props.tile ? props.tile : {};\r\n  const [html, setHtml] = useState(\"\");\r\n\r\n  return (<>\r\n\r\n  {props.tileSize===1 &&\r\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\r\n     \r\n     <div  style={{\r\n       \r\n       margin: 10,\r\n       padding: 10,\r\n       backgroundColor: tile.color,\r\n       color: tile.textcolor,\r\n       width: 300,\r\n       height: 70,\r\n       maxHeight: 70,\r\n       borderRadius:35,\r\n       overflow: \"hide\"\r\n       \r\n     }}>\r\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\r\n         if (props.onClick){\r\n           props.onClick(tile);\r\n                }\r\n   \r\n       }}>\r\n         <div style={{display:\"flex\"}}>\r\n           \r\n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\r\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\r\n         </div>\r\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\r\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \r\n           </div>\r\n          \r\n         <div style={{alignItems:\"flex-end\"}}>\r\n         <i\r\n                   style={{cursor:\"pointer\",display:\"none\"}}\r\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\r\n                     onClick={(e) => {\r\n                       if (props.onPinnedClicked){\r\n                         e.preventDefault()\r\n                         e.stopPropagation()\r\n                         props.onPinnedClicked(props)\r\n                       }\r\n                       \r\n                     }}\r\n                     aria-hidden=\"true\"\r\n                   ></i> \r\n         </div> </div>\r\n       \r\n         {/* <Tags references={tile.references} /> */}\r\n   \r\n       </div>\r\n     </div>\r\n     \r\n\r\n     </div>\r\n  }\r\n  {props.tileSize === 0 &&\r\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\r\n     \r\n  <div style={{\r\n    margin: 10,\r\n    padding: 10,\r\n    backgroundColor: tile.color,\r\n    color: tile.textcolor,\r\n    width: 300,\r\n    height: 300,\r\n    maxHeight: 300,\r\n    overflow: \"auto\"\r\n  }}>\r\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\r\n      if (props.onClick){\r\n        props.onClick(tile);\r\n             }\r\n\r\n    }}>\r\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\r\n      <div style={{alignItems:\"flex-end\"}}>\r\n      <i\r\n                style={{cursor:\"pointer\",display:\"none\"}}\r\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\r\n                  onClick={(e) => {\r\n                    if (props.onPinnedClicked){\r\n                      e.preventDefault()\r\n                      e.stopPropagation()\r\n                      props.onPinnedClicked(props)\r\n                    }\r\n                    \r\n                  }}\r\n                  aria-hidden=\"true\"\r\n                ></i> \r\n      </div>\r\n      </div>\r\n      \r\n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\r\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\r\n      </div>\r\n\r\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\r\n    \r\n\r\n        {tile.inShort}\r\n      </div>\r\n       <Tags references={tile.references} /> \r\n\r\n    </div>\r\n  </div>\r\n  \r\n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\r\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\r\n          Jump to\r\n            </a>)} */}\r\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\r\n           More info\r\n            </a>)}\r\n      </div>\r\n  </div>\r\n  }\r\n  </>);\r\n};\r\nAppSuperTile.propTypes = {\r\n  tile: PropTypes.object,\r\n  onClose: PropTypes.func,\r\n  filter : PropTypes.string,\r\n  highlightStyle : PropTypes.object,\r\n  isPinned : PropTypes.bool,\r\n  onPinnedClicked:PropTypes.func,\r\n  tileSize:PropTypes.number\r\n};\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nexport const ViewErrors = props => {\r\n  if (props && props.errors) {\r\n    return (<div className=\"tags\" >\r\n      {props.errors.map((error,key) => {\r\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", }}>\r\n          When trying {error.context}, you got \r\n          {JSON.stringify(error)}\r\n        </div>;\r\n      })}\r\n    </div>);\r\n  }\r\n  else {\r\n    return null;\r\n  }\r\n};\r\nViewErrors.propTypes = {\r\n  errors: PropTypes.array\r\n};\r\n","import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport \"./groupover.css\";\r\nimport {\r\n  getTheme,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n} from \"office-ui-fabric-react\";\r\nconst dragOptions = {\r\n  moveMenuItemText: \"Move\",\r\n  closeMenuItemText: \"Close\",\r\n  menu: ContextualMenu,\r\n};\r\nconst cancelIcon = { iconName: \"Cancel\" };\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n  container: {\r\n    display: \"flex\",\r\n    flexFlow: \"column nowrap\",\r\n    alignItems: \"stretch\",\r\n  },\r\n  header: [\r\n    // tslint:disable-next-line:deprecation\r\n    theme.fonts.xLargePlus,\r\n    {\r\n      flex: \"1 1 auto\",\r\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n      color: theme.palette.neutralPrimary,\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      fontWeight: FontWeights.semibold,\r\n      padding: \"12px 12px 14px 24px\",\r\n    },\r\n  ],\r\n  body: {\r\n    flex: \"4 4 auto\",\r\n    padding: \"0 24px 24px 24px\",\r\n    overflowY: \"hidden\",\r\n    selectors: {\r\n      p: { margin: \"14px 0\" },\r\n      \"p:first-child\": { marginTop: 0 },\r\n      \"p:last-child\": { marginBottom: 0 },\r\n    },\r\n  },\r\n});\r\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\r\nconst iconButtonStyles = {\r\n  root: {\r\n    color: theme.palette.neutralPrimary,\r\n    marginLeft: \"auto\",\r\n    marginTop: \"4px\",\r\n    marginRight: \"2px\",\r\n  },\r\n  rootHovered: {\r\n    color: theme.palette.neutralDark,\r\n  },\r\n};\r\nexport const GroupMouseOver = (props) => {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  return (\r\n    <div className=\"groupOver\">\r\n      <div className=\"groupOverLink\">\r\n        <div style={{ display: \"flex\" }}>\r\n          <div\r\n            style={{ flexGrow: 1 }}\r\n            onClick={(e) => {\r\n              setIsModalOpen(true);\r\n              e.preventDefault();\r\n            }}\r\n          >\r\n            Open{\" \"}\r\n          </div>\r\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              \r\n              if (props.onSave) {\r\n                props.onSave();\r\n              }\r\n            }}\r\n          >\r\n            Save\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        titleAriaId={1}\r\n        isOpen={isModalOpen}\r\n        onDismiss={() => setIsModalOpen(false)}\r\n        isBlocking={false}\r\n        containerClassName={contentStyles.container}\r\n        dragOptions={dragOptions}\r\n      >\r\n        <div>\r\n          <span>Lorem Ipsum</span>\r\n          <IconButton\r\n            styles={iconButtonStyles}\r\n            iconProps={cancelIcon}\r\n            ariaLabel=\"Close popup modal\"\r\n            onClick={() => setIsModalOpen(false)}\r\n          />\r\n        </div>\r\n        <div className={contentStyles.body}></div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nexport const PinMouseOver = (props) => {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  return (\r\n    <div className=\"groupOver\" style={{zIndex:3}}>\r\n      <div className=\"groupOverLink\">\r\n        <div style={{ display: \"flex\" }}>\r\n          <div\r\n            style={{ flexGrow: 1 }}\r\n            onClick={(e) => {\r\n              setIsModalOpen(true);\r\n              e.preventDefault();\r\n            }}\r\n          >\r\n            Open{\" \"}\r\n          </div>\r\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\r\n            onClick={(e) => {\r\n              \r\n              e.preventDefault();\r\n              \r\n              if (props.onRemove) {\r\n                props.onRemove();\r\n              }\r\n            }}\r\n          >\r\n            Remove\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        titleAriaId={1}\r\n        isOpen={isModalOpen}\r\n        onDismiss={() => setIsModalOpen(false)}\r\n        isBlocking={false}\r\n        containerClassName={contentStyles.container}\r\n        dragOptions={dragOptions}\r\n      >\r\n        <div>\r\n          <span>Lorem Ipsum</span>\r\n          <IconButton\r\n            styles={iconButtonStyles}\r\n            iconProps={cancelIcon}\r\n            ariaLabel=\"Close popup modal\"\r\n            onClick={() => setIsModalOpen(false)}\r\n          />\r\n        </div>\r\n        <div className={contentStyles.body}></div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n","export const EVENT = {\r\n  LANDING: \"landing\",\r\n  ONBOARDING: \"onboarding\",\r\n  SEARCHING: \"user-searched-for\",\r\n  SEARCHCLICKED: \"user-clicked-search\",\r\n  TILECLICKED: \"user-clicked-tile\",\r\n  TABCLICKED: \"user-clicked-tab\",\r\n  DETAILSTOGGLED: \"user-toggle-details\",\r\n  MEMBERSHIPSREAD:\"memberships-read\"\r\n};\r\nObject.freeze(EVENT);\r\n// var d = [\r\n//     \"init\",\r\n//     \"logEvent\",\r\n//     \"logRevenue\",\r\n//     \"setUserId\",\r\n//     \"setUserProperties\",\r\n//     \"setOptOut\",\r\n//     \"setVersionName\",\r\n//     \"setDomain\",\r\n//     \"setDeviceId\",\r\n//     \"enableTracking\",\r\n//     \"setGlobalUserProperties\",\r\n//     \"identify\",\r\n//     \"clearUserProperties\",\r\n//     \"setGroup\",\r\n//     \"logRevenueV2\",\r\n//     \"regenerateDeviceId\",\r\n//     \"groupIdentify\",\r\n//     \"onInit\",\r\n//     \"logEventWithTimestamp\",\r\n//     \"logEventWithGroups\",\r\n//     \"setSessionId\",\r\n//     \"resetSessionId\",\r\n//   ];\r\nexport function who(upn) {\r\n  if (!window.amplitude) return;\r\n  if (!upn) return;\r\n  var amp =  window.amplitude.getInstance()\r\n  if (!amp) return\r\n  \r\n  amp.setUserId(upn);\r\n\r\n  var s = upn.split(\"@\");\r\n  if (s.length === 2) {\r\n    amp.setDomain(s[1]);\r\n  }\r\n}\r\n\r\nexport function trace(event, details) {\r\n  if (!window.amplitude) return;\r\n  var amp =  window.amplitude.getInstance()\r\n  if (!amp) return\r\n  amp.logEvent(event, details);\r\n  console.log(\"trace\",event, details);\r\n}\r\n","import json from \"format-json\";\r\nimport _ from \"lodash\";\r\nimport request from \"request\";\r\nimport axios from \"axios\";\r\nimport { addElementAtIndex } from \"@fluentui/react\";\r\nexport var graph = {};\r\n\r\nfunction extractEmails(text) {\r\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\r\n}\r\n\r\ngraph.analyseMembers = (token, emailAddresses, cb) => {\r\n  var addresses = [];\r\n\r\n  var ar1 = emailAddresses.split(\"\\n\");\r\n  ar1.forEach((element1) => {\r\n    var ar2 = element1.split(\";\");\r\n    ar2.forEach((element2) => {\r\n      var smptAddresses = extractEmails(element2);\r\n      smptAddresses.forEach((smtp) => {\r\n        addresses.push({\r\n          checked: false,\r\n          smtp,\r\n        });\r\n      });\r\n    });\r\n  });\r\n\r\n  var results = [];\r\n  var x = addresses.length;\r\n  addresses.forEach((address) => {\r\n    graph.readUser(token, address.smtp, 0, (err, user) => {\r\n      x--;\r\n      address.user = user;\r\n      address.err = err;\r\n      results.push(address);\r\n      if (x < 1) {\r\n        cb(null, results);\r\n        address.checked = true;\r\n      }\r\n    });\r\n  });\r\n};\r\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\r\n  var msg = {\r\n    invitedUserEmailAddress: emailAddress,\r\n    inviteRedirectUrl: invitationRedirectUrl,\r\n    invitedUserDisplayName: emailAddress,\r\n    sendInvitationMessage: false,\r\n    invitedUserMessageInfo: {\r\n      customizedMessageBody:\r\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\r\n      ccRecipients: [\r\n        {\r\n          emailAddress: {\r\n            name: \"Niels\",\r\n            address: \"niels@jumpto365.com\",\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  };\r\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\r\n    err,\r\n    response\r\n  ) {\r\n    if (err) {\r\n      return cb(err);\r\n    }\r\n    cb(null, response);\r\n  });\r\n};\r\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\r\n  var msg = {\r\n    properties: [\r\n      {\r\n        property: \"firstname\",\r\n        value: first,\r\n      },\r\n      {\r\n        property: \"lastname\",\r\n        value: last,\r\n      },\r\n      {\r\n        property: \"internal_categories\",\r\n        value: tag,\r\n      },\r\n      // {\r\n      //   \"property\": \"phone\",\r\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\r\n      // },\r\n      // {\r\n      //   \"property\": \"jobtitle\",\r\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\r\n      // },\r\n      // {\r\n      //   \"property\": \"country\",\r\n      //   \"value\": \"@{body('Signin')['country']}\"\r\n      // }\r\n    ],\r\n  };\r\n\r\n  post2(\r\n    token,\r\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\r\n    msg,\r\n    function (err, response) {\r\n      if (err) {\r\n        return cb(err);\r\n      }\r\n      cb(null, response);\r\n    }\r\n  );\r\n};\r\ngraph.addmember = (token, userId, groupId, cb) => {\r\n  var msg = {\r\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\r\n  };\r\n  post(\r\n    token,\r\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\r\n    msg,\r\n    function (err, response) {\r\n      if (err) {\r\n        return cb(err);\r\n      }\r\n      cb(null);\r\n    }\r\n  );\r\n};\r\n\r\ngraph.getSharePointList = (\r\n  token,\r\n  host,\r\n  site,\r\n  list,\r\n  listfilter,\r\n  itemfilter,\r\n  cb\r\n) => {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\r\n    function (e, items) {\r\n      if (e) return cb(e);\r\n      var itemList = [];\r\n\r\n      function next() {\r\n        if (items.length === 0) return cb(null, itemList);\r\n        var item = items.pop();\r\n\r\n        get(\r\n          token,\r\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\r\n          function (e, item) {\r\n            if (e) return cb(e);\r\n            itemList.push(item);\r\n            next();\r\n          }\r\n        );\r\n      }\r\n\r\n      next();\r\n    }\r\n  );\r\n};\r\n\r\ngraph.getPages = (token, host, site, cb) => {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\r\n    function (e, site) {\r\n      if (e) return cb(e);\r\n\r\n      get(\r\n        token,\r\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\r\n        function (e, items) {\r\n          if (e) return cb(e);\r\n\r\n          return cb(null, items);\r\n        }\r\n      );\r\n    }\r\n  );\r\n};\r\ngraph.readGroupMembers = function (token, groupId, cb) {\r\n  get(\r\n    token,\r\n    \"https://graph.microsoft.com/beta/groups/\" +\r\n      groupId +\r\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\r\n    cb\r\n  );\r\n};\r\n\r\n\r\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\r\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\r\n};\r\n\r\ngraph.readManager = function (token, userPrincipalName, index, cb) {\r\n  get(\r\n    token,\r\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\r\n    cb,\r\n    null,\r\n    index\r\n  );\r\n};\r\n\r\ngraph.readUser = function (token, userPrincipalName, index, cb) {\r\n  get(\r\n    token,\r\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\r\n    cb,\r\n    null,\r\n    index\r\n  );\r\n};\r\ngraph.readUser = function (token, userPrincipalName, index, cb) {\r\n  get(\r\n    token,\r\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\r\n    cb,\r\n    null,\r\n    index\r\n  );\r\n};\r\n\r\ngraph.matchingGroups = function (token, searchText, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.findGroup = function (token, searchText, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getGroupDrive = function (token, groupId, cb) {\r\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\r\n};\r\ngraph.getGroupSite = function (token, groupId, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getGroupRootFolders = function (token, groupId, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\r\n  get(\r\n    token,\r\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\r\n    cb\r\n  );\r\n};\r\n\r\ngraph.copyfile = function (\r\n  token,\r\n  groupNickName,\r\n  fromFolder,\r\n  fromName,\r\n  toFolder,\r\n  toName,\r\n  cb\r\n) {\r\n  graph.findGroup(token, groupNickName, function (err, groups) {\r\n    if (err) return cb(err);\r\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\r\n    var group = groups[0];\r\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\r\n      err,\r\n      fromItems\r\n    ) {\r\n      if (err) return cb(err);\r\n      var match = _.find(fromItems, { name: fromName });\r\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\r\n        if (err) return cb(err);\r\n        var destFolder = _.find(targetFolders, { name: toFolder });\r\n        if (!destFolder) return cb(\"Did't find target folder\");\r\n        graph.newDoc(\r\n          token,\r\n          group.id,\r\n          match.id,\r\n          destFolder.parentReference.driveId,\r\n          destFolder.id,\r\n          toName,\r\n          function (err, result) {\r\n            if (err) return cb(err);\r\n            return cb(null, result);\r\n          }\r\n        );\r\n      });\r\n    });\r\n  });\r\n};\r\n\r\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\r\n  // Content have been copied\r\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\r\n    if (err) {\r\n      return cb(err);\r\n    }\r\n    // content of destination folder\r\n\r\n    for (let index = 0; index < result.length; index++) {\r\n      const file = result[index];\r\n\r\n      console.log(\"Comparing\", file.name, name);\r\n      if (file.name === name) {\r\n        // match found\r\n        console.log(\"Match found\");\r\n        return cb(null, file);\r\n      }\r\n    }\r\n\r\n    var iteration = 0;\r\n    function retry() {\r\n      console.log(\"Retrying\", iterations);\r\n      //\r\n      if (iteration > 10) {\r\n        return cb(\r\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\r\n        );\r\n      }\r\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\r\n    }\r\n    // no match found so we will wait a second a try again\r\n    setTimeout(retry, 1000);\r\n  });\r\n}\r\n\r\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\r\n  post(\r\n    token,\r\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\r\n    {\r\n      parentReference: {\r\n        driveId: driveId,\r\n        id: id,\r\n      },\r\n      name: name,\r\n    },\r\n    function (err) {\r\n      // no result from that call - by design from Microsoft\r\n      if (err) {\r\n        return cb(err);\r\n      }\r\n\r\n      // so we fill try to find a referece our self\r\n      lookupFile(token, driveId, id, name, 0, cb);\r\n    }\r\n  );\r\n};\r\nexport const graphWithPromise = {};\r\ngraphWithPromise.me = (token) => {\r\n  return new Promise((resolve, reject) => {\r\n    get(\r\n      token,\r\n      \"https://graph.microsoft.com/v1.0/me/\",\r\n      (error, result) => {\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n        return resolve(result);\r\n      },\r\n      null\r\n    );\r\n  });\r\n};\r\n\r\nclass Client {\r\n  constructor() {\r\n    this.token = auth.getAccessToken();\r\n  }\r\n  get = (url,options) => {\r\n    return new Promise((resolve, reject) => {\r\n      get(this.token, url, (error, result) => {\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n        return resolve(result);\r\n      }, null,null,null,options);\r\n    });\r\n  };\r\n\r\n  post = (url, payload) => {\r\n    return new Promise((resolve, reject) => {\r\n      post(this.token, url, payload, (error, result) => {\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n        return resolve(result);\r\n      });\r\n    });\r\n  };\r\n\r\n  patch = (url, payload) => {\r\n    return new Promise((resolve, reject) => {\r\n      patch(this.token, url, payload, (error, result) => {\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n        return resolve(result);\r\n      });\r\n    });\r\n  };\r\n  put = (url, payload) => {\r\n    return new Promise((resolve, reject) => {\r\n      put(this.token, url, payload, (error, result) => {\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n        return resolve(result);\r\n      });\r\n    });\r\n  };\r\n  getRaw = (url) => {\r\n    return getRaw(this.token, url);\r\n  };\r\n  getImage = (url) => {\r\n    return getImage(this.token, url);\r\n  };\r\n}\r\n\r\nfunction imageToBase64(blob) {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      var reader = new FileReader();\r\n\r\n      reader.onload = function () {\r\n        var blobAsDataUrl = reader.result;\r\n\r\n        resolve(blobAsDataUrl);\r\n      };\r\n\r\n      reader.readAsDataURL(new Blob([blob]));\r\n    } catch (error) {\r\n      debugger;\r\n      resolve(null);\r\n    }\r\n  });\r\n}\r\nconst get2 = (url,options) => {\r\n  var client = new Client();\r\n  return client.get(url,options);\r\n};\r\n\r\nconst patch2 = (url, payload) => {\r\n  var client = new Client();\r\n  return client.patch(url, payload);\r\n};\r\nconst post2 = (url, payload) => {\r\n  var client = new Client();\r\n  return client.post(url, payload);\r\n};\r\nconst put2 = (url, payload) => {\r\n  var client = new Client();\r\n  return client.put(url, payload);\r\n};\r\n/**\r\n *\r\n */\r\nexport const me = () => {\r\n  return get2(\"https://graph.microsoft.com/v1.0/me\");\r\n};\r\nexport const myGroups = () => {\r\n  return get2(\"https://graph.microsoft.com/v1.0/me/memberOf\");\r\n};\r\nexport const MyTeams = () => {\r\n  return get2(\"https://graph.microsoft.com/v1.0/me/joinedTeams\");\r\n};\r\nexport const readTeam = (id) => {\r\n  return get2(\"https://graph.microsoft.com/v1.0/groups/\" + id);\r\n};\r\n\r\nexport const readTeamChannelMessages = (groupId,channelId) => {\r\n  return get2(`https://graph.microsoft.com/beta/teams/${groupId}/channels/${channelId}/messages`,{\r\n    skipNextLink:true\r\n  \r\n  });\r\n};\r\n\r\n\r\nexport const getMyExtention = (extensionName) => {\r\n  return get2(\r\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`\r\n  );\r\n};\r\n\r\nexport const getOneDriveFolder = (folderNameWithOutInitialSlash) => {\r\n  return get2(\r\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}`\r\n  );\r\n};\r\nexport const getOneDriveFolderContent = (folderNameWithOutInitialSlash) => {\r\n  return get2(\r\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}:/children`\r\n  );\r\n};\r\n\r\nexport const getOneDriveFile = (folderNameWithOutInitialSlash, filename) => {\r\n  return new Promise(async (resolve, reject) => {\r\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\r\n      (e) => {\r\n        reject(e);\r\n      }\r\n    );\r\n    if (!folder) return;\r\n\r\n    get2(\r\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}`\r\n    )\r\n      .then((file) => {\r\n        axios\r\n          .get(file[\"@microsoft.graph.downloadUrl\"])\r\n          .then((response) => {\r\n            resolve(response.data);\r\n          })\r\n          .catch((e) => {\r\n            reject(e);\r\n          });\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      });\r\n  });\r\n};\r\n\r\nexport const saveOneDriveFile = (\r\n  folderNameWithOutInitialSlash,\r\n  filename,\r\n  payload\r\n) => {\r\n  return new Promise(async (resolve, reject) => {\r\n    console.log(\"Size of payload\", payload.length);\r\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\r\n      (e) => {\r\n        reject(e);\r\n      }\r\n    );\r\n    if (!folder) return;\r\n\r\n    put2(\r\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}:/content`,\r\n      payload\r\n    )\r\n      .then((result) => {\r\n        resolve(result);\r\n      })\r\n      .catch((e) => {\r\n        reject(e);\r\n      });\r\n  });\r\n};\r\n\r\nexport const createOneDriveFolder = (folderNameWithOutInitialSlash) => {\r\n  const driveItem = {\r\n    name: folderNameWithOutInitialSlash,\r\n    folder: {},\r\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\r\n  };\r\n\r\n  return post2(\r\n    `https://graph.microsoft.com/v1.0/me/drive/root/children`,\r\n    driveItem\r\n  );\r\n};\r\n\r\nexport const createOneDriveFolderChild = (\r\n  parentFolderNameWithOutInitialSlash,\r\n  folderNameWithOutInitialSlash\r\n) => {\r\n  const driveItem = {\r\n    name: folderNameWithOutInitialSlash,\r\n    folder: {},\r\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\r\n  };\r\n\r\n  return post2(\r\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${parentFolderNameWithOutInitialSlash}:/children`,\r\n    driveItem\r\n  );\r\n};\r\n\r\nexport const saveMyExtention = (extensionName, data) => {\r\n  return new Promise(async (resolve, reject) => {\r\n    var existing = await getMyExtention(extensionName).catch((e) => {});\r\n    if (!existing) {\r\n      addMyExtention(extensionName, data)\r\n        .then((r) => {\r\n          resolve(r);\r\n        })\r\n        .catch((e) => {\r\n          reject(e);\r\n        });\r\n    } else {\r\n      updateMyExtention(extensionName, data)\r\n        .then((r) => {\r\n          resolve(r);\r\n        })\r\n        .catch((e) => {\r\n          reject(e);\r\n        });\r\n    }\r\n  });\r\n};\r\nexport const updateMyExtention = (extensionName, data) => {\r\n  var payload = {\r\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\r\n    extensionName: extensionName,\r\n    ...data,\r\n  };\r\n  return patch2(\r\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`,\r\n    payload\r\n  );\r\n};\r\nexport const addMyExtention = (extensionName, data) => {\r\n  var payload = {\r\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\r\n    extensionName: extensionName,\r\n    ...data,\r\n  };\r\n  return post2(`https://graph.microsoft.com/v1.0/me/extensions`, payload);\r\n};\r\n\r\nexport const teamMemberships = (reportProgessPercent) => {\r\n  var client = new Client();\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      var memberships = await client\r\n        .get(\"https://graph.microsoft.com/v1.0/me/memberOf\")\r\n        .catch((error) => reject(error));\r\n      var pending = 0;\r\n      var groups = [];\r\n\r\n      if (!memberships) return reject(\"Not able to read membership\");\r\n\r\n      //memberships = [memberships[0]];\r\n      var total = memberships.length;\r\n      var processed = 0;\r\n      if (reportProgessPercent) reportProgessPercent(0);\r\n      memberships.map(async (value) => {\r\n        pending++;\r\n\r\n        var group = await readGroup(value, client);\r\n\r\n        processed++;\r\n        if (reportProgessPercent) reportProgessPercent(processed / total);\r\n        groups.push(group);\r\n\r\n        pending--;\r\n        if (pending === 0) {\r\n          return resolve(\r\n            groups.sort((a, b) => {\r\n              if (a.text < b.text) {\r\n                return -1;\r\n              }\r\n              if (a.text > b.text) {\r\n                return 1;\r\n              }\r\n              return 0;\r\n            })\r\n          );\r\n        }\r\n      });\r\n    } catch (error) {\r\n      debugger;\r\n      reject(error);\r\n    }\r\n  }, null);\r\n};\r\n\r\nexport var auth = {};\r\n\r\nauth.getAccessToken = function () {\r\n  return sessionStorage.getItem(\"access_token\");\r\n};\r\n\r\nfunction readGroup(value, client) {\r\n  return new Promise(async (resolve, reject) => {\r\n    var group = {\r\n      ...value,\r\n      key: value.id,\r\n      text: value.title ? value.title : value.displayName,\r\n      title: value.description,\r\n    };\r\n    var photo = await client\r\n      .getImage(\r\n        `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\r\n      )\r\n      .catch((error) => {\r\n        debugger;\r\n        console.log(\"Photo read error\");\r\n      });\r\n    if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\r\n\r\n    var details = await client\r\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\r\n      .catch((error) => console.log(\"Team details read error\"));\r\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\r\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\r\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\r\n    });\r\n    (value.resourceProvisioningOptions\r\n      ? value.resourceProvisioningOptions\r\n      : []\r\n    ).forEach((v) => {\r\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\r\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\r\n    });\r\n    \r\n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\r\n    var channels = await readChannels(client, value).catch((e) => {});\r\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\r\n    group.hasTeams = channels !== undefined;\r\n    group.data = {\r\n      endPoints,\r\n      details,\r\n      photo,\r\n      channels: channels,\r\n    };\r\n    resolve(group);\r\n  });\r\n}\r\n\r\nasync function readChannels(client, value) {\r\n  var queue = 0;\r\n  return new Promise(async (resolve, reject) => {\r\n    var channels = await client\r\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\r\n      .catch((error) => {\r\n        console.log(\"Channel read error\");\r\n      });\r\n    if (!channels) return resolve();\r\n\r\n    channels.forEach(async (channel) => {\r\n      queue++;\r\n      var tabs = await client\r\n        .get(\r\n          `https://graph.microsoft.com/beta/teams/${value.id}/channels/${channel.id}/tabs`\r\n        )\r\n        .catch((error) => {\r\n          console.log(\"Channel read tabs\", error);\r\n        });\r\n\r\n      channel.tabs = tabs;\r\n      queue--;\r\n      if (queue === 0) {\r\n        resolve(channels);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nasync function readEndpoints(client, value) {\r\n  return client.get(\r\n    `https://graph.microsoft.com/beta/groups/${value.id}/endpoints`\r\n  );\r\n}\r\n\r\nfunction post(token, url, body, cb) {\r\n  axios\r\n    .post(url, body, {\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        authorization: \"Bearer \" + token,\r\n      },\r\n    })\r\n    .then((result) => {\r\n      cb(null, result.data);\r\n    })\r\n    .catch((e) => {\r\n      cb(e);\r\n    });\r\n}\r\n\r\nfunction patch(token, url, body, cb) {\r\n  axios\r\n    .patch(url, body, {\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        authorization: \"Bearer \" + token,\r\n      },\r\n    })\r\n    .then((result) => {\r\n      cb(null, result.data);\r\n    })\r\n    .catch((e) => {\r\n      cb(e);\r\n    });\r\n}\r\n\r\nfunction put(token, url, body, cb) {\r\n  axios\r\n    .put(url, body, {\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        authorization: \"Bearer \" + token,\r\n      },\r\n    })\r\n    .then((result) => {\r\n      cb(null, result.data);\r\n    })\r\n    .catch((e) => {\r\n      cb(e);\r\n    });\r\n}\r\nexport function getRaw(token, url) {\r\n  console.log(\"getting\", url);\r\n\r\n  return new Promise((resolve, reject) => {\r\n    request.get(\r\n      {\r\n        url: url,\r\n        headers: {\r\n          authorization: \"Bearer \" + token,\r\n        },\r\n      },\r\n      function (err, response, body) {\r\n        if (err) {\r\n          return reject(err);\r\n        }\r\n        resolve({ body, response });\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nfunction getImage(token, url) {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      var xhr = new XMLHttpRequest();\r\n\r\n      xhr.onload = function () {\r\n        var reader = new FileReader();\r\n        reader.onloadend = function () {\r\n          resolve(reader.result);\r\n        };\r\n        reader.readAsDataURL(xhr.response);\r\n      };\r\n\r\n      xhr.open(\"GET\", url);\r\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\r\n      xhr.responseType = \"blob\";\r\n      xhr.send();\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n}\r\n\r\nexport function get(token, url, cb, appendTo, index, retrycount,options) {\r\n  console.log(\"getting\", url, appendTo === true);\r\n  request.get(\r\n    {\r\n      url: url,\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        authorization: \"Bearer \" + token,\r\n      },\r\n    },\r\n    function (err, response, body) {\r\n      var parsedBody;\r\n\r\n      if (err) {\r\n        var errCounter = retrycount ? retrycount + 1 : 1;\r\n        if (errCounter > 3) {\r\n          return cb(err, null, index);\r\n        } else {\r\n          // retry\r\n          console.log(\"retry #\", errCounter);\r\n          return get(token, url, cb, appendTo, index, errCounter);\r\n        }\r\n      }\r\n\r\n      parsedBody = JSON.parse(body);\r\n      if (parsedBody.error) {\r\n        return cb(parsedBody.error, null, index);\r\n      }\r\n\r\n    \r\n      if (parsedBody[\"@odata.nextLink\"]) {\r\n        \r\n        var followNextLink = options && options.skipNextLink ? false:true \r\n        var data;\r\n        if (!appendTo) {\r\n          data = parsedBody.value;\r\n        } else {\r\n          data = appendTo.concat(parsedBody.value);\r\n        }\r\n        if (followNextLink){\r\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\r\n      }\r\n      }\r\n\r\n      if (appendTo) {\r\n        cb(null, appendTo.concat(parsedBody.value), index);\r\n      } else {\r\n        if (parsedBody.value) {\r\n          cb(null, parsedBody.value, index);\r\n        } else {\r\n          cb(null, parsedBody, index);\r\n        }\r\n      }\r\n    }\r\n  );\r\n}\r\n","import {\r\n  me,\r\n  myGroups,\r\n  MyTeams,\r\n\r\n  readTeam,\r\n  getMyExtention,\r\n  saveMyExtention,\r\n  getOneDriveFolder,\r\n  createOneDriveFolder,\r\n  getOneDriveFolderContent,\r\n  createOneDriveFolderChild,\r\n  getOneDriveFile,\r\n  saveOneDriveFile,\r\n} from \"./OfficeGraph\";\r\n\r\nimport projectInfo from \"../../package.json\";\r\nimport _ from \"lodash\";\r\nimport Axios from \"axios\";\r\nexport const extentionName = \"com.ztickybar.tools\";\r\nexport const OURPATH = \"Apps/jumpto365.com\";\r\nexport const BOARDSPATH = \"Apps/jumpto365.com/boards\";\r\nexport const BOARDS = \"boards\";\r\n\r\nexport const OURCONFIGFILENAME = \"launchpad.json\";\r\nexport const BOARDINDEXFILENAME = \"index-contexts.json\"\r\n\r\nexport function saveCache(memberships) {\r\n  return new Promise((resolve, reject) => {\r\n    var membershipIndex = [];\r\n    var queue = 0;\r\n    memberships.forEach((membership) => {\r\n      membershipIndex.push(membership.id);\r\n      queue++;\r\n\r\n      saveOneDriveFile(OURPATH, cachedFileName(membership.id), membership).then(\r\n        () => {\r\n          queue--;\r\n          if (queue < 1) {\r\n            saveOneDriveFile(OURPATH, \"memberships.json\", membershipIndex)\r\n              .then(() => {\r\n                resolve(membershipIndex);\r\n              })\r\n              .catch((e) => {\r\n                reject(e);\r\n              });\r\n          }\r\n        }\r\n      );\r\n    });\r\n  });\r\n}\r\n\r\nfunction cachedFileName(id) {\r\n  return \"membership.\" + id + \".json\";\r\n}\r\n\r\nexport function readCache() {\r\n  return new Promise(async (resolve, reject) => {\r\n    var membershipIndex = await getOneDriveFile(\r\n      OURPATH,\r\n      \"memberships.json\"\r\n    ).catch((e) => {\r\n      reject(e);\r\n    });\r\n    if (!membershipIndex) return;\r\n    var queue = 0;\r\n    var memberships = [];\r\n    membershipIndex.forEach((id) => {\r\n      queue++;\r\n      getOneDriveFile(OURPATH, cachedFileName(id))\r\n        .then((data) => {\r\n          memberships.push(data);\r\n          queue--;\r\n          if (queue < 1) {\r\n            resolve(memberships);\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          reject(e);\r\n        });\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Verifies access to all endpoints used for the LaunchPad app\r\n *\r\n * @param {*} setCheckMe Callback accepting a string - \"OK\" or an error\r\n * @param {*} setCheckMyExtention  Callback accepting a string - \"OK\" or an error\r\n * @param {*} setCheckOneDrive  Callback accepting a string - \"OK\" or an error\r\n * @param {*} setCheckOneDriveFiles  Callback accepting a string - \"OK\" or an error\r\n * @param {*} setCheckMemberships  Callback accepting a string - \"OK\" or an error\r\n * @param {*} setCheckTeam  Callback accepting a string - \"OK\" or an error\r\n */\r\nexport async function verifyAccessForLanuchPad(\r\n  setCheckMe,\r\n  setCheckMyExtention,\r\n  setCheckOneDrive,\r\n  setCheckOneDriveFiles,\r\n  setCheckMemberships,\r\n  setCheckTeam\r\n) {\r\n  me()\r\n    .then((m) => {\r\n      setCheckMe(\"OK\");\r\n    })\r\n    .catch((e) => {\r\n      setCheckMe(e.message);\r\n    });\r\n\r\n  var extention = await saveMyExtention(extentionName, {\r\n    hello: \"world\",\r\n  }).catch((e) => {\r\n    setCheckMyExtention(e.message);\r\n  });\r\n  if (extention || extention === \"\") {\r\n    setCheckMyExtention(\"OK\");\r\n  }\r\n\r\n  getOneDriveFolder(OURPATH)\r\n    .then((r) => {\r\n      setCheckOneDrive(\"OK\");\r\n      checkAccessToConfig();\r\n    })\r\n    .catch(async (e) => {\r\n      var f = await getOneDriveFolder(\"Apps\").catch((e) => {});\r\n      if (f) {\r\n        var child = await createOneDriveFolderChild(\r\n          \"Apps\",\r\n          \"jumpto365.com\"\r\n        ).catch((e) => {\r\n          setCheckOneDrive(e.message);\r\n        });\r\n        if (child) {\r\n          setCheckOneDrive(\"OK\");\r\n          checkAccessToConfig();\r\n        }\r\n      } else {\r\n        var child = await createOneDriveFolder(\"Apps\").catch((e) => {\r\n          setCheckOneDrive(e.message);\r\n        });\r\n        child = await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\").catch(\r\n          (e) => {\r\n            setCheckOneDrive(e.message);\r\n          }\r\n        );\r\n        if (child) {\r\n          setCheckOneDrive(\"OK\");\r\n          checkAccessToConfig();\r\n        }\r\n      }\r\n    });\r\n\r\n  MyTeams()\r\n    .then((memberships) => {\r\n      setCheckMemberships(\"OK\");\r\n      var teamId;\r\n      memberships.forEach((member) => {\r\n        if (member.displayName) {\r\n          if (!teamId) {\r\n            teamId = member.id;\r\n          }\r\n        }\r\n      });\r\n      if (teamId) {\r\n        readTeam(teamId)\r\n          .then((m) => {\r\n            setCheckTeam(\"OK\");\r\n          })\r\n          .catch((e) => {\r\n            setCheckTeam(e.message);\r\n          });\r\n      } else {\r\n        setCheckTeam(\"Didn't find any Microsoft Teams memberships\");\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      setCheckMemberships(e.message);\r\n    });\r\n\r\n  async function checkAccessToConfig() {\r\n    var settings = await getOneDriveFile(OURPATH, OURCONFIGFILENAME).catch(\r\n      async (e) => {\r\n        var file = await saveOneDriveFile(OURPATH, OURCONFIGFILENAME, {\r\n          version: projectInfo.version,\r\n        }).catch((e) => {\r\n          setCheckOneDriveFiles(e.message);\r\n        });\r\n        if (file) {\r\n          setCheckOneDriveFiles(\"OK\");\r\n        }\r\n      }\r\n    );\r\n    if (settings) {\r\n      setCheckOneDriveFiles(\"OK\");\r\n      checkAccessToContexts();\r\n    }\r\n  }\r\n}\r\n\r\nexport async function checkAccessToContexts() {\r\n  await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\");\r\n  await createOneDriveFolderChild(OURPATH, BOARDS);\r\n}\r\n\r\nexport function saveBoard(memberships, name) {\r\n  return new Promise(async (resolve, reject) => {\r\n    await createOneDriveFolderChild(BOARDSPATH, name);\r\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\r\n    var membershipIndex = [];\r\n    var queue = 0;\r\n    memberships.forEach((membership) => {\r\n      membershipIndex.push(membership.id);\r\n      queue++;\r\n\r\n      saveOneDriveFile(\r\n        currentBoardPath,\r\n        cachedFileName(membership.id),\r\n        membership\r\n      ).then(() => {\r\n        queue--;\r\n        if (queue < 1) {\r\n          saveOneDriveFile(\r\n            currentBoardPath,\r\n            \"memberships.json\",\r\n            membershipIndex\r\n          )\r\n            .then(() => {\r\n              resolve(membershipIndex);\r\n            })\r\n            .catch((e) => {\r\n              reject(e);\r\n            });\r\n        }\r\n      });\r\n    });\r\n  });\r\n}\r\n\r\nexport function readBoard(name) {\r\n  return new Promise(async (resolve, reject) => {\r\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\r\n    var membershipIndex = await getOneDriveFile(\r\n      currentBoardPath,\r\n      \"memberships.json\"\r\n    ).catch((e) => {\r\n      reject(e);\r\n    });\r\n    if (!membershipIndex) return;\r\n    var queue = 0;\r\n    var memberships = [];\r\n    membershipIndex.forEach((id) => {\r\n      queue++;\r\n      getOneDriveFile(currentBoardPath, cachedFileName(id))\r\n        .then((data) => {\r\n          memberships.push(data);\r\n          queue--;\r\n          if (queue < 1) {\r\n            resolve(memberships);\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          reject(e);\r\n        });\r\n    });\r\n  });\r\n}\r\n\r\nvar buffer = {\r\n  layouts: { pending: false },\r\n};\r\n\r\nfunction delaywriteLayouts() {\r\n  setTimeout(() => {\r\n    console.log(\"delaywriteLayouts\");\r\n    if (!buffer.layouts.pending) {\r\n      return;\r\n    }\r\n    if (buffer.layouts.writing) {\r\n      return delaywriteLayouts();\r\n    }\r\n    writeLayouts(\r\n      buffer.layouts.folder,\r\n      buffer.layouts.file,\r\n      buffer.layouts.data\r\n    );\r\n  }, 2000);\r\n}\r\n\r\nexport function writeLayouts(folder, file, data) {\r\n  // if (data.myTeams.length === 0) {\r\n  //   console.log(\"Ignoring writeLayouts with no teams\")\r\n  //   return}\r\n  return new Promise(async (resolve, reject) => {\r\n    console.log(\"writeLayouts\");\r\n    if (buffer && buffer.layouts && buffer.layouts.writing) {\r\n      if (_.isEqual(buffer.layouts.data, data)) {\r\n        console.log(\"writeLayouts no changes\");\r\n        return resolve();\r\n      }\r\n      buffer.layouts.pending = true;\r\n      buffer.layouts.data = data;\r\n      buffer.layouts.file = file;\r\n      buffer.layouts.folder = folder;\r\n      delaywriteLayouts();\r\n      return resolve();\r\n    }\r\n\r\n    try {\r\n      buffer.layouts.writing = true;\r\n      buffer.layouts.current = data;\r\n\r\n      await saveOneDriveFile(folder, file, data);\r\n      buildIndexOfLaunzhBoards()\r\n      resolve();\r\n    } catch (error) {\r\n      console.log(\"writeLayouts > error\", error);\r\n      return reject(error);\r\n    } finally {\r\n      buffer.layouts.writing = false;\r\n    }\r\n  });\r\n}\r\n\r\nexport function readLayouts(folder, file) {\r\n  return getOneDriveFile(folder, file);\r\n}\r\n\r\nexport function readBoardFiles() {\r\n  return getOneDriveFolderContent(BOARDSPATH);\r\n}\r\n\r\nexport function readBoards() {\r\n  return new Promise(async (resolve, reject) => {\r\n    var files = await getOneDriveFolderContent(BOARDSPATH).catch((e) => {\r\n      reject(e);\r\n    });\r\n    if (!files) return; // rejected in catch - hopefully (-;\r\n\r\n    var pending = 0;\r\n    var results = [];\r\n    files.forEach((file) => {\r\n      pending++;\r\n      Axios.get(file[\"@microsoft.graph.downloadUrl\"])\r\n        .then((result) => {\r\n          pending--;\r\n          results.push({\r\n            file,\r\n            content: result.data,\r\n          });\r\n          if (pending < 1) {\r\n            resolve(results);\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          reject(e);\r\n        });\r\n    });\r\n  });\r\n}\r\nexport function teamsLink(href) {\r\n  if (href) {\r\n    var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\r\n    var part2 = part1[1].split(\"/conversations?\");\r\n    var part3 = href.split(\"groupId=\");\r\n    var part4 = part3[1].split(\"&\");\r\n    var part5 = href.split(\"tenantId=\");\r\n    var threadId = part2[0];\r\n    var groupId = part4[0];\r\n    var tenantId = part5[1];\r\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\r\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\r\n    return conversationsHref;\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\nexport function teamsLink2(href) {\r\n  if (href) {\r\n    var part1 = href.split(\"https://teams.microsoft.com/l/channel/\");\r\n    var part2 = part1[1].split(\"/conversations?\");\r\n    var part3 = href.split(\"groupId=\");\r\n    var part4 = part3[1].split(\"&\");\r\n    var part5 = href.split(\"tenantId=\");\r\n    var threadId = part2[0];\r\n    var groupId = part4[0];\r\n    var tenantId = part5[1];\r\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\r\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\r\n    return conversationsHref;\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\nexport function getHref(team){\r\n  var href =\r\n  team && team.data && team.data.details ? team.data.details.webUrl : \"\";\r\n  if (team.data ) {\r\n    var uniqueEndPoints = _.groupBy(\r\n      team.data.endPoints ? team.data.endPoints : [],\r\n      (endPoint) => {\r\n        return endPoint.providerName;\r\n      }\r\n    );\r\n  }\r\n    var conversationsHref =\r\n      team && team.tile\r\n        ? team.tile.jumpto\r\n          ? team.tile.jumpto\r\n          : team.tile.externalArticle\r\n        : uniqueEndPoints[\"Yammer\"]\r\n        ? uniqueEndPoints[\"Yammer\"][0].uri\r\n        : teamsLink(href);\r\n\r\n    return conversationsHref\r\n}\r\n\r\n\r\n/**\r\n * Read all context for a given user and build an index of where a given URL is found\r\n */\r\nexport function buildIndexOfLaunzhBoards() {\r\n  return new Promise(async (resolve, reject) => {\r\n    var index = {}\r\n    var ctxs = await readBoards()\r\n    \r\n    ctxs.forEach(ctx => {\r\n      try {\r\n        \r\n     var fullname = ctx.file.name.split(\".\")\r\n     var name = fullname ? fullname[0] : ctx.file.name\r\n  \r\n\r\n\r\n      ctx.content.myTeams.forEach(team => {\r\n        \r\n        var href = getHref(team)\r\n        if (!index[href]){\r\n          index[href] = [{name,color:\"#000000\",backgroundColor:\"#b3e6a9\"}]\r\n        }else{\r\n          index[href].push({name,color:\"#000000\",backgroundColor:\"#b3e6a9\"})\r\n        }\r\n        \r\n      });\r\n    } catch (error) {\r\n        console.log(\"indexLaunzhContexts\",error)\r\n    }\r\n    });\r\n    await saveOneDriveFile(OURPATH, BOARDINDEXFILENAME , index);\r\n  });\r\n}\r\n\r\nexport function readIndexOfLaunzhBoards() {\r\n  return getOneDriveFile(OURPATH, BOARDINDEXFILENAME);\r\n}","import React, {\r\n  Component,\r\n  useState,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useRef,\r\n} from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Highlight } from \"./Highlight\";\r\nimport Masonry from \"react-masonry-css\";\r\nimport moment from \"moment\";\r\nimport \"./masonry.css\";\r\nimport { GroupMouseOver, PinMouseOver } from \"./MouseOver\";\r\nimport _ from \"lodash\";\r\nimport { EVENT, trace } from \"../helpers/trace\";\r\n\r\nimport { getHref, teamsLink, teamsLink2 } from \"../helpers/LaunchPad\";\r\nimport \"./tile.css\";\r\nimport { navigate } from \"@reach/router\";\r\nimport { ActionButton, Button, IconButton } from \"@fluentui/react\";\r\nimport { readTeamChannelMessages } from \"../helpers/OfficeGraph\";\r\nconst breakpointColumnsObj = {\r\n  default: 11,\r\n\r\n  3600: 11,\r\n\r\n  3300: 10,\r\n  3000: 9,\r\n  2700: 8,\r\n  2400: 7,\r\n\r\n  2100: 6,\r\n  1800: 5,\r\n  1500: 4,\r\n  1200: 3,\r\n  900: 2,\r\n  600: 1,\r\n  //300: 1,\r\n};\r\nexport const useContainerDimensions = (myRef) => {\r\n  const getDimensions = () => ({\r\n    width: myRef.current.offsetParent.offsetWidth,\r\n    height: myRef.current.offsetParent.offsetHeight,\r\n  });\r\n\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\r\n\r\n  useEffect(() => {\r\n    if (myRef.current) {\r\n      setDimensions(getDimensions());\r\n    }\r\n  }, []);\r\n\r\n  return dimensions;\r\n};\r\nexport const ViewTeams = (props) => {\r\n  const [viewChannels, setViewChannels] = useState(props.details);\r\n  const [viewDates, setViewDates] = useState(false);\r\n\r\n  if (props && props.memberShips) {\r\n    var memberShips = _.cloneDeep(props.memberShips);\r\n\r\n    if (props.tiles) {\r\n      props.tiles.forEach((tile) => {\r\n        //debugger\r\n        memberShips.push({\r\n          displayName: tile.title,\r\n          tile,\r\n        });\r\n      });\r\n\r\n      memberShips = _.sortBy(memberShips, [\"displayName\"]);\r\n    }\r\n    return (\r\n      <div\r\n        className=\"tags\"\r\n        style={{\r\n          padding: \"4px\",\r\n          margin: \"4px\",\r\n          fontSize: \"16px\",\r\n          display: \"flex\",\r\n          flexWrap: \"wrap\",\r\n          minWidth: \"300px\",\r\n        }}\r\n      >\r\n        <Masonry\r\n          breakpointCols={breakpointColumnsObj}\r\n          className=\"my-masonry-grid\"\r\n          columnClassName=\"my-masonry-grid_column\"\r\n        >\r\n          {/* array of JSX items */}\r\n\r\n          {memberShips.map((team, key) => {\r\n            //    if ((!team.resourceProvisioningOptions || !team.resourceProvisioningOptions.length > 0) && (team.creationOptions && !team.creationOptions.length > 0)) return null\r\n            //if ( team[\"@odata.type\"] === \"#microsoft.graph.directoryRole\") return null\r\n            // Profoe: \"https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=profile\"\r\n\r\n            return (\r\n              <ViewTeam\r\n                {...props}\r\n                key={key}\r\n                team={team}\r\n                viewChannels={props.details}\r\n                viewDates={viewDates}\r\n                onSaveTeam={props.onSaveTeam}\r\n              />\r\n            );\r\n          })}\r\n        </Masonry>\r\n      </div>\r\n    );\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport function ViewTeam(props) {\r\n\r\n  function logo(show, icon) {\r\n    if (!show) return null;\r\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\r\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\r\n  }\r\n\r\n  const team = props.team ? props.team : {};\r\n  var photo = team.data ? team.data.photo : null;\r\n\r\n  return (\r\n    <div>\r\n    {photo && (\r\n      <div>\r\n\r\n      <div\r\n\r\n        className=\"pinnedTile2\"\r\n        style={{\r\n          color:\"#ffffff\",\r\n          backgroundColor: \"#3f418e\",\r\n          minWidth: \"48px\",\r\n        }}\r\n      >\r\n      <img\r\n      src={\"https://blob.jumpto365.com/images/h/e/x/hexatown.com/m/matt@hexatown.com/2019/09/Microsoft_Teams_256x256.png-20190920-092147.png\"}\r\n      style={{\r\n        margin: \"12px\",\r\n        height: \"24px\",\r\n        width: \"24px\",\r\n      }}\r\n    ></img>{team.text}\r\n  </div>\r\n      \r\n    </div>\r\n\r\n\r\n\r\n    )}\r\n    {team.tile && team.tile.icon && (\r\n      <div\r\n        className=\"pinnedTile2\"\r\n        style={{\r\n          color:\"#ffffff\",\r\n          backgroundColor: team.tile.color,\r\n          minWidth: \"48px\",\r\n        }}\r\n      >\r\n        <img\r\n          src={team.tile.icon}\r\n          style={{\r\n            margin: \"12px\",\r\n            height: \"24px\",\r\n            width: \"24px\",\r\n          }}\r\n        ></img>{team.tile.title}\r\n      </div>\r\n    )}\r\n\r\n    </div>\r\n  );\r\n}\r\nexport function ViewTeamOLD(props) {\r\n  const viewChannels = props.viewChannels;\r\n  const [viewDates, setViewDates] = useState(props.viewDates);\r\n  const [mouseOver, setMouseOver] = useState(false);\r\n  const componentRef = useRef();\r\n\r\n  const team = props.team ? props.team : {};\r\n\r\n  function logo(show, icon) {\r\n    if (!show) return null;\r\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\r\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\r\n  }\r\n\r\n  // Notebook https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=notebook\"\r\n  // Planner \"https://tasks.office.com/365adm.onmicrosoft.com/en-US/Home/Group/786dc6d7-766f-46df-ac4b-d6883597061f\"\r\n\r\n  var conversationsHref = getHref(team);\r\n\r\n  var details =\r\n    team.data && team.data.details\r\n      ? team.data.details\r\n      : {\r\n          displayName: team.title\r\n            ? team.title\r\n            : team.displayName\r\n            ? team.displayName\r\n            : team[\"@odata.type\"],\r\n        };\r\n  var photo = team.data ? team.data.photo : null;\r\n  var channels = team.data && team.data.channels ? team.data.channels : [];\r\n\r\n  if (props.isPinned) {\r\n    //const { width, height } = useContainerDimensions(componentRef,props.refreshCount)\r\n    var width = componentRef.current\r\n      ? componentRef.current.offsetParent.offsetWidth - 2\r\n      : 0;\r\n    var height = componentRef.current\r\n      ? componentRef.current.offsetParent.offsetHeight - 2\r\n      : 0;\r\n\r\n    return (\r\n      <div\r\n        ref={componentRef}\r\n        className=\"pinnedTile\"\r\n        style={{ position: \"relative\", pointer: \"default\" }}\r\n        onClick={() => {\r\n          if (!props.editMode) {\r\n          }\r\n        }}\r\n      >\r\n        <div\r\n          style={{ position: \"absolute\", right: 4, top: 4, display: \"flex\" }}\r\n        >\r\n          <div>\r\n            {logo(team.hasTeams, \"TeamsLogo\")}\r\n            {logo(team.hasSharePoint, \"SharepointLogo\")}\r\n            {logo(team.hasYammer, \"YammerLogo\")}\r\n          </div>\r\n        </div>\r\n        <div\r\n          style={{\r\n            position: \"absolute\",\r\n            right: 10,\r\n            bottom: 4,\r\n            display: \"flex\",\r\n          }}\r\n        >\r\n          {\" \"}\r\n          <div style={{ flexGrow: 1 }}>{team.visibility}</div>\r\n        </div>\r\n        <div\r\n          style={{ display: \"flex\" }}\r\n          onMouseEnter={() => {\r\n            setMouseOver(true);\r\n          }}\r\n          onMouseLeave={() => {\r\n            setMouseOver(false);\r\n          }}\r\n          style={{\r\n            width,\r\n            height,\r\n            xborder: \"1px dashed red\",\r\n            xborderRadius: \"20px\",\r\n          }}\r\n        >\r\n          <div style={{ display: \"flex\" }}>\r\n            <div>\r\n              {props.editMode && mouseOver && (\r\n                <div style={{ position: \"absolute\", right: \"0\" }}>\r\n                  {\" \"}\r\n                  <span\r\n                    className=\"ms-Icon ms-Icon--Delete tiledelete\"\r\n                    onClick={() => {\r\n                      if (props.onRemovePin) {\r\n                        props.onRemovePin(props.pinId);\r\n                      }\r\n                    }}\r\n                  ></span>\r\n                </div>\r\n              )}\r\n              {!props.editMode && mouseOver && (\r\n                <div style={{ position: \"absolute\", right: \"0\" }}>\r\n                  {\" \"}\r\n                  <span\r\n                    className=\"ms-Icon ms-Icon--OpenInNewWindow tileopen \"\r\n                    onClick={() => {\r\n                      window.open(conversationsHref);\r\n                    }}\r\n                  ></span>\r\n                </div>\r\n              )}\r\n\r\n              {/* {width}x{height} - {props.width}x{props.height} {props.refreshCounter} */}\r\n              {photo && (\r\n                <div className=\"\" style={{ minWidth: \"48px\" }}>\r\n                  <img\r\n                    className=\"pinnedTile2\"\r\n                    src={photo}\r\n                    style={{\r\n                      height: \"48px\",\r\n                      width: \"48px\",\r\n                    }}\r\n                  ></img>\r\n                </div>\r\n              )}\r\n              {team.tile && team.tile.icon && (\r\n                <div\r\n                  className=\"pinnedTile2\"\r\n                  style={{\r\n                    backgroundColor: team.tile.color,\r\n                    minWidth: \"48px\",\r\n                  }}\r\n                >\r\n                  <img\r\n                    src={team.tile.icon}\r\n                    style={{\r\n                      margin: \"12px\",\r\n                      height: \"24px\",\r\n                      width: \"24px\",\r\n                    }}\r\n                  ></img>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div\r\n              className=\"ms-font-xl \"\r\n              style={{\r\n                padding: \"8px\",\r\n                marginRight: \"20px\",\r\n                lineHeight: \"32px\",\r\n                flexGrow: 1,\r\n              }}\r\n            >\r\n              {team.displayName}\r\n              {team.channel && (\r\n                <div className=\"channelListing\">\r\n                  <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\r\n                    <TeamChannel\r\n                      team={team}\r\n                      viewMode\r\n                      channel={team.channel}\r\n                      details={true}\r\n                    />\r\n                  </ul>{\" \"}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {mouseOver && (\r\n            <ListTags\r\n              indexLaunzhContexts={props.indexLaunzhContexts}\r\n              href={conversationsHref}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  if (team.tile) {\r\n    return (\r\n      <div\r\n        onMouseEnter={() => {\r\n          setMouseOver(true);\r\n        }}\r\n        onMouseLeave={() => {\r\n          setMouseOver(false);\r\n        }}\r\n        style={{\r\n          paddingLeft: \"0px\",\r\n          margin: \"10px\",\r\n          fontSize: \"16px\",\r\n          xdisplay: \"flex\",\r\n          border: \"1px solid #dddddd\",\r\n          minWidth: \"290px\",\r\n          maxWidth: \"290px\",\r\n        }}\r\n      >\r\n        <span\r\n          onClick={() => {\r\n            trace(EVENT.TILECLICKED, {\r\n              \"tile-key\": team.tile.key,\r\n              href: team.tile.externalArticle,\r\n            });\r\n          }}\r\n        >\r\n          <a\r\n            className=\"TeamLink\"\r\n            href={team.tile.externalArticle}\r\n            rel=\"noopener noreferrer\"\r\n            target=\"_blank\"\r\n          >\r\n            <div>\r\n              <div\r\n                style={{\r\n                  minWidth: \"288px\",\r\n                  paddingLeft: \"0px\",\r\n                  paddingBottom: \"0px\",\r\n                  position: \"relative\",\r\n                }}\r\n              >\r\n                {mouseOver && (\r\n                  <div\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      right: \"10px\",\r\n                      top: \"10px\",\r\n                      zIndex: \"1\",\r\n                      backgroundColor: \"#ffffffcc\",\r\n                    }}\r\n                  >\r\n                    <ActionButton\r\n                      styles={{ fontSize: \"24px\" }}\r\n                      iconProps={{ iconName: \"Save\" }}\r\n                      ariaLabel=\"Save\"\r\n                      onClick={(event) => {\r\n                        if (props.onSaveTeam) {\r\n                          event.preventDefault(); // Let's stop this event.\r\n                          event.stopPropagation(); // Really this time.\r\n                          props.onSaveTeam(team);\r\n                        }\r\n                      }}\r\n                    >\r\n                      Save Tile\r\n                    </ActionButton>\r\n                  </div>\r\n                )}\r\n                {team.tile.icon && (\r\n                  <div\r\n                    className=\"teamTitleBar\"\r\n                    style={{\r\n                      backgroundColor: team.tile.color,\r\n                      marginTop: \"-20px\",\r\n                      minWidth: \"280px\",\r\n                    }}\r\n                  >\r\n                    <img\r\n                      src={team.tile.icon}\r\n                      style={{\r\n                        margin: \"70px\",\r\n                        height: \"140px\",\r\n                        width: \"140px\",\r\n                      }}\r\n                    ></img>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\r\n                <div\r\n                  className=\"ms-font-xl \"\r\n                  style={{\r\n                    padding: \"8px\",\r\n                    lineHeight: \"32px\",\r\n                    textAlign: \"center\",\r\n                  }}\r\n                >\r\n                  <Highlight\r\n                    text={team.tile.title}\r\n                    filter={props.filter}\r\n                    style={props.highlightStyle}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {team.tile.inShort && (\r\n              <div\r\n                className=\"ms-font-m\"\r\n                style={{\r\n                  fontStyle: \"italic\",\r\n                  marginTop: \"10px\",\r\n                  paddingLeft: \"20px\",\r\n                  paddingRight: \"20px\",\r\n                  margin: \"0px\",\r\n                }}\r\n              >\r\n                <div style={{ fontStyle: \"italic\", marginTop: \"8px\" }}>\r\n                  <Highlight\r\n                    text={team.tile.inShort}\r\n                    filter={props.filter}\r\n                    style={props.highlightStyle}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </a>\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      onMouseEnter={() => {\r\n        setMouseOver(true);\r\n      }}\r\n      onMouseLeave={() => {\r\n        setMouseOver(false);\r\n      }}\r\n      style={{\r\n        paddingLeft: \"0px\",\r\n        margin: \"10px\",\r\n        fontSize: \"16px\",\r\n        xdisplay: \"flex\",\r\n        border: \"1px solid #dddddd\",\r\n        minWidth: \"290px\",\r\n        maxWidth: \"290px\",\r\n      }}\r\n    >\r\n      <div>\r\n        <div\r\n          style={{\r\n            minWidth: \"290px\",\r\n            paddingLeft: \"0px\",\r\n            paddingBottom: \"0px\",\r\n            position: \"relative\",\r\n          }}\r\n        >\r\n          {mouseOver && (\r\n            <div\r\n              style={{\r\n                position: \"absolute\",\r\n                right: \"10px\",\r\n                top: \"10px\",\r\n                zIndex: \"1\",\r\n                backgroundColor: \"#ffffffcc\",\r\n              }}\r\n            >\r\n              <ActionButton\r\n                styles={{ fontSize: \"24px\" }}\r\n                iconProps={{ iconName: \"Save\" }}\r\n                ariaLabel=\"Save\"\r\n                onClick={(event) => {\r\n                  if (props.onSaveTeam) {\r\n                    event.preventDefault(); // Let's stop this event.\r\n                    event.stopPropagation(); // Really this time.\r\n                    props.onSaveTeam(team);\r\n                  }\r\n                }}\r\n              >\r\n                Save Tile\r\n              </ActionButton>\r\n            </div>\r\n          )}\r\n          {photo && (\r\n            <img\r\n              className=\"teamImage\"\r\n              src={photo}\r\n              style={{\r\n                height: \"288px\",\r\n                width: \"288px\",\r\n                marginLeft: \"0px\",\r\n              }}\r\n            ></img>\r\n          )}\r\n        </div>\r\n        <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\r\n          <div\r\n            className=\"ms-font-xl \"\r\n            style={{\r\n              padding: \"8px\",\r\n              lineHeight: \"32px\",\r\n              textAlign: \"center\",\r\n            }}\r\n          >\r\n            <Highlight\r\n              text={details.displayName}\r\n              filter={props.filter}\r\n              style={props.highlightStyle}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div style={{ border: \"0px solid #dddddd\", paddingBottom: \"4px\" }}>\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              marginRight: \"10px\",\r\n              marginLeft: \"10px\",\r\n              marginTop: \"10px\",\r\n            }}\r\n          >\r\n            <div style={{ flexGrow: 1 }}>{team.visibility}</div>\r\n            <div>\r\n              {logo(team.hasTeams, \"TeamsLogo\")}\r\n              {logo(team.hasSharePoint, \"SharepointLogo\")}\r\n              {logo(team.hasYammer, \"YammerLogo\")}\r\n            </div>\r\n          </div>\r\n\r\n          {/* {team.data.endPoints && \r\n              team.data.endPoints.map((endPoint, key) => {\r\n             // if (endPoint.providerName===\"Yammer\") debugger\r\n              return <div key={key}><a target=\"_blank\" href={endPoint.uri}>{endPoint.providerName} ({endPoint.capability})</a></div>;\r\n              })} */}\r\n        </div>\r\n      </div>\r\n      {details.displayName !== details.description && (\r\n        <div\r\n          className=\"ms-font-m\"\r\n          style={{\r\n            fontStyle: \"italic\",\r\n            marginTop: \"10px\",\r\n            paddingLeft: \"20px\",\r\n            paddingRight: \"20px\",\r\n            margin: \"0px\",\r\n          }}\r\n        >\r\n          {details.description}\r\n        </div>\r\n      )}\r\n      {viewChannels && (\r\n        <div className=\"ms-font-l ms-fontWeight-bold\">\r\n          {channels.length > 1 && (\r\n            <div style={{ marginTop: \"10px\", marginLeft: \"20px\" }}>\r\n              Channels\r\n            </div>\r\n          )}\r\n          <div className=\"channelListing\">\r\n            <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\r\n              {channels.map((channel, key) => {\r\n                if (channel.displayName === \"$General\") {\r\n                  return null;\r\n                }\r\n                return (\r\n                  <TeamChannel\r\n                    {...props}\r\n                    noMessages\r\n                    key={key}\r\n                    channel={channel}\r\n                    details={details}\r\n                  />\r\n                );\r\n              })}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div>\r\n        {viewDates && (\r\n          <div style={{ display: \"xflex\" }}>\r\n            {team.expirationDateTime && (\r\n              <div style={{ flexGrow: 1 }}>\r\n                Expires in {moment(team.expirationDateTime).fromNow(true)}\r\n              </div>\r\n            )}\r\n            {/* {team.renewedDateTime && (<div style={{ flexGrow: 1 }}>\r\n                     Renewed {moment(team.renewedDateTime).toNow(true)} a go\r\n          </div>)} */}\r\n          </div>\r\n        )}{\" \"}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction Messages(props) {\r\n  if (!props.messages) return null;\r\n\r\n  return (\r\n    <div style={{ overflow: \"auto\", height: \"200px\" }}>\r\n      {_.orderBy(props.messages, [\"createdDateTime\"], [\"desc\"]).map(\r\n        (message, key) => {\r\n          var show =\r\n            message.body && message.body.content && message.body.content !== \"\"\r\n              ? true\r\n              : false;\r\n\r\n          if (!show) return null;\r\n\r\n          if (\r\n            message.from &&\r\n            message.from.user &&\r\n            message.from.user.displayName &&\r\n            _.startsWith(message.from.user.displayName, \"orgid:\")\r\n          ) {\r\n            return null;\r\n          }\r\n\r\n          var html = { __html: message.body.content };\r\n          return (\r\n            <div key={key}>\r\n              <a\r\n                href={message.webUrl}\r\n                target=\"_blank\"\r\n                style={{ color: \"inherit\", textDecoration: \"none\" }}\r\n              >\r\n                {message.from && message.from.user && (\r\n                  <div>\r\n                    <div>\r\n                      <b>\r\n                        {message.from.user.displayName} (\r\n                        {moment(message.createdDateTime).fromNow()})\r\n                      </b>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                <div dangerouslySetInnerHTML={html}></div>\r\n              </a>\r\n            </div>\r\n          );\r\n        }\r\n      )}\r\n    </div>\r\n  );\r\n}\r\nfunction TeamChannel(props) {\r\n  useEffect(() => {\r\n    async function load() {\r\n      if (!props.noMessages && props.team && props.channel) {\r\n        var _messages = await readTeamChannelMessages(\r\n          props.team.id,\r\n          props.channel.id\r\n        ).catch(() => {});\r\n        setMessages(_messages);\r\n      }\r\n    }\r\n    load();\r\n  }, [props.team, props.channel]);\r\n  const [mouseOver, setMouseOver] = useState(false);\r\n  const [messages, setMessages] = useState(null);\r\n\r\n  var channel = props.channel ? props.channel : {};\r\n\r\n  var details = props.details ? props.details : {};\r\n  var team = props.team ? props.team : {};\r\n\r\n  return (\r\n    <li\r\n      key={props.key}\r\n      className={`ms-font-m ${props.viewMode ? \"\" : \"teamchannelSelectMode\"} `}\r\n      onMouseEnter={() => {\r\n        setMouseOver(true);\r\n      }}\r\n      onMouseLeave={() => {\r\n        setMouseOver(false);\r\n      }}\r\n    >\r\n      <div\r\n        style={{\r\n          color: channel.membershipType === \"private\" ? \"red\" : \"#000000\",\r\n        }}\r\n      >\r\n        {mouseOver && !props.viewMode && (\r\n          <div\r\n            style={{\r\n              position: \"relative\",\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                position: \"absolute\",\r\n                right: \"4px\",\r\n                top: \"4px\",\r\n                zIndex: \"1\",\r\n              }}\r\n            >\r\n              <IconButton\r\n                styles={{ fontSize: \"24px\" }}\r\n                iconProps={{ iconName: \"Save\" }}\r\n                ariaLabel=\"Save\"\r\n                onClick={(event) => {\r\n                  if (props.onSaveChannel) {\r\n                    event.preventDefault(); // Let's stop this event.\r\n                    event.stopPropagation(); // Really this time.\r\n                    props.onSaveChannel(team, channel);\r\n                  }\r\n                }}\r\n              />\r\n            </div>{\" \"}\r\n          </div>\r\n        )}\r\n        <Highlight\r\n          text={channel.displayName}\r\n          filter={props.filter}\r\n          style={props.highlightStyle}\r\n        />\r\n      </div>\r\n      {channel.description && (\r\n        <div style={{ fontSize: \"smaller\", fontStyle: \"italic\" }}>\r\n          <Highlight\r\n            text={channel.description}\r\n            filter={props.filter}\r\n            style={props.highlightStyle}\r\n          />\r\n        </div>\r\n      )}\r\n      {channel.tabs && (\r\n        <div className=\"channelTabs\">\r\n          <ul>\r\n            <li>\r\n              {\" \"}\r\n              <span\r\n                onClick={() => {\r\n                  trace(EVENT.TABCLICKED, {\r\n                    \"team-name\": details.displayName,\r\n                    \"channel-name\": channel.displayName,\r\n                    href: channel.filesLink,\r\n                  });\r\n                }}\r\n              >\r\n                <a href={channel.generalLink} target=\"_blank\">\r\n                  General\r\n                </a>\r\n              </span>\r\n            </li>\r\n            <li>\r\n              <span\r\n                onClick={() => {\r\n                  trace(EVENT.TABCLICKED, {\r\n                    \"team-name\": details.displayName,\r\n                    \"channel-name\": channel.displayName,\r\n                    href: channel.filesLink,\r\n                  });\r\n                }}\r\n              >\r\n                <a href={channel.filesLink} target=\"_blank\">\r\n                  Files\r\n                </a>\r\n              </span>\r\n            </li>\r\n            {_.sortBy(channel.tabs, [\"sortOrderIndex\"]).map((tab, ix) => {\r\n              return (\r\n                <li key={ix}>\r\n                  <span\r\n                    onClick={() => {\r\n                      trace(EVENT.TABCLICKED, {\r\n                        \"team-name\": details.displayName,\r\n                        \"channel-name\": channel.displayName,\r\n                        \"tab-name\": tab.displayName,\r\n                        href: channel.filesLink,\r\n                      });\r\n                    }}\r\n                  >\r\n                    <a\r\n                      href={\r\n                        tab.configuration && tab.configuration.websiteUrl\r\n                          ? tab.configuration.websiteUrl\r\n                          : tab.webUrl\r\n                      }\r\n                      target=\"_blank\"\r\n                    >\r\n                      <Highlight\r\n                        text={decodeURIComponent(tab.displayName)}\r\n                        filter={props.filter}\r\n                        style={props.highlightStyle}\r\n                      />\r\n                    </a>\r\n                  </span>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        </div>\r\n      )}\r\n      {messages && <Messages messages={messages} />}\r\n    </li>\r\n  );\r\n}\r\n\r\nexport function ListTags(props) {\r\n  //debugger\r\n  if (!props.indexLaunzhContexts) return null;\r\n\r\n  if (!props.indexLaunzhContexts[props.href]) return null;\r\n  return (\r\n    <div style={{ margin: \"8px\", position: \"absolute\", bottom: \"0\", right: 0 }}>\r\n      {props.indexLaunzhContexts[props.href].map((tag, key) => {\r\n        return (\r\n          <span\r\n            onClick={() => {\r\n              window.location.href = `/board/${tag.name}`;\r\n            }}\r\n            className=\"tag\"\r\n            key={key}\r\n            style={{ color: tag.color, backgroundColor: tag.backgroundColor }}\r\n          >\r\n            #{tag.name}\r\n          </span>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport logo from \"./default/favicon-96x96.png\";\r\n\r\nexport default {\r\n  clientId: \"0387fbb2-eb27-4739-ba8a-814349f1a5c0\",\r\n  directoryId: \"df96b8c9-51a1-40cf-b8b1-4514be8e9668\",\r\n  scopes: \"https://graph.microsoft.com/TeamsActivity.Read  https://graph.microsoft.com/TeamsActivity.Send https://graph.microsoft.com/User.Read https://graph.microsoft.com/Channel.ReadBasic.All https://graph.microsoft.com/ChatMessage.Send https://graph.microsoft.com/People.Read https://graph.microsoft.com/Place.Read https://graph.microsoft.com/Place.Read.Shared https://graph.microsoft.com/Team.ReadBasic.All https://graph.microsoft.com/User.ReadBasic.All https://graph.microsoft.com/User.ReadWrite\",\r\n  title: \"My Jumpto365\",\r\n  logo, \r\n  defaultTableAPI: \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\r\n  niels: \"niels@jumpto365.com\",\r\n  teamsIntegration: true,\r\n  options: [],\r\n  components: {\r\n    header: (\r\n      <div style={{ marginTop: \"49px\" }}>\r\n        <div\r\n          style={{\r\n            borderBottom: \"1px solid #cccccc\",\r\n            position: \"fixed\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: \"100vw\",\r\n            left: 0,\r\n            top: 0,\r\n            zIndex: 1\r\n          }}\r\n        >\r\n          <div\r\n            style={{ display: \"flex\", padding:\"10px\" }}\r\n          >\r\n            <div style={{ flexGrow: 1 ,display: \"flex\"}}>\r\n              <div >\r\n                <a style={{ color:\"inherit\",textDecoration:\"none\" }}\r\n                \r\n                href=\"/\" target=\"_blank\"> <div \r\n              \r\n              className=\"ms-font-xl\"\r\n              style={{\r\n                marginLeft: \"16px\",\r\n                marginTop: \"0px\",\r\n                lineHeight: \"36px\",\r\n                padding: \"0px\",\r\n                color: \"333\",\r\n              }}><img style={{ height: \"36px\", padding: \"0px\",marginRight:\"10px\" }} src={logo} /> \r\n              jumpto365 for IT Pros</div>\r\n                   \r\n                </a>\r\n              </div>\r\n             \r\n\r\n            </div>\r\n            <div\r\n              \r\n              \r\n            >\r\n              \r\n            </div>\r\n            <div style={{ flexGrow: 1 }}>\r\n              <div style={{ minWidth: \"150px\" }}>&nbsp;</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    ),\r\n  },\r\n};\r\n","export function getSearchParametersFromHRef(href) {\r\n  if (!href) return {};\r\n  var search = {};\r\n  var s1 = href.split(\"?\");\r\n  if (s1.length > 1) {\r\n    var s2 = s1[1].split(\"&\");\r\n    for (let index = 0; index < s2.length; index++) {\r\n      const s3 = s2[index].split(\"=\");\r\n      search[s3[0]] = decodeURIComponent( s3[1]);\r\n    }\r\n  }\r\n  return search;\r\n}\r\n\r\nexport function getSearchParametersFromHash(href) {\r\n  if (!href) return {};\r\n  var search = {};\r\n  var s1 = href.split(\"#\");\r\n  if (s1.length > 1) {\r\n    var s2 = s1[1].split(\"&\");\r\n    for (let index = 0; index < s2.length; index++) {\r\n      const s3 = s2[index].split(\"=\");\r\n      search[s3[0]] = decodeURIComponent( s3[1]);\r\n    }\r\n  }\r\n  return search;\r\n}\r\nexport function inIframe() {\r\n  try {\r\n    return window.self !== window.top;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}","import React from \"react\";\r\nimport _ from \"lodash\";\r\nimport \"./BreakPointSelector.css\"\r\nexport default function BreakPointSelector(props) {\r\n  var breakPoints = props && props.breakpoints ? _.keys(props.breakpoints) : [];\r\n\r\n  return (\r\n    <div className=\"breakpoints\" style={{ display: \"flex\" }}>\r\n      {breakPoints.map((breakPoint, key) => {\r\n        return <div key={key} className={`breakpoint ${breakPoint===props.selected?\"selected\":\"\"}`} \r\n        \r\n        onClick={()=>{\r\n            \r\n            if (props.onSelect){\r\n                props.onSelect(breakPoint)\r\n            }\r\n        }}\r\n        >{breakPoint}</div>;\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { hiddenContentStyle, mergeStyles } from 'office-ui-fabric-react/lib/Styling';\r\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\r\nimport { ContextualMenu } from 'office-ui-fabric-react/lib/ContextualMenu';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField } from \"@fluentui/react\";\r\n\r\nconst dialogStyles = { main: { maxWidth: 450 } };\r\nconst dragOptions = {\r\n  moveMenuItemText: 'Move',\r\n  closeMenuItemText: 'Close',\r\n  menu: ContextualMenu,\r\n};\r\nconst screenReaderOnly = mergeStyles(hiddenContentStyle);\r\nconst dialogContentProps = {\r\n  type: DialogType.normal,\r\n  title: 'Name your board',\r\n  closeButtonAriaLabel: 'Close',\r\n  subText: 'Give your board a descriptive name, use 30-40 characters if you like',\r\n};\r\n\r\nexport default function AddBoard(props) {\r\n    const [hideDialog, setHideDialog] = useState(false);\r\n    const [name, setName] = useState(\"\");\r\n  const labelId = useId('dialogLabel');\r\n  const subTextId = useId('subTextLabel');\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n\r\n      <Dialog\r\n        hidden={hideDialog}\r\n        onDismiss={()=>{setHideDialog(true)}}\r\n        dialogContentProps={dialogContentProps}\r\n      \r\n      >\r\n       <TextField\r\n                    autoFocus={false}\r\n                 \r\n                    label=\"Name\"\r\n                    text={name}\r\n                    onChange={(e, newValue) => {\r\n                     setName(newValue)\r\n                    }}\r\n                    placeholder=\"\"\r\n                    xiconProps={{ iconName: \"Filter\" }}\r\n                  />\r\n        <DialogFooter>\r\n          <PrimaryButton  text=\"Save\"  disabled={name===\"\"} onClick={()=>{\r\n              setHideDialog(true)\r\n              if (props.onAdd){\r\n\r\n                props.onAdd(name)\r\n              }\r\n          }}/>\r\n          <DefaultButton  text=\"Cancel\" onClick={()=>{\r\n              setHideDialog(true)\r\n              if ( props.onDismiss)\r\n\r\n                props.onDismiss()\r\n              }\r\n          }\r\n          \r\n          />\r\n        </DialogFooter>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\n\r\n\r\n","/* \r\nTool Catalogue\r\n\r\nCopyright (c) jumpto365, Inc\r\n\r\nAll rights reserved.\r\n\r\nMIT License\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n * \r\n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\r\n */\r\n\r\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\r\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\r\n\r\nimport { initializeIcons } from \"@uifabric/icons\";\r\nimport axios from \"axios\";\r\nimport _ from \"lodash\";\r\nimport React, { useEffect, useState, useRef } from \"react\";\r\nimport \"react-grid-layout/css/styles.css\";\r\nimport \"react-resizable/css/styles.css\";\r\nimport ReactTags from \"react-tag-autocomplete\";\r\nimport \"./App.css\";\r\nimport { AppSuperTile } from \"./components/AppSuperTile\";\r\nimport ToolboxLayout, { breakpoints } from \"./components/ToolboxLayout\";\r\nimport { ViewErrors } from \"./components/ViewErrors\";\r\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\r\nimport config from \"./config\";\r\nimport \"./css/normalize.css\";\r\nimport \"./css/swimlane-process-map.webflow.css\";\r\nimport \"./css/webflow.css\";\r\nimport { getSearchParametersFromHRef, inIframe } from \"./helpers\";\r\nimport {\r\n  BOARDSPATH,\r\n  readCache,\r\n  readLayouts,\r\n  saveCache,\r\n  writeLayouts,\r\n  readBoardFiles,\r\n  readIndexOfLaunzhBoards,\r\n} from \"./helpers/LaunchPad\";\r\nimport { teamMemberships, getOneDriveFolder,myTeams } from \"./helpers/OfficeGraph\";\r\nimport { EVENT, trace } from \"./helpers/trace\";\r\n\r\nimport {\r\n  CommandBar,\r\n  getTheme,\r\n  Coachmark,\r\n  DirectionalHint,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n  Spinner,\r\n  Label,\r\n} from \"office-ui-fabric-react\";\r\n\r\nimport { navigate } from \"@reach/router\";\r\nimport BreakPointSelector from \"./components/BreakPointSelector\";\r\nimport {\r\n  MessageBarButton,\r\n  Link,\r\n  Stack,\r\n  StackItem,\r\n  MessageBar,\r\n  MessageBarType,\r\n  ChoiceGroup,\r\n  IStackProps,\r\n} from \"office-ui-fabric-react\";\r\nimport AddBoard from \"./components/AddBoard\";\r\n\r\nconst dragOptions = {\r\n  moveMenuItemText: \"Move\",\r\n  closeMenuItemText: \"Close\",\r\n  menu: ContextualMenu,\r\n};\r\nconst cancelIcon = { iconName: \"Cancel\" };\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n  container: {\r\n    display: \"flex\",\r\n    flexFlow: \"column nowrap\",\r\n    alignItems: \"stretch\",\r\n  },\r\n  header: [\r\n    // tslint:disable-next-line:deprecation\r\n    theme.fonts.xLargePlus,\r\n    {\r\n      flex: \"1 1 auto\",\r\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n      color: theme.palette.neutralPrimary,\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      fontWeight: FontWeights.semibold,\r\n      padding: \"12px 12px 14px 24px\",\r\n    },\r\n  ],\r\n  body: {\r\n    flex: \"4 4 auto\",\r\n    padding: \"0 24px 24px 24px\",\r\n    minWidth: \"95vw\",\r\n    minHeight: \"90vh\",\r\n    overflowY: \"hidden\",\r\n    selectors: {\r\n      p: { margin: \"14px 0\" },\r\n      \"p:first-child\": { marginTop: 0 },\r\n      \"p:last-child\": { marginBottom: 0 },\r\n    },\r\n  },\r\n});\r\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\r\nconst iconButtonStyles = {\r\n  root: {\r\n    color: theme.palette.neutralPrimary,\r\n    marginLeft: \"auto\",\r\n    marginTop: \"4px\",\r\n    marginRight: \"2px\",\r\n  },\r\n  rootHovered: {\r\n    color: theme.palette.neutralDark,\r\n  },\r\n};\r\nvar logSearchTimer;\r\nvar searchInfo;\r\n\r\ninitializeIcons();\r\n\r\nlet isOfficeInitialized = false;\r\nasync function getGraphToken(bootstrapToken) {\r\n  debugger;\r\n  return \"\";\r\n}\r\n/* Render application after Office initializes */\r\n\r\n\r\nif (window.Office){\r\n  window.Office.initialize = async () => {\r\n    isOfficeInitialized = true;\r\n\r\n  };\r\n}\r\n\r\n\r\nexport default function App(props) {\r\n  const upnIs = (upn) => {\r\n    try {\r\n      return props.auth.user.userPrincipalName === upn;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  };\r\n  const inFrame = inIframe();\r\n  const searchIconRef = useRef();\r\n  const [showTabFeature, setThowTabFeature] = useState(\r\n    config.teamsIntegration || upnIs(config.niels)\r\n  );\r\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\r\n  const [filter, _setFilter] = useState(\"\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [tiles, setTiles] = useState([]);\r\n  const [useAuthentication, setUseAuthentication] = useState(false);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isZoomed, setIsZoomed] = useState(false);\r\n  const [currentTile, setCurrentTile] = useState(null);\r\n  const [me, setMe] = useState({});\r\n  const [ztickyFolder, setZtickyFolder] = useState({});\r\n  var [myTools, setMyTools] = useState([]);\r\n  const [myTeams, setMyTeams] = useState([]);\r\n  const [ztickyRef, setZtickyRef] = useState(\"\");\r\n  const [tileSize, setTileSize] = useState(1);\r\n  const [errors, setErrors] = useState([]);\r\n  const [memberships, setMemberships] = useState([]);\r\n  const [contexts, setContexts] = useState([]);\r\n  const [selectedBoard, setSelectedBoard] = useState(props.board);\r\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\r\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\r\n  const [refreshing, setRefresing] = useState(false);\r\n  const [progress, setProgress] = useState(\"\");\r\n  const [progressPercent, setProgressPercent] = useState(null);\r\n  const [showTable, setShowTable] = useState(false);\r\n  const [editingLayout, setEditingLayout] = useState(true);\r\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\r\n  const [tableUrl, setTableUrl] = useState(\"\");\r\n  const [layouts, setLayouts] = useState({\r\n    lg: [\r\n      // {\r\n      //   x: 0,\r\n      //   y: Infinity,\r\n      //   w: 3,\r\n      //   h: 3,\r\n      //   i: \"1\",\r\n      //   static: 0, //Math.random() < 0.05,\r\n      // },\r\n    ],\r\n  });\r\n  const [joinedTeams,setJoinedTeams] =  useState([]);\r\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\r\n  const [refreshCounter, setRefreshCounter] = useState(0);\r\n  const [tags, setTags] = useState([]);\r\n  const [showDetails, _setShowDetails] = useState(true);\r\n  const [showCatalogue, _setShowCatalogue] = useState(!inIframe());\r\n  const [editMode, _setEditMode] = useState(false); //!inIframe());\r\n  const [isFixedWidth, setIsFixedWidth] = useState(true); //!inIframe());\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [tableApiSelected, setTableApiSelected] = useState(\r\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\r\n  );\r\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\r\n  const [groups, setGroups] = useState([]);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedBreakPoint, setSelectedBreakPoint] = useState(\"lg\");\r\n  const [isMounted, setIsMounted] = useState(false);\r\n  const [isDirty, setIsDirty] = useState(false);\r\n  const [showWarning, setShowWarning] = useState(true);\r\n  const [indexLaunzhContexts, setIndexLaunzhContexts] = useState([]);\r\n  const [myDrive, setMyDrive] = useState(\"\");\r\n  const [addingBoard, setAddingBoard] = useState(false);\r\n  function gotoBoard(boardName) {\r\n    setSelectedBoard(boardName);\r\n    window.location.href = `/board/${boardName}`;\r\n  }\r\n  function setEditMode(on) {\r\n    if (on) {\r\n      setIsDirty(false);\r\n    }\r\n    _setEditMode(on);\r\n  }\r\n  function setShowDetails(on) {\r\n    _setShowDetails(on);\r\n    trace(EVENT.DETAILSTOGGLED, { on });\r\n  }\r\n  function setShowCatalogue(on) {\r\n    _setShowCatalogue(on);\r\n    setIsModalOpen(true);\r\n    trace(EVENT.SEARCHCLICKED, { on });\r\n  }\r\n\r\n  function setFilter(value) {\r\n    setSearch(value);\r\n    if (_.startsWith(value, \".\")) {\r\n    } else {\r\n      _setFilter(value);\r\n    }\r\n  }\r\n\r\n  const _setTags = (t) => {\r\n    debugger;\r\n    setTags(t);\r\n  };\r\n\r\n  const removePin = (pinId) => {\r\n    var keys = _.keys(layouts);\r\n    keys.forEach((key) => {\r\n      layouts[key].splice(pinId, 1);\r\n\r\n      layouts[key] = layouts[key].map((m, ix) => {\r\n        m.i = ix.toString();\r\n        return m;\r\n      });\r\n    });\r\n\r\n    myTeams.splice(pinId, 1);\r\n\r\n    setLayouts(layouts);\r\n\r\n    setMyTeams(myTeams);\r\n    setRefreshCounter(refreshCounter + 1);\r\n  };\r\n\r\n  const getPin = (id, width, height, refresh) => {\r\n    var team = myTeams[parseInt(id)];\r\n    return (\r\n      <ViewTeam\r\n        indexLaunzhContexts={indexLaunzhContexts}\r\n        editMode={editMode}\r\n        refreshCounter={refresh}\r\n        key={id}\r\n        width={width}\r\n        height={height}\r\n        team={team}\r\n        pinId={parseInt(id)}\r\n        isPinned\r\n        onRemovePin={removePin}\r\n      />\r\n    );\r\n  };\r\n  const addChannel = (team, channel) => {\r\n    addPin(team, channel);\r\n  };\r\n  const addPin = (team, channel) => {\r\n    var _team = _.cloneDeep(team);\r\n\r\n    _team.channel = channel;\r\n    var id = myTeams.push(_team);\r\n    var keys = _.keys(layouts);\r\n    keys.forEach((key) => {\r\n      id = layouts[key].length.toString();\r\n      layouts[key].push({\r\n        team: team.id,\r\n        x: 0,\r\n        y: id * 2,\r\n        w: 2,\r\n        h: 2,\r\n\r\n        i: id,\r\n      });\r\n    });\r\n\r\n    setLayouts(layouts);\r\n    setEditMode(true);\r\n    setRefreshCounter(refreshCounter + 1);\r\n    setIsModalOpen(false);\r\n    setMyTeams(myTeams);\r\n  };\r\n  const showSearch = () => {\r\n    setShowCatalogue(!showCatalogue);\r\n    setRefreshCounter(refreshCounter + 1);\r\n  };\r\n  useEffect(() => {\r\n    async function load() {\r\n      if (selectedBoard) {\r\n        window.document.title = \"LAUNZH - \" + selectedBoard;\r\n      }\r\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\r\n\r\n      if (showTabFeature) initGraph(false);\r\n\r\n      var search = getSearchParametersFromHRef(window.location.href);\r\n      if (search.ztickyref) {\r\n        setZtickyRef(search.ztickyref);\r\n      }\r\n      var href = search.src ? search.src : config.defaultTableAPI;\r\n      setIndexLaunzhContexts(await readIndexOfLaunzhBoards().catch(() => {})); // might not be one\r\n      readBoardFiles()\r\n        .then((files) => {\r\n          var ctxs = [];\r\n          files.forEach((file) => {\r\n            if (_.endsWith(file.name.toLowerCase(), \".json\")) {\r\n              var key = file.name.split(\".\")[0];\r\n              ctxs.push({ key: key, text: key });\r\n            }\r\n          });\r\n          setContexts(ctxs);\r\n        })\r\n        .catch((error) => {\r\n          //errors.push({ context: \"readContexts\", error });\r\n          //setErrors(errors);\r\n          //setIsMounted(true);\r\n        });\r\n      if (!isLoaded) {\r\n        setIsLoaded(true);\r\n        var l = await readLayouts(BOARDSPATH, boardFileName()).catch((e) => {});\r\n        if (l) {\r\n          setMyTeams(l.myTeams);\r\n          setLayouts(l.layouts);\r\n          setRefreshCounter(refreshCounter + 1);\r\n        }\r\n        setIsMounted(true);\r\n      }\r\n\r\n      setTableUrl(config.defaultTableAPI);\r\n      readGrid(href, config.defaultTableKey);\r\n\r\n      if (!myDrive) {\r\n        var drive = await getOneDriveFolder(BOARDSPATH).catch(() => {});\r\n        if (drive) {\r\n          setMyDrive(drive.webUrl);\r\n        }\r\n      }\r\n    }\r\n\r\n    load();\r\n  }, [refreshCounter, selectedBoard]);\r\n\r\n  function readGrid(href, tableId) {\r\n    axios.get(href).then(({ data }) => {\r\n      setTitlegraphics(data.titlegraphics);\r\n      var tiles = [];\r\n      if (data.grid) {\r\n        var groups = {};\r\n        var groupRefs = {};\r\n        data.grid.forEach((row) => {\r\n          return row.forEach((cell) => {\r\n            if (cell.groupSetting) {\r\n              groups[cell.groupSetting.title] = {\r\n                groupSetting: cell.groupSetting,\r\n                members: cell.members,\r\n              };\r\n              if (cell.members) {\r\n                cell.members.forEach((id) => {\r\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\r\n                  refs.push(cell.groupSetting);\r\n                  groupRefs[id] = refs;\r\n                });\r\n              }\r\n            }\r\n          });\r\n        });\r\n\r\n        var g = _.keys(groups);\r\n        var ga = g.map((name) => {\r\n          return { title: name, ...groups[name] };\r\n        });\r\n\r\n        setGroups(_.sortBy(ga, [\"title\"]));\r\n\r\n        data.grid.forEach((row) => {\r\n          return row.forEach((cell) => {\r\n            if (cell.tile && cell.tile.title) {\r\n              var tile = { ...cell.tile };\r\n              tile.sortKey = _.toLower(cell.tile.title);\r\n              tile.tableId = tableId;\r\n              tile.correlation =\r\n                href +\r\n                \"#\" +\r\n                (tile.key\r\n                  ? tile.key\r\n                  : tile.title\r\n                  ? tile.title.toLowerCase()\r\n                  : tile.id);\r\n              var references = groupRefs[cell.id];\r\n              tile.references = references;\r\n              tiles.push(tile);\r\n            }\r\n          });\r\n        });\r\n      }\r\n\r\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\r\n    });\r\n  }\r\n\r\n  async function initGraph(refresh) {\r\n    try {\r\n      if (refresh) {\r\n      }\r\n      var queueCount = 0;\r\n\r\n      // await OfficeGraph.initStorage();\r\n\r\n      myTeams().then(teams =>{\r\n        setJoinedTeams(teams)\r\n      })\r\n\r\n      var localCache = localStorage.getItem(\"memberships\");\r\n      var cachedMemberships;\r\n      try {\r\n        if (localCache && !refresh) {\r\n          cachedMemberships = JSON.parse(localCache);\r\n          setMemberships(cachedMemberships);\r\n\r\n          return;\r\n        }\r\n      } catch (error) {}\r\n\r\n      setRefresing(true);\r\n      cachedMemberships = await readCache().catch((error) => {\r\n        errors.push({ context: \"readCache\", error });\r\n        setErrors(errors);\r\n      });\r\n\r\n      if (cachedMemberships && !refresh) {\r\n        setMemberships(cachedMemberships);\r\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\r\n        setRefresing(false);\r\n      } else {\r\n        queueCount++;\r\n        setProgress(\"Loading\");\r\n        teamMemberships((percent) => {\r\n          setProgressPercent(percent);\r\n        })\r\n          .then(async (memberships) => {\r\n            await saveCache(memberships).catch((error) => {\r\n              errors.push({ context: \"saveCache\", error });\r\n              setErrors(errors);\r\n            });\r\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\r\n            queueCount--;\r\n            if (queueCount === 0) setRefresing(false);\r\n            trace(EVENT.MEMBERSHIPSREAD, {\r\n              \"count-memberships\": memberships.length,\r\n            });\r\n            setMemberships(memberships);\r\n\r\n            setProgress(\"\");\r\n          })\r\n          .catch((error) => {\r\n            debugger;\r\n            queueCount--;\r\n            if (queueCount <= 0) setRefresing(false);\r\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\r\n            setErrors(errors);\r\n            setProgress(\"\");\r\n          });\r\n      }\r\n      return;\r\n      // OfficeGraph.initTileStorage()\r\n      //   .then(async (ztickyFolder) => {\r\n      //     setZtickyFolder(ztickyFolder);\r\n      //     queueCount++;\r\n\r\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\r\n      //       ztickyFolder\r\n      //     );\r\n      //     //debugger\r\n      //     var myTools = [];\r\n      //     if (version < 0) {\r\n      //       var tileFolders = await OfficeGraph.getMyTools(\r\n      //         ztickyFolder,\r\n      //         refresh\r\n      //       );\r\n      //       myTools = tileFolders.map((folder) => {\r\n      //         return {\r\n      //           title: folder.tile ? folder.tile.title : folder.name,\r\n      //           tile: folder.tile,\r\n      //         };\r\n      //       });\r\n      //     } else {\r\n      //       myTools = properties.tiles.map((tile) => {\r\n      //         if (!tile) return null;\r\n\r\n      //         return { title: tile.title, tile };\r\n      //       });\r\n      //     }\r\n\r\n      //     queueCount--;\r\n      //     if (queueCount === 0) setRefresing(false);\r\n      //     setMyTools(myTools);\r\n      //     setLayouts(layouts);\r\n      //   })\r\n      //   .catch((error) => {\r\n      //     queueCount--;\r\n      //     if (queueCount <= 0) setRefresing(false);\r\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\r\n      //     setErrors(errors);\r\n      //   });\r\n    } catch (error) {\r\n      errors.push({ context: \"initGraph\", error });\r\n      setErrors(errors);\r\n    }\r\n  }\r\n\r\n  function matchFilter(tile) {\r\n    if (!filter) return true;\r\n    var match =\r\n      tile &&\r\n      tile.title &&\r\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        tile &&\r\n        tile.inShort &&\r\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        tile &&\r\n        tile.subTitle &&\r\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n\r\n    return match;\r\n  }\r\n\r\n  function matchTeam(team) {\r\n    var include = true;\r\n    if (tags.length > 0) {\r\n      include = false;\r\n      tags.forEach((tag) => {\r\n        switch (tag.id) {\r\n          case \"sharepoint\":\r\n            if (team.hasSharePoint) {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"teams\":\r\n            if (team.hasTeams) {\r\n              include = true;\r\n            }\r\n\r\n            break;\r\n          case \"yammer\":\r\n            if (team.hasYammer) {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"private\":\r\n            if (team.visibility === \"Private\") {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"public\":\r\n            if (team.visibility === \"Public\") {\r\n              include = true;\r\n            }\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      });\r\n    }\r\n    if (!include) return false;\r\n    if (!filter) return true;\r\n    var details = team.data && team.data.details ? team.data.details : {};\r\n    var channels = team.data && team.data.channels ? team.data.channels : [];\r\n    var match =\r\n      details.displayName &&\r\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        details.description &&\r\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    channels.forEach((channel) => {\r\n      if (!match) {\r\n        match =\r\n          channel.displayName &&\r\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\r\n            -1;\r\n      }\r\n      if (!match) {\r\n        match =\r\n          channel.description &&\r\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\r\n            -1;\r\n      }\r\n    });\r\n\r\n    return match;\r\n  }\r\n  function persistLayouts(newLayouts) {\r\n    if (!isMounted) {\r\n      console.log(\"not mounted, persistLayouts dropped\");\r\n      return;\r\n    }\r\n    setLayouts(newLayouts);\r\n    setIsDirty(true);\r\n  }\r\n  async function saveLayout() {\r\n    if (!isMounted) {\r\n      console.log(\"not mounted, persistLayouts dropped\");\r\n      return;\r\n    }\r\n\r\n    console.log(\"persistLayouts\");\r\n\r\n    await writeLayouts(BOARDSPATH, boardFileName(), {\r\n      layouts,\r\n      myTeams,\r\n    }).catch((error) => {\r\n      errors.push({ context: \"  writeLayouts\", error });\r\n      setErrors(errors);\r\n    });\r\n\r\n    setIsDirty(false);\r\n  }\r\n\r\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\r\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\r\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\r\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\r\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\r\n  if (filter || tags.length > 0) {\r\n    tiles.forEach((tile) => {\r\n      if (matchFilter(tile)) {\r\n        filteredTiles.push(tile);\r\n      }\r\n    });\r\n    myTools.forEach((folder) => {\r\n      if (matchFilter(folder.tile)) {\r\n        filteredMyTools.push(folder);\r\n      }\r\n    });\r\n\r\n    memberships.forEach((team) => {\r\n      if (matchTeam(team)) {\r\n        filteredMemberShips.push(team);\r\n      }\r\n    });\r\n\r\n    // if (\r\n    //   searchInfo &&\r\n    //   searchInfo[\"search-for\"] &&\r\n    //   searchInfo[\"search-for\"] === filter\r\n    // )\r\n    //   return;\r\n\r\n    // searchInfo = {\r\n    //   \"search-for\": filter,\r\n    //   \"found-memberships\": filteredMemberShips.length,\r\n    //   \"found-tiles\": filteredMyTools.length,\r\n    // };\r\n\r\n    if (logSearchTimer) {\r\n      console.log(\"Postponing search trace\");\r\n      clearTimeout(logSearchTimer);\r\n    }\r\n    console.log(\"Timeing search trace\");\r\n    logSearchTimer = setTimeout(() => {\r\n      console.log(\"sending search trace\");\r\n      trace(EVENT.SEARCHING, searchInfo);\r\n      logSearchTimer = null;\r\n    }, 1000);\r\n  }\r\n\r\n  const dropdownStyles = {\r\n    dropdown: { flexGrow: 1, border: \"1px\" },\r\n  };\r\n\r\n  if (!(props && props.auth)) {\r\n    return null;\r\n    // (\r\n    //   <div>\r\n    //     <h1>Sorry - You cannot get in here</h1>\r\n    //     {JSON.stringify(\r\n    //       props && props.auth && props.auth.error ? props.auth.error : \"\"\r\n    //     )}\r\n    //   </div>\r\n    // );\r\n  }\r\n  var editorCanvasWidth = editMode ? breakpoints[selectedBreakPoint] : null;\r\n  const buttonProps = {\r\n    text: \"Try it\",\r\n  };\r\n\r\n  const buttonProps2 = {\r\n    text: \"Try it again\",\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {!inFrame && config.components.header}\r\n      {/* <CommandBar\r\n        // items={_items}\r\n        // overflowItems={_overflowItems}\r\n        // overflowButtonProps={overflowProps}\r\n        farItems={[\r\n          // {\r\n          //   key: \"tile\",\r\n          //   text: \"Grid view\",\r\n          //   // This needs an ariaLabel since it's icon-only\r\n          //   ariaLabel: \"Filter view\",\r\n          //   iconOnly: true,\r\n          //   iconProps: { iconName: \"Filter\" },\r\n          //   onClick: () => {\r\n          //     if (showFilterOptions) {\r\n          //       setFilter(\"\");\r\n          //     }\r\n          //     setShowFilterOptions(!showFilterOptions);\r\n          //   }\r\n          // }\r\n        ]}\r\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\r\n      /> */}\r\n      <div>\r\n        {\" \"}\r\n        {errors.length !== 0 && (\r\n          <div>\r\n            <ViewErrors errors={errors} />\r\n          </div>\r\n        )}\r\n        {progress && (\r\n          <div\r\n            style={{\r\n              backgroundColor: \"white\",\r\n              width: \"100vw\",\r\n              position: \"fixed\",\r\n              top: \"0px\",\r\n              zIndex: 2,\r\n            }}\r\n          >\r\n            <ProgressIndicator\r\n              percentComplete={progressPercent}\r\n              xlabel=\"Example title\"\r\n              xdescription={progress}\r\n            />\r\n          </div>\r\n        )}\r\n        <img\r\n          style={{\r\n            display: \"none\",\r\n            height: \"64px\",\r\n            margin: \"13px\",\r\n            position: \"fixed\",\r\n            bottom: \"0px\",\r\n            right: \"0px\",\r\n          }}\r\n          src={titlegraphics}\r\n        ></img>\r\n        {!isZoomed && (\r\n          <div style={{ display: \"flex\" }}>\r\n            {\" \"}\r\n            <div\r\n              style={{\r\n                display: \"xnone\",\r\n                paddingRight: \"8px\",\r\n                position: \"fixed\",\r\n                bottom: \"0px\",\r\n                backgroundColor: \"white\",\r\n              }}\r\n            >\r\n              {showTabFeature && (\r\n                <div>\r\n                  <i\r\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                    className=\"ms-Icon ms-Icon--Refresh\"\r\n                    onClick={() => {\r\n                      initGraph(true);\r\n                    }}\r\n                    aria-hidden=\"true\"\r\n                  ></i>{\" \"}\r\n                  {refreshing && <>Loading</>}\r\n                </div>\r\n              )}\r\n            </div>\r\n            {!inFrame && (\r\n              <div\r\n                style={{\r\n                  position: \"fixed\",\r\n                  right: 0,\r\n                  top: 0,\r\n                  zIndex: 32,\r\n                  marginRight: \"16px\",\r\n                  width: \"calc(100vw - 200px)\",\r\n                }}\r\n              >\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div\r\n                    style={{\r\n                      marginLeft: \"16px\",\r\n                      marginTop: \"10px\",\r\n                      flexGrow: 1,\r\n                    }}\r\n                  >\r\n                    {\" \"}\r\n                    {!editMode && (\r\n                      <div style={{ display: \"flex\" }}>\r\n                        <div\r\n                          style={{\r\n                            flexGrow: 1,\r\n                          }}\r\n                        >\r\n                          <Dropdown\r\n                            disabled={showTable}\r\n                            placeholder=\"Select board\"\r\n                            selectedKey={selectedBoard}\r\n                            xlabel=\"View as\"\r\n                            onChanged={(option, index) => {\r\n                              gotoBoard(option.key);\r\n\r\n                              //debugger\r\n                            }}\r\n                            options={contexts.map((ctx) => {\r\n                              return { key: ctx.key, text: ctx.text };\r\n                            })}\r\n                            styles={dropdownStyles}\r\n                          />\r\n                        </div>\r\n                        <div\r\n                          style={{\r\n                            marginLeft: \"16px\",\r\n                            xmarginTop: \"4px\",\r\n                          }}\r\n                        >\r\n                          <IconButton\r\n                            styles={{ fontSize: \"24px\" }}\r\n                            iconProps={{ iconName: \"Add\" }}\r\n                            ariaLabel=\"Add\"\r\n                            onClick={() => setAddingBoard(true)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {addingBoard && (\r\n                    <AddBoard\r\n                      onDismiss={() => {\r\n                        setAddingBoard(false);\r\n                      }}\r\n                      onAdd={(name) => {\r\n                        gotoBoard(name);\r\n                        setAddingBoard(false);\r\n                      }}\r\n                    />\r\n                  )}\r\n                  {editMode && (\r\n                    <>\r\n                      <div style={{ marginTop: \"16px\", marginRight: \"8px\" }}>\r\n                        Screen width&nbsp;\r\n                      </div>\r\n                      <div>\r\n                        <BreakPointSelector\r\n                          selected={selectedBreakPoint}\r\n                          breakpoints={breakpoints}\r\n                          onSelect={(breakPoint) => {\r\n                            setSelectedBreakPoint(breakPoint);\r\n                          }}\r\n                        />\r\n                      </div>\r\n\r\n                      <div style={{ marginTop: \"8px\" }}>\r\n                        <IconButton\r\n                          styles={{ fontSize: \"24px\" }}\r\n                          disabled={!isDirty}\r\n                          iconProps={{ iconName: \"Save\" }}\r\n                          ariaLabel=\"Save\"\r\n                          onClick={() => saveLayout()}\r\n                        />\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Edit</div>\r\n\r\n                  <div style={{ marginTop: \"16px\" }}>\r\n                    <Toggle\r\n                      checked={editMode}\r\n                      onChange={(e, checked) => {\r\n                        setEditMode(checked);\r\n                        setRefreshCounter(refreshCounter + 1);\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div style={{ marginTop: \"4px\" }}>\r\n                    <CommandBar\r\n                      farItems={[\r\n                        // {\r\n                        //   key: \"tile\",\r\n                        //   text: \"Grid view\",\r\n                        //   // This needs an ariaLabel since it's icon-only\r\n                        //   ariaLabel: \"Grid view\",\r\n                        //   iconOnly: true,\r\n                        //   iconProps: { iconName: \"Tiles\" },\r\n                        //   onClick: () => console.log(\"Tiles\"),\r\n                        // },\r\n                        {\r\n                          key: \"info\",\r\n                          text: \"Info\",\r\n                          // This needs an ariaLabel since it's icon-only\r\n                          ariaLabel: \"Info\",\r\n                          iconOnly: true,\r\n                          iconProps: { iconName: \"CollapseMenu\" },\r\n                          onClick: () => console.log(\"Info\"),\r\n                          subMenuProps: {\r\n                            items: [\r\n                              {\r\n                                key: \"allBoards\",\r\n                                text: \"Boards\",\r\n                                iconProps: { iconName: \"AllApps\" },\r\n                                onClick: () => {\r\n                                  navigate(\"/boards\");\r\n                                }, // optional\r\n                              },\r\n                              {\r\n                                key: \"check\",\r\n                                text: \"Check\",\r\n                                iconProps: { iconName: \"ReceiptCheck\" },\r\n                                onClick: () => {\r\n                                  navigate(\"/check\");\r\n                                }, // optional\r\n                              },\r\n                              {\r\n                                key: \"onedrive\",\r\n                                text: \"OneDrive files\",\r\n                                disabled: !myDrive,\r\n                                iconProps: { iconName: \"OneDriveLogo\" },\r\n                                onClick: () => {\r\n                                  window.open(myDrive);\r\n                                }, // optional\r\n                              },\r\n\r\n                              {\r\n                                key: \"signout\",\r\n                                text: \"Sign Out\",\r\n                                iconProps: { iconName: \"SignOut\" },\r\n                                onClick: () => {\r\n                                  if (props.signOut) {\r\n                                    props.signOut();\r\n                                  }\r\n                                }, // optional\r\n                              },\r\n                              {\r\n                                key: \"debug\",\r\n                                text: \"Debug\",\r\n                                iconProps: { iconName: \"SearchAndApps\" },\r\n                                onClick: () => {\r\n                                  navigate(\"/debug\");\r\n                                }, // optional\r\n                              },\r\n                            ],\r\n                          },\r\n                        },\r\n                      ]}\r\n                      ariaLabel=\"Use left and right arrow keys to navigate between commands\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* <div style={{ marginTop: \"16px\" }}>\r\n                    <Toggle\r\n                      checked={showCatalogue}\r\n                      onChange={(e, checked) => {\r\n                        setShowCatalogue(checked);\r\n                        setRefreshCounter(refreshCounter + 1);\r\n                      }}\r\n                    />\r\n                  </div> */}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div style={{ flexGrow: \"1\" }}>\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  flexWrap: \"wrap\",\r\n                  marginTop: \"8px\",\r\n                }}\r\n              >\r\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\r\n                  {/* <TextField\r\n                    autoFocus={true}\r\n                    disabled={showTable}\r\n                    xlabel=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Start typing any characters to filter \"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  /> */}\r\n\r\n                  {/* */}\r\n                </div>{\" \"}\r\n              </div>\r\n              <div\r\n                style={{\r\n                  position: \"fixed\",\r\n                  right: 0,\r\n                  bottom: 0,\r\n                  zIndex: 32,\r\n                }}\r\n              >\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\r\n                    <i\r\n                      ref={searchIconRef}\r\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                      className=\"ms-Icon ms-Icon--Add tilesearch\"\r\n                      onClick={() => {\r\n                        showSearch();\r\n                      }}\r\n                      aria-hidden=\"true\"\r\n                    ></i>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div style={isFixedWidth ? { backgroundColor: \"#666666\" } : {}}>\r\n                <div\r\n                  style={\r\n                    editMode\r\n                      ? {\r\n                          marginRight: \"auto\",\r\n                          marginLeft: \"auto\",\r\n                          width: editorCanvasWidth,\r\n                          minHeight: \"100vh\",\r\n                          backgroundColor: \"#ffffff\",\r\n                        }\r\n                      : isFixedWidth\r\n                      ? {\r\n                          marginRight: \"auto\",\r\n                          marginLeft: \"auto\",\r\n                          maxWidth: 1200,\r\n                          minHeight: \"100vh\",\r\n                          backgroundColor: \"#ffffff\",\r\n                        }\r\n                      : {}\r\n                  }\r\n                >\r\n                  {!isMounted && (\r\n                    <div style={{ height: \"90vh\", marginTop: \"40vh\" }}>\r\n                      <Spinner label=\"Assembling your board ...\" />\r\n                    </div>\r\n                  )}\r\n                  {isMounted && myTeams.length === 0 && showWarning && (\r\n                    <MessageBar\r\n                      messageBarType={MessageBarType.warning}\r\n                      isMultiline={false}\r\n                      onDismiss={() => {\r\n                        setShowWarning(false);\r\n                      }}\r\n                      dismissButtonAriaLabel=\"Close\"\r\n                      xactions={\r\n                        <div>\r\n                          <MessageBarButton\r\n                            onClick={() => {\r\n                              setEditMode(true);\r\n                              setShowWarning(false);\r\n                              showSearch();\r\n                            }}\r\n                          >\r\n                            {\" \"}\r\n                            Add Tiles\r\n                          </MessageBarButton>\r\n                        </div>\r\n                      }\r\n                    >\r\n                      Hi, you are not member of any Teams\r\n                    </MessageBar>\r\n                  )}\r\n\r\n                  <Coachmark\r\n                    target={searchIconRef}\r\n                    positioningContainerProps={{\r\n                      directionalHint: DirectionalHint.topAutoEdge,\r\n                      doNotLayer: false,\r\n                    }}\r\n                    ariaAlertText=\"A Coachmark has appeared\"\r\n                    ariaDescribedBy={\"coachmark-desc1\"}\r\n                    ariaLabelledBy={\"coachmark-label1\"}\r\n                    ariaDescribedByText={\r\n                      \"Press enter or alt + C to open the Coachmark notification\"\r\n                    }\r\n                    ariaLabelledByText={\"Coachmark notification\"}\r\n                  >\r\n                    Welcome to the land of Coachmarks!\r\n                  </Coachmark>\r\n                  <ToolboxLayout\r\n                    indexLaunzhContexts={indexLaunzhContexts}\r\n                    tools={myTools}\r\n                    layouts={layouts}\r\n                    persist={persistLayouts}\r\n                    editMode={editMode}\r\n                    getPin={getPin}\r\n                    onRemovePin={removePin}\r\n                    fixedWidth={editorCanvasWidth}\r\n                    onTileClick={(tile) => {\r\n                      setCurrentTile(tile);\r\n                      setIsZoomed(true);\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* {siteUrl && (\r\n                 \r\n                    <h3>Which tools do you find good for this site?</h3>\r\n                    <div>{siteUrl.hostname}</div>\r\n                    <TextField\r\n                      label=\"Label\"\r\n                      placeholder=\"Enter label for this link\"\r\n                      value={siteUrlLabel}\r\n                      onChange={(e, value) => {\r\n                        setSiteUrlLabel(value);\r\n                      }}\r\n                    ></TextField>\r\n                    <TextField\r\n                      label=\"URL\"\r\n                      placeholder=\"Enter URL\"\r\n                      value={siteUrlHref}\r\n                      onChange={(e, value) => {\r\n                        setSiteUrlHref(value);\r\n                      }}\r\n                    ></TextField>\r\n                    <PrimaryButton\r\n                      text=\"Share link\"\r\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\r\n                    />\r\n                  </PivotItem>\r\n                )} */}\r\n              {/* <PivotItem\r\n                  key=\"catalogue\"\r\n                  headerText=\"Catalogue\"\r\n                  itemCount={filteredTiles.length}\r\n                > */}\r\n              {showTable && (\r\n                <>\r\n                  <div style={{ textAlign: \"right\" }}>\r\n                    <i\r\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\r\n                      onClick={() => {\r\n                        window.open(tableUrl, \"_blank\");\r\n                      }}\r\n                      aria-hidden=\"true\"\r\n                    ></i>\r\n                  </div>\r\n                  <iframe\r\n                    style={{\r\n                      border: \"0\",\r\n                      height: \"calc(100vh - 150px\",\r\n                      width: \"95vw\",\r\n                    }}\r\n                    src={tableUrl}\r\n                  ></iframe>\r\n                </>\r\n              )}\r\n              {/* {showCatalogue && showTabFeature && memberships.length > 0 && ( */}\r\n              <Modal\r\n                titleAriaId={1}\r\n                isOpen={isModalOpen}\r\n                onDismiss={() => setIsModalOpen(false)}\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n                xdragOptions={dragOptions}\r\n              >\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div style={{ flexGrow: 1 }}></div>\r\n                  <div>\r\n                    <IconButton\r\n                      styles={iconButtonStyles}\r\n                      iconProps={cancelIcon}\r\n                      ariaLabel=\"Close popup modal\"\r\n                      onClick={() => setIsModalOpen(false)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className={contentStyles.body}>\r\n                  <TextField\r\n                    autoFocus={false}\r\n                    disabled={showTable}\r\n                    xlabel=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match \"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  />\r\n                  <div style={{ display: \"flex\" }}>\r\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\r\n                      Show details\r\n                    </div>\r\n                    <div style={{ marginTop: \"16px\" }}>\r\n                      <Toggle\r\n                        checked={showDetails}\r\n                        onChange={(e, checked) => {\r\n                          setShowDetails(checked);\r\n                          setRefreshCounter(refreshCounter + 1);\r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      {/* <ReactTags\r\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\r\n                    autofocus={false}\r\n                    tags={tags}\r\n                    suggestions={[\r\n                      {\r\n                        name: \"Teams\",\r\n                        id: \"teams\",\r\n                      },\r\n                      {\r\n                        name: \"SharePoint\",\r\n                        id: \"sharepoint\",\r\n                      },\r\n                      {\r\n                        name: \"Yammer\",\r\n                        id: \"yammer\",\r\n                      },\r\n                      {\r\n                        name: \"Private\",\r\n                        id: \"private\",\r\n                      },\r\n                      {\r\n                        name: \"Public\",\r\n                        id: \"public\",\r\n                      },\r\n                    ]}\r\n                    handleDelete={(i) => {\r\n                      const tgs = tags.slice(0);\r\n                      tgs.splice(i, 1);\r\n                      setTags(tgs);\r\n                      setRefreshCounter(refreshCounter + 1);\r\n                    }}\r\n                    handleAddition={(tag) => {\r\n                      var tgs = [].concat(tags, tag);\r\n                      setTags(tgs);\r\n                      setRefreshCounter(refreshCounter + 1);\r\n                    }}\r\n                  />  */}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <ViewTeams\r\n                    onSaveTeam={addPin}\r\n                    onSaveChannel={addChannel}\r\n                    refreshCounter={refreshCounter}\r\n                    tiles={filteredTiles}\r\n                    details={showDetails}\r\n                    memberShips={filteredMemberShips}\r\n                    filter={filter}\r\n                    highlightStyle={{ backgroundColor: \"yellow\" }}\r\n                  />\r\n                </div>\r\n              </Modal>\r\n              {/* )} */}\r\n              {!showTable && !showTabFeature && (\r\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\r\n                  {filteredTiles.length === 0 && (\r\n                    <div>\r\n                      <h2>Sorry. No matches for \"{filter}\"</h2>\r\n                      {/* <h1>\r\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\r\n                          Request a link\r\n                        </a>\r\n                      </h1> */}\r\n                    </div>\r\n                  )}\r\n                  {filteredTiles.map((tile, key) => {\r\n                    if (selectedGroup) {\r\n                      var match = false;\r\n\r\n                      if (!tile.references) return null;\r\n                      tile.references.forEach((r) => {\r\n                        if (r.title === selectedGroup) {\r\n                          match = true;\r\n                        }\r\n                      });\r\n                      if (!match) return null;\r\n                    }\r\n                    return (\r\n                      <AppSuperTile\r\n                        tileSize={tileSize}\r\n                        key={key}\r\n                        filter={filter}\r\n                        highlightStyle={{\r\n                          backgroundColor: \"yellow\",\r\n                          color: \"#333\",\r\n                        }}\r\n                        tile={tile}\r\n                        onPinnedClicked={(props) => {\r\n                          if (props.tile) {\r\n                            addPin(props.tile);\r\n                          }\r\n                        }}\r\n                        onClick={(tile) => {\r\n                          if (window.amplitude) {\r\n                            if (\r\n                              props &&\r\n                              props.auth &&\r\n                              props.auth.user &&\r\n                              props.auth.user.userPrincipalName\r\n                            )\r\n                              window.amplitude\r\n                                .getInstance()\r\n                                .identify(props.auth.user.userPrincipalName);\r\n                            window.amplitude\r\n                              .getInstance()\r\n                              .logEvent(\"tool\", tile);\r\n                          }\r\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\r\n                            return window.open(tile.jumpto, \"_blank\");\r\n                          }\r\n                          setCurrentTile(tile);\r\n                          setIsZoomed(true);\r\n                        }}\r\n                      />\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n\r\n              {/* \r\n\r\n              */}\r\n            </div>\r\n            {showFilterOptions && (\r\n              <div\r\n                style={{\r\n                  borderLeft: \"1px solid #dddddd\",\r\n                  borderTop: \"1px solid #dddddd\",\r\n                  padding: \"8px\",\r\n                  float: \"right\",\r\n                  minWidth: \"300px\",\r\n                }}\r\n              >\r\n                <div style={{ padding: \"0px\" }}>\r\n                  <TextField\r\n                    label=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Filter the list of tools\"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n      {false && props && props.auth && props.auth.user && (\r\n        <div style={{ textAlign: \"center\" }}>\r\n          You are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\r\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\r\n          &nbsp;\r\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\r\n            https://portal.office.com/account/#apps\r\n          </a>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  function boardFileName() {\r\n    var name = props.board ? props.board : \"default\";\r\n    return `${name}.json`;\r\n  }\r\n}\r\nfunction newFunction() {\r\n  return (\r\n    <div>\r\n      <div></div>\r\n      <div></div>\r\n    </div>\r\n  );\r\n}\r\n","/* \r\nTool Catalogue\r\n\r\nCopyright (c) jumpto365, Inc\r\n\r\nAll rights reserved.\r\n\r\nMIT License\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n * \r\n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\r\n */\r\n\r\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\r\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\r\n\r\nimport { initializeIcons } from \"@uifabric/icons\";\r\nimport axios from \"axios\";\r\nimport _ from \"lodash\";\r\nimport React, { useEffect, useState, useRef } from \"react\";\r\nimport \"react-grid-layout/css/styles.css\";\r\nimport \"react-resizable/css/styles.css\";\r\nimport ReactTags from \"react-tag-autocomplete\";\r\nimport \"./App.css\";\r\nimport { AppSuperTile } from \"./components/AppSuperTile\";\r\nimport ToolboxLayout, { breakpoints } from \"./components/ToolboxLayout\";\r\nimport { ViewErrors } from \"./components/ViewErrors\";\r\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\r\nimport config from \"./config\";\r\nimport \"./css/normalize.css\";\r\nimport \"./css/swimlane-process-map.webflow.css\";\r\nimport \"./css/webflow.css\";\r\nimport { getSearchParametersFromHRef, inIframe } from \"./helpers\";\r\nimport {\r\n  BOARDSPATH,\r\n  readCache,\r\n  readLayouts,\r\n  saveCache,\r\n  writeLayouts,\r\n  readBoardFiles,\r\n  readIndexOfLaunzhBoards,\r\n} from \"./helpers/LaunchPad\";\r\nimport { teamMemberships, getOneDriveFolder,MyTeams } from \"./helpers/OfficeGraph\";\r\nimport { EVENT, trace } from \"./helpers/trace\";\r\n\r\nimport {\r\n  CommandBar,\r\n  getTheme,\r\n  Coachmark,\r\n  DirectionalHint,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n  Spinner,\r\n  Label,\r\n} from \"office-ui-fabric-react\";\r\n\r\nimport { navigate } from \"@reach/router\";\r\nimport BreakPointSelector from \"./components/BreakPointSelector\";\r\nimport {\r\n  MessageBarButton,\r\n  Link,\r\n  Stack,\r\n  StackItem,\r\n  MessageBar,\r\n  MessageBarType,\r\n  ChoiceGroup,\r\n  IStackProps,\r\n} from \"office-ui-fabric-react\";\r\nimport AddBoard from \"./components/AddBoard\";\r\n\r\nconst dragOptions = {\r\n  moveMenuItemText: \"Move\",\r\n  closeMenuItemText: \"Close\",\r\n  menu: ContextualMenu,\r\n};\r\nconst cancelIcon = { iconName: \"Cancel\" };\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n  container: {\r\n    display: \"flex\",\r\n    flexFlow: \"column nowrap\",\r\n    alignItems: \"stretch\",\r\n  },\r\n  header: [\r\n    // tslint:disable-next-line:deprecation\r\n    theme.fonts.xLargePlus,\r\n    {\r\n      flex: \"1 1 auto\",\r\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n      color: theme.palette.neutralPrimary,\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      fontWeight: FontWeights.semibold,\r\n      padding: \"12px 12px 14px 24px\",\r\n    },\r\n  ],\r\n  body: {\r\n    flex: \"4 4 auto\",\r\n    padding: \"0 24px 24px 24px\",\r\n    minWidth: \"95vw\",\r\n    minHeight: \"90vh\",\r\n    overflowY: \"hidden\",\r\n    selectors: {\r\n      p: { margin: \"14px 0\" },\r\n      \"p:first-child\": { marginTop: 0 },\r\n      \"p:last-child\": { marginBottom: 0 },\r\n    },\r\n  },\r\n});\r\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\r\nconst iconButtonStyles = {\r\n  root: {\r\n    color: theme.palette.neutralPrimary,\r\n    marginLeft: \"auto\",\r\n    marginTop: \"4px\",\r\n    marginRight: \"2px\",\r\n  },\r\n  rootHovered: {\r\n    color: theme.palette.neutralDark,\r\n  },\r\n};\r\nvar logSearchTimer;\r\nvar searchInfo;\r\n\r\ninitializeIcons();\r\n\r\nlet isOfficeInitialized = false;\r\nasync function getGraphToken(bootstrapToken) {\r\n  debugger;\r\n  return \"\";\r\n}\r\n/* Render application after Office initializes */\r\n\r\nif (window.Office){\r\n  window.Office.initialize = async () => {\r\n    isOfficeInitialized = true;\r\n\r\n  };\r\n}\r\n\r\nexport default function App(props) {\r\n  const upnIs = (upn) => {\r\n    try {\r\n      return props.auth.user.userPrincipalName === upn;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  };\r\n  const inFrame = inIframe();\r\n  const searchIconRef = useRef();\r\n  const [showTabFeature, setThowTabFeature] = useState(\r\n    config.teamsIntegration || upnIs(config.niels)\r\n  );\r\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\r\n  const [filter, _setFilter] = useState(\"\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [tiles, setTiles] = useState([]);\r\n  const [useAuthentication, setUseAuthentication] = useState(false);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isZoomed, setIsZoomed] = useState(false);\r\n  const [currentTile, setCurrentTile] = useState(null);\r\n  const [me, setMe] = useState({});\r\n  const [ztickyFolder, setZtickyFolder] = useState({});\r\n  var [myTools, setMyTools] = useState([]);\r\n  const [joinedTeams,setJoinedTeams] =  useState([]);\r\n  const [myTeams, setMyTeams] = useState([]);\r\n  const [ztickyRef, setZtickyRef] = useState(\"\");\r\n  const [tileSize, setTileSize] = useState(1);\r\n  const [errors, setErrors] = useState([]);\r\n  const [memberships, setMemberships] = useState([]);\r\n  const [contexts, setContexts] = useState([]);\r\n  const [selectedBoard, setSelectedBoard] = useState(props.board);\r\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\r\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\r\n  const [refreshing, setRefresing] = useState(false);\r\n  const [progress, setProgress] = useState(\"\");\r\n  const [progressPercent, setProgressPercent] = useState(null);\r\n  const [showTable, setShowTable] = useState(false);\r\n  const [editingLayout, setEditingLayout] = useState(true);\r\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\r\n  const [tableUrl, setTableUrl] = useState(\"\");\r\n  const [layouts, setLayouts] = useState({\r\n    lg: [\r\n      // {\r\n      //   x: 0,\r\n      //   y: Infinity,\r\n      //   w: 3,\r\n      //   h: 3,\r\n      //   i: \"1\",\r\n      //   static: 0, //Math.random() < 0.05,\r\n      // },\r\n    ],\r\n  });\r\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\r\n  const [refreshCounter, setRefreshCounter] = useState(0);\r\n  const [tags, setTags] = useState([]);\r\n  const [showDetails, _setShowDetails] = useState(true);\r\n  const [showCatalogue, _setShowCatalogue] = useState(!inIframe());\r\n  const [editMode, _setEditMode] = useState(false); //!inIframe());\r\n  const [isFixedWidth, setIsFixedWidth] = useState(true); //!inIframe());\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [tableApiSelected, setTableApiSelected] = useState(\r\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\r\n  );\r\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\r\n  const [groups, setGroups] = useState([]);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedBreakPoint, setSelectedBreakPoint] = useState(\"lg\");\r\n  const [isMounted, setIsMounted] = useState(false);\r\n  const [isDirty, setIsDirty] = useState(false);\r\n  const [showWarning, setShowWarning] = useState(true);\r\n  const [indexLaunzhContexts, setIndexLaunzhContexts] = useState([]);\r\n  const [myDrive, setMyDrive] = useState(\"\");\r\n  const [addingBoard, setAddingBoard] = useState(false);\r\n  function gotoBoard(boardName) {\r\n    setSelectedBoard(boardName);\r\n    window.location.href = `/board/${boardName}`;\r\n  }\r\n  function setEditMode(on) {\r\n    if (on) {\r\n      setIsDirty(false);\r\n    }\r\n    _setEditMode(on);\r\n  }\r\n  function setShowDetails(on) {\r\n    _setShowDetails(on);\r\n    trace(EVENT.DETAILSTOGGLED, { on });\r\n  }\r\n  function setShowCatalogue(on) {\r\n    _setShowCatalogue(on);\r\n    setIsModalOpen(true);\r\n    trace(EVENT.SEARCHCLICKED, { on });\r\n  }\r\n\r\n  function setFilter(value) {\r\n    setSearch(value);\r\n    if (_.startsWith(value, \".\")) {\r\n    } else {\r\n      _setFilter(value);\r\n    }\r\n  }\r\n\r\n  const _setTags = (t) => {\r\n    debugger;\r\n    setTags(t);\r\n  };\r\n\r\n  const removePin = (pinId) => {\r\n    var keys = _.keys(layouts);\r\n    keys.forEach((key) => {\r\n      layouts[key].splice(pinId, 1);\r\n\r\n      layouts[key] = layouts[key].map((m, ix) => {\r\n        m.i = ix.toString();\r\n        return m;\r\n      });\r\n    });\r\n\r\n    myTeams.splice(pinId, 1);\r\n\r\n    setLayouts(layouts);\r\n\r\n    setMyTeams(myTeams);\r\n    setRefreshCounter(refreshCounter + 1);\r\n  };\r\n\r\n  const getPin = (id, width, height, refresh) => {\r\n    var team = myTeams[parseInt(id)];\r\n    return (\r\n      <ViewTeam\r\n        indexLaunzhContexts={indexLaunzhContexts}\r\n        editMode={editMode}\r\n        refreshCounter={refresh}\r\n        key={id}\r\n        width={width}\r\n        height={height}\r\n        team={team}\r\n        pinId={parseInt(id)}\r\n        isPinned\r\n        onRemovePin={removePin}\r\n      />\r\n    );\r\n  };\r\n  const addChannel = (team, channel) => {\r\n    addPin(team, channel);\r\n  };\r\n  const addPin = (team, channel) => {\r\n    var _team = _.cloneDeep(team);\r\n\r\n    _team.channel = channel;\r\n    var id = myTeams.push(_team);\r\n    var keys = _.keys(layouts);\r\n    keys.forEach((key) => {\r\n      id = layouts[key].length.toString();\r\n      layouts[key].push({\r\n        team: team.id,\r\n        x: 0,\r\n        y: id * 2,\r\n        w: 2,\r\n        h: 2,\r\n\r\n        i: id,\r\n      });\r\n    });\r\n\r\n    setLayouts(layouts);\r\n    setEditMode(true);\r\n    setRefreshCounter(refreshCounter + 1);\r\n    setIsModalOpen(false);\r\n    setMyTeams(myTeams);\r\n  };\r\n  const showSearch = () => {\r\n    setShowCatalogue(!showCatalogue);\r\n    setRefreshCounter(refreshCounter + 1);\r\n  };\r\n  useEffect(() => {\r\n    async function load() {\r\n      MyTeams().then(teams =>{\r\n\r\n         \r\n        setJoinedTeams(teams)\r\n      })\r\n      if (selectedBoard) {\r\n        window.document.title = \"LAUNZH - \" + selectedBoard;\r\n      }\r\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\r\n\r\n      if (showTabFeature) initGraph(false);\r\n\r\n      var search = getSearchParametersFromHRef(window.location.href);\r\n      if (search.ztickyref) {\r\n        setZtickyRef(search.ztickyref);\r\n      }\r\n      var href = search.src ? search.src : config.defaultTableAPI;\r\n      setIndexLaunzhContexts(await readIndexOfLaunzhBoards().catch(() => {})); // might not be one\r\n      readBoardFiles()\r\n        .then((files) => {\r\n          var ctxs = [];\r\n          files.forEach((file) => {\r\n            if (_.endsWith(file.name.toLowerCase(), \".json\")) {\r\n              var key = file.name.split(\".\")[0];\r\n              ctxs.push({ key: key, text: key });\r\n            }\r\n          });\r\n          setContexts(ctxs);\r\n        })\r\n        .catch((error) => {\r\n          //errors.push({ context: \"readContexts\", error });\r\n          //setErrors(errors);\r\n          //setIsMounted(true);\r\n        });\r\n      if (!isLoaded) {\r\n        setIsLoaded(true);\r\n        var l = await readLayouts(BOARDSPATH, boardFileName()).catch((e) => {});\r\n        if (l) {\r\n          setMyTeams(l.myTeams);\r\n          setLayouts(l.layouts);\r\n          setRefreshCounter(refreshCounter + 1);\r\n        }\r\n        setIsMounted(true);\r\n      }\r\n\r\n      setTableUrl(config.defaultTableAPI);\r\n      readGrid(href, config.defaultTableKey);\r\n\r\n      if (!myDrive) {\r\n        var drive = await getOneDriveFolder(BOARDSPATH).catch(() => {});\r\n        if (drive) {\r\n          setMyDrive(drive.webUrl);\r\n        }\r\n      }\r\n    }\r\n\r\n    load();\r\n  }, [refreshCounter, selectedBoard]);\r\n\r\n  function readGrid(href, tableId) {\r\n    axios.get(href).then(({ data }) => {\r\n      setTitlegraphics(data.titlegraphics);\r\n      var tiles = [];\r\n      if (data.grid) {\r\n        var groups = {};\r\n        var groupRefs = {};\r\n        data.grid.forEach((row) => {\r\n          return row.forEach((cell) => {\r\n            if (cell.groupSetting) {\r\n              groups[cell.groupSetting.title] = {\r\n                groupSetting: cell.groupSetting,\r\n                members: cell.members,\r\n              };\r\n              if (cell.members) {\r\n                cell.members.forEach((id) => {\r\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\r\n                  refs.push(cell.groupSetting);\r\n                  groupRefs[id] = refs;\r\n                });\r\n              }\r\n            }\r\n          });\r\n        });\r\n\r\n        var g = _.keys(groups);\r\n        var ga = g.map((name) => {\r\n          return { title: name, ...groups[name] };\r\n        });\r\n\r\n        setGroups(_.sortBy(ga, [\"title\"]));\r\n\r\n        data.grid.forEach((row) => {\r\n          return row.forEach((cell) => {\r\n            if (cell.tile && cell.tile.title) {\r\n              var tile = { ...cell.tile };\r\n              tile.sortKey = _.toLower(cell.tile.title);\r\n              tile.tableId = tableId;\r\n              tile.correlation =\r\n                href +\r\n                \"#\" +\r\n                (tile.key\r\n                  ? tile.key\r\n                  : tile.title\r\n                  ? tile.title.toLowerCase()\r\n                  : tile.id);\r\n              var references = groupRefs[cell.id];\r\n              tile.references = references;\r\n              tiles.push(tile);\r\n            }\r\n          });\r\n        });\r\n      }\r\n\r\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\r\n    });\r\n  }\r\n\r\n  async function initGraph(refresh) {\r\n    try {\r\n      if (refresh) {\r\n      }\r\n      var queueCount = 0;\r\n\r\n      // await OfficeGraph.initStorage();\r\n\r\n      var localCache = localStorage.getItem(\"memberships\");\r\n      var cachedMemberships;\r\n      try {\r\n        if (localCache && !refresh) {\r\n          cachedMemberships = JSON.parse(localCache);\r\n          setMemberships(cachedMemberships);\r\n\r\n          return;\r\n        }\r\n      } catch (error) {}\r\n\r\n      setRefresing(true);\r\n      cachedMemberships = await readCache().catch((error) => {\r\n        errors.push({ context: \"readCache\", error });\r\n        setErrors(errors);\r\n      });\r\n\r\n      if (cachedMemberships && !refresh) {\r\n        setMemberships(cachedMemberships);\r\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\r\n        setRefresing(false);\r\n      } else {\r\n        queueCount++;\r\n        setProgress(\"Loading\");\r\n        teamMemberships((percent) => {\r\n          setProgressPercent(percent);\r\n        })\r\n          .then(async (memberships) => {\r\n            await saveCache(memberships).catch((error) => {\r\n              errors.push({ context: \"saveCache\", error });\r\n              setErrors(errors);\r\n            });\r\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\r\n            queueCount--;\r\n            if (queueCount === 0) setRefresing(false);\r\n            trace(EVENT.MEMBERSHIPSREAD, {\r\n              \"count-memberships\": memberships.length,\r\n            });\r\n            setMemberships(memberships);\r\n\r\n            setProgress(\"\");\r\n          })\r\n          .catch((error) => {\r\n            debugger;\r\n            queueCount--;\r\n            if (queueCount <= 0) setRefresing(false);\r\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\r\n            setErrors(errors);\r\n            setProgress(\"\");\r\n          });\r\n      }\r\n      return;\r\n      // OfficeGraph.initTileStorage()\r\n      //   .then(async (ztickyFolder) => {\r\n      //     setZtickyFolder(ztickyFolder);\r\n      //     queueCount++;\r\n\r\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\r\n      //       ztickyFolder\r\n      //     );\r\n      //     //debugger\r\n      //     var myTools = [];\r\n      //     if (version < 0) {\r\n      //       var tileFolders = await OfficeGraph.getMyTools(\r\n      //         ztickyFolder,\r\n      //         refresh\r\n      //       );\r\n      //       myTools = tileFolders.map((folder) => {\r\n      //         return {\r\n      //           title: folder.tile ? folder.tile.title : folder.name,\r\n      //           tile: folder.tile,\r\n      //         };\r\n      //       });\r\n      //     } else {\r\n      //       myTools = properties.tiles.map((tile) => {\r\n      //         if (!tile) return null;\r\n\r\n      //         return { title: tile.title, tile };\r\n      //       });\r\n      //     }\r\n\r\n      //     queueCount--;\r\n      //     if (queueCount === 0) setRefresing(false);\r\n      //     setMyTools(myTools);\r\n      //     setLayouts(layouts);\r\n      //   })\r\n      //   .catch((error) => {\r\n      //     queueCount--;\r\n      //     if (queueCount <= 0) setRefresing(false);\r\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\r\n      //     setErrors(errors);\r\n      //   });\r\n    } catch (error) {\r\n      errors.push({ context: \"initGraph\", error });\r\n      setErrors(errors);\r\n    }\r\n  }\r\n\r\n  function matchFilter(tile) {\r\n    if (!filter) return true;\r\n    var match =\r\n      tile &&\r\n      tile.title &&\r\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        tile &&\r\n        tile.inShort &&\r\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        tile &&\r\n        tile.subTitle &&\r\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n\r\n    return match;\r\n  }\r\n\r\n  function matchTeam(team) {\r\n    var include = true;\r\n    if (tags.length > 0) {\r\n      include = false;\r\n      tags.forEach((tag) => {\r\n        switch (tag.id) {\r\n          case \"sharepoint\":\r\n            if (team.hasSharePoint) {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"teams\":\r\n            if (team.hasTeams) {\r\n              include = true;\r\n            }\r\n\r\n            break;\r\n          case \"yammer\":\r\n            if (team.hasYammer) {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"private\":\r\n            if (team.visibility === \"Private\") {\r\n              include = true;\r\n            }\r\n            break;\r\n          case \"public\":\r\n            if (team.visibility === \"Public\") {\r\n              include = true;\r\n            }\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      });\r\n    }\r\n    if (!include) return false;\r\n    if (!filter) return true;\r\n    var details = team.data && team.data.details ? team.data.details : {};\r\n    var channels = team.data && team.data.channels ? team.data.channels : [];\r\n    var match =\r\n      details.displayName &&\r\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    if (!match)\r\n      match =\r\n        details.description &&\r\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n    channels.forEach((channel) => {\r\n      if (!match) {\r\n        match =\r\n          channel.displayName &&\r\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\r\n            -1;\r\n      }\r\n      if (!match) {\r\n        match =\r\n          channel.description &&\r\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\r\n            -1;\r\n      }\r\n    });\r\n\r\n    return match;\r\n  }\r\n  function persistLayouts(newLayouts) {\r\n    if (!isMounted) {\r\n      console.log(\"not mounted, persistLayouts dropped\");\r\n      return;\r\n    }\r\n    setLayouts(newLayouts);\r\n    setIsDirty(true);\r\n  }\r\n  async function saveLayout() {\r\n    if (!isMounted) {\r\n      console.log(\"not mounted, persistLayouts dropped\");\r\n      return;\r\n    }\r\n\r\n    console.log(\"persistLayouts\");\r\n\r\n    await writeLayouts(BOARDSPATH, boardFileName(), {\r\n      layouts,\r\n      myTeams,\r\n    }).catch((error) => {\r\n      errors.push({ context: \"  writeLayouts\", error });\r\n      setErrors(errors);\r\n    });\r\n\r\n    setIsDirty(false);\r\n  }\r\n\r\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\r\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\r\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\r\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\r\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\r\n  if (filter || tags.length > 0) {\r\n    tiles.forEach((tile) => {\r\n      if (matchFilter(tile)) {\r\n        filteredTiles.push(tile);\r\n      }\r\n    });\r\n    myTools.forEach((folder) => {\r\n      if (matchFilter(folder.tile)) {\r\n        filteredMyTools.push(folder);\r\n      }\r\n    });\r\n\r\n    memberships.forEach((team) => {\r\n      if (matchTeam(team)) {\r\n        filteredMemberShips.push(team);\r\n      }\r\n    });\r\n\r\n    // if (\r\n    //   searchInfo &&\r\n    //   searchInfo[\"search-for\"] &&\r\n    //   searchInfo[\"search-for\"] === filter\r\n    // )\r\n    //   return;\r\n\r\n    // searchInfo = {\r\n    //   \"search-for\": filter,\r\n    //   \"found-memberships\": filteredMemberShips.length,\r\n    //   \"found-tiles\": filteredMyTools.length,\r\n    // };\r\n\r\n    if (logSearchTimer) {\r\n      console.log(\"Postponing search trace\");\r\n      clearTimeout(logSearchTimer);\r\n    }\r\n    console.log(\"Timeing search trace\");\r\n    logSearchTimer = setTimeout(() => {\r\n      console.log(\"sending search trace\");\r\n      trace(EVENT.SEARCHING, searchInfo);\r\n      logSearchTimer = null;\r\n    }, 1000);\r\n  }\r\n\r\n  const dropdownStyles = {\r\n    dropdown: { flexGrow: 1, border: \"1px\" },\r\n  };\r\n\r\n  if (!(props && props.auth)) {\r\n    return null;\r\n    // (\r\n    //   <div>\r\n    //     <h1>Sorry - You cannot get in here</h1>\r\n    //     {JSON.stringify(\r\n    //       props && props.auth && props.auth.error ? props.auth.error : \"\"\r\n    //     )}\r\n    //   </div>\r\n    // );\r\n  }\r\n  var editorCanvasWidth = editMode ? breakpoints[selectedBreakPoint] : null;\r\n  const buttonProps = {\r\n    text: \"Try it\",\r\n  };\r\n\r\n  const buttonProps2 = {\r\n    text: \"Try it again\",\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {!inFrame && config.components.header}\r\n      {/* <CommandBar\r\n        // items={_items}\r\n        // overflowItems={_overflowItems}\r\n        // overflowButtonProps={overflowProps}\r\n        farItems={[\r\n          // {\r\n          //   key: \"tile\",\r\n          //   text: \"Grid view\",\r\n          //   // This needs an ariaLabel since it's icon-only\r\n          //   ariaLabel: \"Filter view\",\r\n          //   iconOnly: true,\r\n          //   iconProps: { iconName: \"Filter\" },\r\n          //   onClick: () => {\r\n          //     if (showFilterOptions) {\r\n          //       setFilter(\"\");\r\n          //     }\r\n          //     setShowFilterOptions(!showFilterOptions);\r\n          //   }\r\n          // }\r\n        ]}\r\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\r\n      /> */}\r\n      <div>\r\n        {\" \"}\r\n        {errors.length !== 0 && (\r\n          <div>\r\n            <ViewErrors errors={errors} />\r\n          </div>\r\n        )}\r\n        {progress && (\r\n          <div\r\n            style={{\r\n              backgroundColor: \"white\",\r\n              width: \"100vw\",\r\n              position: \"fixed\",\r\n              top: \"0px\",\r\n              zIndex: 2,\r\n            }}\r\n          >\r\n            <ProgressIndicator\r\n              percentComplete={progressPercent}\r\n              xlabel=\"Example title\"\r\n              xdescription={progress}\r\n            />\r\n          </div>\r\n        )}\r\n        <img\r\n          style={{\r\n            display: \"none\",\r\n            height: \"64px\",\r\n            margin: \"13px\",\r\n            position: \"fixed\",\r\n            bottom: \"0px\",\r\n            right: \"0px\",\r\n          }}\r\n          src={titlegraphics}\r\n        ></img>\r\n\r\n        <div class=\"Karlo\" >\r\n        \r\n                {joinedTeams.map(team=>{\r\n                  return (\r\n                  <div class=\"KarlosTeam\">\r\n                  {team.displayName}\r\n                  </div>\r\n\r\n                  )\r\n                  \r\n                })\r\n\r\n\r\n                }\r\n        \r\n        </div>\r\n        {!isZoomed && (\r\n          <div style={{ display: \"flex\" }}>\r\n            {\" \"}\r\n            <div\r\n              style={{\r\n                display: \"xnone\",\r\n                paddingRight: \"8px\",\r\n                position: \"fixed\",\r\n                bottom: \"0px\",\r\n                backgroundColor: \"white\",\r\n              }}\r\n            >\r\n              {showTabFeature && (\r\n                <div>\r\n                  <i\r\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                    className=\"ms-Icon ms-Icon--Refresh\"\r\n                    onClick={() => {\r\n                      initGraph(true);\r\n                    }}\r\n                    aria-hidden=\"true\"\r\n                  ></i>{\" \"}\r\n                  {refreshing && <>Loading</>}\r\n                </div>\r\n              )}\r\n            </div>\r\n            {!inFrame && (\r\n              <div\r\n                style={{\r\n                  position: \"fixed\",\r\n                  right: 0,\r\n                  top: 0,\r\n                  zIndex: 32,\r\n                  marginRight: \"16px\",\r\n                  width: \"calc(100vw - 200px)\",\r\n                }}\r\n              >\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div\r\n                    style={{\r\n                      marginLeft: \"16px\",\r\n                      marginTop: \"10px\",\r\n                      flexGrow: 1,\r\n                    }}\r\n                  >\r\n                    {\" \"}\r\n                    {!editMode && (\r\n                      <div style={{ display: \"flex\" }}>\r\n                        <div\r\n                          style={{\r\n                            flexGrow: 1,\r\n                          }}\r\n                        >\r\n                          <Dropdown\r\n                            hidden\r\n                            disabled={showTable}\r\n                            placeholder=\"Select board\"\r\n                            selectedKey={selectedBoard}\r\n                            xlabel=\"View as\"\r\n                            onChanged={(option, index) => {\r\n                              gotoBoard(option.key);\r\n\r\n                              //debugger\r\n                            }}\r\n                            options={contexts.map((ctx) => {\r\n                              return { key: ctx.key, text: ctx.text };\r\n                            })}\r\n                            styles={dropdownStyles}\r\n                          />\r\n                        </div>\r\n                        <div\r\n                          style={{\r\n                            marginLeft: \"16px\",\r\n                            xmarginTop: \"4px\",\r\n                          }}\r\n                        >\r\n                          <IconButton\r\n                            styles={{ fontSize: \"24px\" }}\r\n                            iconProps={{ iconName: \"Add\" }}\r\n                            ariaLabel=\"Add\"\r\n                            onClick={() => setAddingBoard(true)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {addingBoard && (\r\n                    <AddBoard\r\n                      onDismiss={() => {\r\n                        setAddingBoard(false);\r\n                      }}\r\n                      onAdd={(name) => {\r\n                        gotoBoard(name);\r\n                        setAddingBoard(false);\r\n                      }}\r\n                    />\r\n                  )}\r\n                  {editMode && (\r\n                    <>\r\n                      <div style={{ marginTop: \"16px\", marginRight: \"8px\" }}>\r\n                        Screen width&nbsp;\r\n                      </div>\r\n                      <div>\r\n                        <BreakPointSelector\r\n                          selected={selectedBreakPoint}\r\n                          breakpoints={breakpoints}\r\n                          onSelect={(breakPoint) => {\r\n                            setSelectedBreakPoint(breakPoint);\r\n                          }}\r\n                        />\r\n                      </div>\r\n\r\n                      <div style={{ marginTop: \"8px\" }}>\r\n                        <IconButton\r\n                          styles={{ fontSize: \"24px\" }}\r\n                          disabled={!isDirty}\r\n                          iconProps={{ iconName: \"Save\" }}\r\n                          ariaLabel=\"Save\"\r\n                          onClick={() => saveLayout()}\r\n                        />\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                  {false && <>\r\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Edit</div>\r\n                            \r\n                            \r\n                  <div style={{ marginTop: \"16px\" }}>\r\n                    <Toggle\r\n                      checked={editMode}\r\n                      onChange={(e, checked) => {\r\n                        setEditMode(checked);\r\n                        setRefreshCounter(refreshCounter + 1);\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  </>}\r\n                  <div style={{ marginTop: \"4px\" }}>\r\n                    <CommandBar\r\n                      farItems={[\r\n                        // {\r\n                        //   key: \"tile\",\r\n                        //   text: \"Grid view\",\r\n                        //   // This needs an ariaLabel since it's icon-only\r\n                        //   ariaLabel: \"Grid view\",\r\n                        //   iconOnly: true,\r\n                        //   iconProps: { iconName: \"Tiles\" },\r\n                        //   onClick: () => console.log(\"Tiles\"),\r\n                        // },\r\n                        {\r\n                          key: \"info\",\r\n                          text: \"Info\",\r\n                          // This needs an ariaLabel since it's icon-only\r\n                          ariaLabel: \"Info\",\r\n                          iconOnly: true,\r\n                          iconProps: { iconName: \"CollapseMenu\" },\r\n                          onClick: () => console.log(\"Info\"),\r\n                          subMenuProps: {\r\n                            items: [\r\n                              // {\r\n                              //   key: \"allBoards\",\r\n                              //   text: \"Boards\",\r\n                              //   iconProps: { iconName: \"AllApps\" },\r\n                              //   onClick: () => {\r\n                              //     navigate(\"/boards\");\r\n                              //   }, // optional\r\n                              // },\r\n                              {\r\n                                key: \"check\",\r\n                                text: \"Check\",\r\n                                iconProps: { iconName: \"ReceiptCheck\" },\r\n                                onClick: () => {\r\n                                  navigate(\"/check\");\r\n                                }, // optional\r\n                              },\r\n                              // {\r\n                              //   key: \"onedrive\",\r\n                              //   text: \"OneDrive files\",\r\n                              //   disabled: !myDrive,\r\n                              //   iconProps: { iconName: \"OneDriveLogo\" },\r\n                              //   onClick: () => {\r\n                              //     window.open(myDrive);\r\n                              //   }, // optional\r\n                              // },\r\n\r\n                              {\r\n                                key: \"signout\",\r\n                                text: \"Sign Out\",\r\n                                iconProps: { iconName: \"SignOut\" },\r\n                                onClick: () => {\r\n                                  if (props.signOut) {\r\n                                    props.signOut();\r\n                                  }\r\n                                }, // optional\r\n                              },\r\n                              {\r\n                                key: \"debug\",\r\n                                text: \"Debug\",\r\n                                iconProps: { iconName: \"SearchAndApps\" },\r\n                                onClick: () => {\r\n                                  navigate(\"/debug\");\r\n                                }, // optional\r\n                              },\r\n                            ],\r\n                          },\r\n                        },\r\n                      ]}\r\n                      ariaLabel=\"Use left and right arrow keys to navigate between commands\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* <div style={{ marginTop: \"16px\" }}>\r\n                    <Toggle\r\n                      checked={showCatalogue}\r\n                      onChange={(e, checked) => {\r\n                        setShowCatalogue(checked);\r\n                        setRefreshCounter(refreshCounter + 1);\r\n                      }}\r\n                    />\r\n                  </div> */}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div style={{ flexGrow: \"1\" }}>\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  flexWrap: \"wrap\",\r\n                  marginTop: \"8px\",\r\n                }}\r\n              >\r\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\r\n                  {/* <TextField\r\n                    autoFocus={true}\r\n                    disabled={showTable}\r\n                    xlabel=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Start typing any characters to filter \"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  /> */}\r\n\r\n                  {/* */}\r\n                </div>{\" \"}\r\n              </div>\r\n              <div\r\n                style={{\r\n                  position: \"fixed\",\r\n                  right: 0,\r\n                  bottom: 0,\r\n                  zIndex: 32,\r\n                }}\r\n              >\r\n\r\n              {false &&\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\r\n                    <i\r\n                      ref={searchIconRef}\r\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                      className=\"ms-Icon ms-Icon--Add tilesearch\"\r\n                      onClick={() => {\r\n                        showSearch();\r\n                      }}\r\n                      aria-hidden=\"true\"\r\n                    ></i>\r\n                  </div>\r\n                </div>}\r\n              </div>\r\n              <div style={isFixedWidth ? { backgroundColor: \"#666666\" } : {}}>\r\n                <div\r\n                  style={\r\n                    editMode\r\n                      ? {\r\n                          marginRight: \"auto\",\r\n                          marginLeft: \"auto\",\r\n                          width: editorCanvasWidth,\r\n                          minHeight: \"100vh\",\r\n                          backgroundColor: \"#ffffff\",\r\n                        }\r\n                      : isFixedWidth\r\n                      ? {\r\n                          marginRight: \"auto\",\r\n                          marginLeft: \"auto\",\r\n                          maxWidth: 1200,\r\n                          minHeight: \"100vh\",\r\n                          backgroundColor: \"#ffffff\",\r\n                        }\r\n                      : {}\r\n                  }\r\n                >\r\n                  {!isMounted && (\r\n                    <div style={{ height: \"90vh\", marginTop: \"40vh\" }}>\r\n                      <Spinner label=\"Assembling your board ...\" />\r\n                    </div>\r\n                  )}\r\n                  {isMounted && joinedTeams.length === 0 && showWarning && (\r\n                    <MessageBar\r\n                      messageBarType={MessageBarType.warning}\r\n                      isMultiline={false}\r\n                      onDismiss={() => {\r\n                        setShowWarning(false);\r\n                      }}\r\n                      dismissButtonAriaLabel=\"Close\"\r\n                      actions={\r\n                        <div>\r\n                          <MessageBarButton\r\n                            onClick={() => {\r\n                              setEditMode(true);\r\n                              setShowWarning(false);\r\n                              showSearch();\r\n                            }}\r\n                          >\r\n                            {\" \"}\r\n                            Add Tiles\r\n                          </MessageBarButton>\r\n                        </div>\r\n                      }\r\n                    >\r\n                      Hi, nothing on this board\r\n                    </MessageBar>\r\n                  )}\r\n\r\n                  <Coachmark\r\n                    target={searchIconRef}\r\n                    positioningContainerProps={{\r\n                      directionalHint: DirectionalHint.topAutoEdge,\r\n                      doNotLayer: false,\r\n                    }}\r\n                    ariaAlertText=\"A Coachmark has appeared\"\r\n                    ariaDescribedBy={\"coachmark-desc1\"}\r\n                    ariaLabelledBy={\"coachmark-label1\"}\r\n                    ariaDescribedByText={\r\n                      \"Press enter or alt + C to open the Coachmark notification\"\r\n                    }\r\n                    ariaLabelledByText={\"Coachmark notification\"}\r\n                  >\r\n                    Welcome to the land of Coachmarks!\r\n                  </Coachmark>\r\n                  <ToolboxLayout\r\n                    indexLaunzhContexts={indexLaunzhContexts}\r\n                    tools={myTools}\r\n                    layouts={layouts}\r\n                    persist={persistLayouts}\r\n                    editMode={editMode}\r\n                    getPin={getPin}\r\n                    onRemovePin={removePin}\r\n                    fixedWidth={editorCanvasWidth}\r\n                    onTileClick={(tile) => {\r\n                      setCurrentTile(tile);\r\n                      setIsZoomed(true);\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* {siteUrl && (\r\n                 \r\n                    <h3>Which tools do you find good for this site?</h3>\r\n                    <div>{siteUrl.hostname}</div>\r\n                    <TextField\r\n                      label=\"Label\"\r\n                      placeholder=\"Enter label for this link\"\r\n                      value={siteUrlLabel}\r\n                      onChange={(e, value) => {\r\n                        setSiteUrlLabel(value);\r\n                      }}\r\n                    ></TextField>\r\n                    <TextField\r\n                      label=\"URL\"\r\n                      placeholder=\"Enter URL\"\r\n                      value={siteUrlHref}\r\n                      onChange={(e, value) => {\r\n                        setSiteUrlHref(value);\r\n                      }}\r\n                    ></TextField>\r\n                    <PrimaryButton\r\n                      text=\"Share link\"\r\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\r\n                    />\r\n                  </PivotItem>\r\n                )} */}\r\n              {/* <PivotItem\r\n                  key=\"catalogue\"\r\n                  headerText=\"Catalogue\"\r\n                  itemCount={filteredTiles.length}\r\n                > */}\r\n              {showTable && (\r\n                <>\r\n                  <div style={{ textAlign: \"right\" }}>\r\n                    <i\r\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\r\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\r\n                      onClick={() => {\r\n                        window.open(tableUrl, \"_blank\");\r\n                      }}\r\n                      aria-hidden=\"true\"\r\n                    ></i>\r\n                  </div>\r\n                  <iframe\r\n                    style={{\r\n                      border: \"0\",\r\n                      height: \"calc(100vh - 150px\",\r\n                      width: \"95vw\",\r\n                    }}\r\n                    src={tableUrl}\r\n                  ></iframe>\r\n                </>\r\n              )}\r\n              {/* {showCatalogue && showTabFeature && memberships.length > 0 && ( */}\r\n              <Modal\r\n                titleAriaId={1}\r\n                isOpen={isModalOpen}\r\n                onDismiss={() => setIsModalOpen(false)}\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n                xdragOptions={dragOptions}\r\n              >\r\n                <div style={{ display: \"flex\" }}>\r\n                  <div style={{ flexGrow: 1 }}></div>\r\n                  <div>\r\n                    <IconButton\r\n                      styles={iconButtonStyles}\r\n                      iconProps={cancelIcon}\r\n                      ariaLabel=\"Close popup modal\"\r\n                      onClick={() => setIsModalOpen(false)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className={contentStyles.body}>\r\n                  <TextField\r\n                    autoFocus={false}\r\n                    disabled={showTable}\r\n                    xlabel=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match \"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  />\r\n                  <div style={{ display: \"flex\" }}>\r\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\r\n                      Show details\r\n                    </div>\r\n                    <div style={{ marginTop: \"16px\" }}>\r\n                      <Toggle\r\n                        checked={showDetails}\r\n                        onChange={(e, checked) => {\r\n                          setShowDetails(checked);\r\n                          setRefreshCounter(refreshCounter + 1);\r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      {/* <ReactTags\r\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\r\n                    autofocus={false}\r\n                    tags={tags}\r\n                    suggestions={[\r\n                      {\r\n                        name: \"Teams\",\r\n                        id: \"teams\",\r\n                      },\r\n                      {\r\n                        name: \"SharePoint\",\r\n                        id: \"sharepoint\",\r\n                      },\r\n                      {\r\n                        name: \"Yammer\",\r\n                        id: \"yammer\",\r\n                      },\r\n                      {\r\n                        name: \"Private\",\r\n                        id: \"private\",\r\n                      },\r\n                      {\r\n                        name: \"Public\",\r\n                        id: \"public\",\r\n                      },\r\n                    ]}\r\n                    handleDelete={(i) => {\r\n                      const tgs = tags.slice(0);\r\n                      tgs.splice(i, 1);\r\n                      setTags(tgs);\r\n                      setRefreshCounter(refreshCounter + 1);\r\n                    }}\r\n                    handleAddition={(tag) => {\r\n                      var tgs = [].concat(tags, tag);\r\n                      setTags(tgs);\r\n                      setRefreshCounter(refreshCounter + 1);\r\n                    }}\r\n                  />  */}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <ViewTeams\r\n                    onSaveTeam={addPin}\r\n                    onSaveChannel={addChannel}\r\n                    refreshCounter={refreshCounter}\r\n                    tiles={filteredTiles}\r\n                    details={showDetails}\r\n                    memberShips={filteredMemberShips}\r\n                    filter={filter}\r\n                    highlightStyle={{ backgroundColor: \"yellow\" }}\r\n                  />\r\n                </div>\r\n              </Modal>\r\n              {/* )} */}\r\n          \r\n\r\n              {/* \r\n\r\n              */}\r\n            </div>\r\n            {showFilterOptions && (\r\n              <div\r\n                style={{\r\n                  borderLeft: \"1px solid #dddddd\",\r\n                  borderTop: \"1px solid #dddddd\",\r\n                  padding: \"8px\",\r\n                  float: \"right\",\r\n                  minWidth: \"300px\",\r\n                }}\r\n              >\r\n                <div style={{ padding: \"0px\" }}>\r\n                  <TextField\r\n                    label=\"Filter\"\r\n                    value={search}\r\n                    onChange={(e, newValue) => {\r\n                      setFilter(newValue);\r\n                    }}\r\n                    placeholder=\"Filter the list of tools\"\r\n                    iconProps={{ iconName: \"Filter\" }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n      {false && props && props.auth && props.auth.user && (\r\n        <div style={{ textAlign: \"center\" }}>\r\n          You are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\r\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\r\n          &nbsp;\r\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\r\n            https://portal.office.com/account/#apps\r\n          </a>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  function boardFileName() {\r\n    var name = props.board ? props.board : \"default\";\r\n    return `${name}.json`;\r\n  }\r\n}\r\n","/* \r\nTool Catalogue\r\n\r\nCopyright (c) jumpto365, Inc\r\n\r\nAll rights reserved.\r\n\r\nMIT License\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n * \r\n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\r\n */\r\nimport React, { Component, useState, useEffect } from \"react\";\r\nimport { getSearchParametersFromHRef } from \"./helpers\";\r\nimport \"./App.css\";\r\nimport \"./css/normalize.css\";\r\nimport \"./css/webflow.css\";\r\nimport \"./css/swimlane-process-map.webflow.css\";\r\nimport axios from \"axios\";\r\nimport _ from \"lodash\";\r\n\r\n\r\n\r\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\r\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\r\n\r\nimport config from \"./config\";\r\nimport ReactTags from \"react-tag-autocomplete\";\r\nimport { EVENT, who, trace } from \"./helpers/trace\";\r\nimport { running } from \"animejs\";\r\n\r\nimport {verifyAccessForLanuchPad} from \"./helpers/LaunchPad\"\r\nfunction inIframe() {\r\n  try {\r\n    return window.self !== window.top;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\nexport default function Onboard(props) {\r\n  const [checkMe, setCheckMe] = useState(\"pending\");\r\n  const [checkMemberships, setCheckMemberships] = useState(\"pending\");\r\n  const [checkTeam, setCheckTeam] = useState(\"pending\");\r\n  const [checkMyExtention, setCheckMyExtention] = useState(\"pending\");\r\n  const [checkOneDrive, setCheckOneDrive] = useState(\"pending\");\r\n  const [checkOneDriveFiles, setCheckOneDriveFiles] = useState(\"pending\");\r\n  \r\n\r\n  const upnIs = (upn) => {\r\n    try {\r\n      return props.auth.user.userPrincipalName === upn;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const inFrame = inIframe();\r\n\r\n  useEffect(() => {\r\n    async function run() {\r\n      await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\r\n    }\r\n    run();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"OnboardingContainer\" dir=\"ltr\">\r\n        {!inFrame && config.components.header}\r\n        \r\n        {/* <div className=\"ms-fontSize-32\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\r\n          Checking is everything have been setup for you\r\n        </div> */}\r\n       \r\n        {/* <div>\r\n          <div className=\"ms-fontSize-20\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\r\n          <p >jumpto365 are committed to leave your data within your own system, what is yours stay with you. \r\n          We do not copy any of your information what so ever, period!</p>\r\n\r\n           <p>But to make our app work for you, we need your organisation to trust us with the following areas</p>\r\n\r\n          \r\n          </div>\r\n          <p className=\"ms-fontSize-20\">Allow access to the following areas</p>\r\n          <ul>\r\n            <li>\r\n              <p className=\"ms-fontWeight-bold\">Read and write access to your profile and OneDrive (User.ReadWrite.All)</p>\r\n              <p>\r\n                We need this permission to be able to store your preferences as\r\n                well as your cached data on your profile, and access to store data into your OneDrive.\r\n              </p>\r\n              <p>\r\n                That in order to be able to give you the best performance and to\r\n                comply with good data pricavy.\r\n              </p>\r\n            </li>\r\n            <li>\r\n              <p className=\"ms-fontWeight-bold\">Read access to your Groups (Group.Read.All)</p>\r\n              <p>\r\n                We need this permission to be able to read details about your\r\n                group membership and the name, description and tab on your channels in Teams \r\n              </p>\r\n            </li>\r\n          </ul>\r\n        </div> */}\r\n        <div>\r\n          <p className=\"ms-fontSize-20\">Verifying access</p>\r\n          <ul>\r\n            <li>Checking access to your profile: ({checkMe})</li>\r\n            <li>Checking access to your extension: ({checkMyExtention})</li>\r\n            <li>Checking access to your memberships: ({checkMemberships})</li>\r\n            <li>Checking access to your teams: ({checkTeam})</li>\r\n            <li>\r\n              Checking access to your OneDriver folders: ({checkOneDrive})\r\n            </li>\r\n            <li>\r\n              Checking access to the OneDrive files which we maintain: ({checkOneDriveFiles})\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","/****\r\n *\r\n *\r\n *  version\r\n *  1.0\r\n *\r\n *\r\n *\r\n */\r\nimport Axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport config from \"./config\";\r\nconst storageProvider = localStorage\r\nexport function getSearchParametersFromHRef(href) {\r\n  if (!href) return {};\r\n  var search = {};\r\n  var s1 = href.split(\"?\");\r\n  if (s1.length > 1) {\r\n    var s2 = s1[1].split(\"&\");\r\n    for (let index = 0; index < s2.length; index++) {\r\n      const s3 = s2[index].split(\"=\");\r\n      search[s3[0]] = decodeURIComponent(s3[1]);\r\n    }\r\n  }\r\n  return search;\r\n}\r\n\r\nexport function getSearchParametersFromHash(href) {\r\n  if (!href) return {};\r\n  var search = {};\r\n  var s1 = href.split(\"#\");\r\n  if (s1.length > 1) {\r\n    var s2 = s1[1].split(\"&\");\r\n    for (let index = 0; index < s2.length; index++) {\r\n      const s3 = s2[index].split(\"=\");\r\n      search[s3[0]] = decodeURIComponent(s3[1]);\r\n    }\r\n  }\r\n  return search;\r\n}\r\n\r\nconst GETACCESSTOKEN = \"getAccessToken\";\r\nconst RESTOREURL = \"restoreUrl\";\r\nconst GETGRAPHUSER = \"getGraphUser\";\r\nconst LOGIN = \"login\";\r\nconst ACCESSTOKEN = \"access_token\";\r\nconst ACCESSEXPIRES = \"access_expires\";\r\n\r\nfunction isAccessTokenExpired() {\r\n  try {\r\n    var exp = storageProvider.getItem(ACCESSEXPIRES);\r\n    var expiresIn = moment(exp);\r\n    var now = moment();\r\n    var x = now.diff(expiresIn);\r\n    return x > 0 ? true : false;\r\n  } catch (error) {\r\n    return true;\r\n  }\r\n}\r\n\r\nfunction getReturnPath(subPath) {\r\n  return (\r\n    (window.location.hostname === \"localhost\"\r\n      ? window.location.protocol\r\n      : \"https:\") +\r\n    \"//\" +\r\n    window.location.hostname +\r\n    (window.location.port !== 80 &&\r\n    window.location.port !== 443 &&\r\n    window.location.port !== \"\"\r\n      ? \":\" + window.location.port\r\n      : \"\") +\r\n    \"/\" +\r\n    subPath\r\n  );\r\n}\r\n\r\n/**\r\n * http://localhost:3001/?admin_consent=True&tenant=df96b8c9-51a1-40cf-b8b1-4514be8e9668&state=12345&scope=User.ReadWrite+Files.ReadWrite.All\r\n */\r\nexport function getAdminConsent() {\r\n  var redirect_uri = getReturnPath(\"\");\r\n\r\n  var org = \"organizations\";\r\n\r\n  var host = `https://login.microsoftonline.com/${org}/v2.0/adminconsent?client_id=${config.clientId}&state=12345&redirect_uri=${redirect_uri}&scope=${config.scopes}`;\r\n\r\n  window.location.href = host;\r\n}\r\n\r\nexport function selectAccount() {\r\n  var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\r\n  var client_id = config.clientId;\r\n  var response_type = \"id_token\";\r\n  var response_mode = \"fragment\";\r\n  var scope = config.scopes;\r\n\r\n  var redirect_uri = getReturnPath(\"\");\r\n\r\n  var url = `${host}?client_id=${client_id}&prompt=select_account&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\r\n\r\n  window.location.href = url;\r\n}\r\n\r\nexport function signOut() {\r\n  var redirect_uri = getReturnPath(\"signedout\");\r\n  var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/logout?post_logout_redirect_uri=${redirect_uri}`;\r\n\r\n  storageProvider.removeItem(ACCESSTOKEN);\r\n  storageProvider.removeItem(ACCESSEXPIRES);\r\n  window.location.href = host;\r\n\r\n  // https://login.microsoftonline.com/{tenant}/oauth2/v2.0/logout?post_logout_redirect_uri=https://localhost/myapp/\r\n}\r\n\r\n/**\r\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\r\n * @param {*} config\r\n * @param {*} callBackNotifyIfInteractionIsRequired\r\n */\r\nexport function authenticate(\r\n  config,\r\n  callBackNotifyIfInteractionIsRequired,\r\n  options\r\n) {\r\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\r\n\r\n  return new Promise((resolve, reject) => {\r\n    var redirect_uri = getReturnPath(\"\");\r\n\r\n    // window.location.pathname;\r\n\r\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\r\n    var client_id = config.clientId;\r\n    var response_type = \"id_token\";\r\n    var response_mode = \"fragment\";\r\n    var scope = config.scopes;\r\n\r\n    var seq = \"\"; // storageProvider.getItem(\"authseq\");\r\n    var search = getSearchParametersFromHash(window.location.href);\r\n\r\n    var search2 = getSearchParametersFromHRef(window.location.href);\r\n\r\n    if (search.id_token) {\r\n      seq = GETACCESSTOKEN;\r\n    } else if (search.access_token) {\r\n      seq = RESTOREURL;\r\n    } else if (search.login) {\r\n      seq = LOGIN;\r\n    } else if (seq === \"\") {\r\n      if (storageProvider.getItem(ACCESSTOKEN)) {\r\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\r\n      } else {\r\n        seq = GETACCESSTOKEN;\r\n        if (callBackNotifyIfInteractionIsRequired) {\r\n          return callBackNotifyIfInteractionIsRequired(null, null, true);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (search.error || search2.error) {\r\n      var e = search.error ? search.error : search2.error;\r\n\r\n      var handled = false;\r\n      switch (e) {\r\n        case \"interaction_required\":\r\n          if (callBackNotifyIfInteractionIsRequired) {\r\n            callBackNotifyIfInteractionIsRequired(search, search2, true);\r\n            return;\r\n          }\r\n          storageProvider.removeItem(\"accesstoken\");\r\n          storageProvider.removeItem(\"idtoken\");\r\n\r\n          var url = `${host}?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\r\n          window.location.href = url;\r\n          return;\r\n          break;\r\n        case \"consent_required\":\r\n          if (callBackNotifyIfInteractionIsRequired) {\r\n            callBackNotifyIfInteractionIsRequired(null, null, true);\r\n          }\r\n          //debugger;\r\n          storageProvider.removeItem(\"accesstoken\");\r\n          storageProvider.removeItem(\"idtoken\");\r\n\r\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\r\n          window.location.href = url;\r\n          return;\r\n          break;\r\n        case \"invalid_request\":\r\n          break;\r\n        case \"unsupported_response_type\":\r\n          break;\r\n        case \"access_denied\":\r\n          break;\r\n        default:\r\n          if (storageProvider.setItem(\"returnto\", \"/\"))\r\n            window.location.href = \"#login\";\r\n          return;\r\n          handled = true;\r\n          break;\r\n      }\r\n      if (!handled) {\r\n        var errorMessage = search.error_description\r\n          ? search.error_description\r\n          : search2.error;\r\n        // alert(errorMessage\r\n\r\n        // );\r\n        //window.location.href = storageProvider.getItem(\"returnto\");\r\n        reject(errorMessage);\r\n        return;\r\n      }\r\n    }\r\n\r\n    switch (seq) {\r\n      case LOGIN:\r\n        storageProvider.setItem(\"returnto\", window.location.href);\r\n\r\n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\r\n        window.location.href = url;\r\n        return;\r\n        break;\r\n      case GETACCESSTOKEN:\r\n        storageProvider.setItem(\"returnto\", window.location.href);\r\n\r\n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\r\n        window.location.href = url;\r\n        return;\r\n        break;\r\n      case GETGRAPHUSER:\r\n        storageProvider.removeItem(\"returnto\");\r\n\r\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\r\n          headers: {\r\n            \"content-type\": \"application/json\",\r\n            authorization: `Bearer ${storageProvider.getItem(ACCESSTOKEN)}`,\r\n          },\r\n        })\r\n          .then((result) => {\r\n            resolve({ user: result.data });\r\n          })\r\n          .catch((error) => {\r\n            //var txt = error.response.data.error.message;\r\n            if (\r\n              error &&\r\n              error.response &&\r\n              error.response.data &&\r\n              error.response.data.error\r\n            ) {\r\n              //alert(error.response.data.error.message)\r\n              resolve({ error: error.response.data.error.message });\r\n            } else {\r\n              resolve({ error });\r\n            }\r\n          });\r\n        break;\r\n\r\n      case RESTOREURL:\r\n        if (search.access_token) {\r\n          storageProvider.setItem(ACCESSTOKEN, search.access_token);\r\n\r\n          var expires = moment().add(search.expires_in, \"s\");\r\n\r\n          storageProvider.setItem(ACCESSEXPIRES, expires.toISOString());\r\n          if (storageProvider.getItem(\"returnto\"))\r\n            window.location.href = storageProvider.getItem(\"returnto\");\r\n          return;\r\n        } else {\r\n          window.location.reload();\r\n        }\r\n        resolve();\r\n        break;\r\n\r\n      default:\r\n        resolve({\r\n          error:\r\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\r\n        });\r\n        break;\r\n    }\r\n  });\r\n}\r\n","\r\n\r\nimport _ from \"lodash\";\r\nimport Axios from \"axios\";\r\n\r\n\r\n\r\nexport function getLicenseForUPN(upn) {\r\n  return new Promise((resolve, reject) => {\r\n    \r\n  if (!upn) return reject(\"Mssing upn\")\r\n  \r\n  \r\n  var s =  _.split(upn,\"@\")\r\n  if (s.length<2) return reject(\"Mssing domain part\")\r\n  var domain = _.toLower( s[1])\r\n\r\n\r\n  Axios\r\n  .get(`https://blob.jumpto365.com/licenses/${domain}.license.json`)\r\n  .then((response) => {\r\n    resolve(response.data);\r\n  })\r\n  .catch((e) => {\r\n    reject(e);\r\n  });\r\n})\r\n}\r\n","import React from \"react\";\r\nimport { Link } from \"office-ui-fabric-react/lib/Link\";\r\nimport {\r\n  DetailsList,\r\n  Selection,\r\n  IColumn,\r\n  buildColumns,\r\n  IColumnReorderOptions,\r\n  IDragDropEvents,\r\n  IDragDropContext,\r\n} from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { MarqueeSelection } from \"office-ui-fabric-react/lib/MarqueeSelection\";\r\nimport { getTheme, mergeStyles } from \"office-ui-fabric-react/lib/Styling\";\r\nimport _ from \"lodash\";\r\nimport {\r\n  CommandBar,\r\n  ICommandBarItemProps,\r\n} from \"office-ui-fabric-react/lib/CommandBar\";\r\nimport { IButtonProps } from \"office-ui-fabric-react/lib/Button\";\r\n\r\nconst overflowProps = { ariaLabel: \"More commands\" };\r\nconst theme = getTheme();\r\nconst margin = \"0 30px 20px 0\";\r\nconst dragEnterClass = mergeStyles({\r\n  backgroundColor: theme.palette.neutralLight,\r\n});\r\nconst controlWrapperClass = mergeStyles({\r\n  display: \"flex\",\r\n  flexWrap: \"wrap\",\r\n});\r\nconst textFieldStyles = {\r\n  root: { margin: margin },\r\n  fieldGroup: { maxWidth: \"100px\" },\r\n};\r\nconst togglesStyles = { root: { margin } };\r\n\r\nexport class DragableDetailsList extends React.Component {\r\n  _selection;\r\n\r\n  _dragDropEvents;\r\n  _draggedItem;\r\n  _draggedIndex;\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (!_.isEqual(prevProps.items, this.props.items)) {\r\n      this.setState({\r\n        items: this.props.items,\r\n        columns: buildColumns(this.props.items, true),\r\n      });\r\n    }\r\n  }\r\n  cmdItems = () => {\r\n    var items = [];\r\n\r\n    switch (this._selection.getSelectedCount()) {\r\n      case 0:\r\n        items = [\r\n          {\r\n            key: \"newItem\",\r\n            text: \"New\",\r\n            cacheKey: \"myCacheKey\", // changing this key will invalidate this item's cache\r\n            iconProps: { iconName: \"Add\" },\r\n            //   subMenuProps: {\r\n            //     items: [\r\n            //       {\r\n            //         key: 'emailMessage',\r\n            //         text: 'Email message',\r\n            //         iconProps: { iconName: 'Mail' },\r\n            //         ['data-automation-id']: 'newEmailButton', // optional\r\n            //       },\r\n            //       {\r\n            //         key: 'calendarEvent',\r\n            //         text: 'Calendar event',\r\n            //         iconProps: { iconName: 'Calendar' },\r\n            //       },\r\n            //     ],\r\n            //   },\r\n          },\r\n          {\r\n            key: \"upload\",\r\n            text: \"Upload\",\r\n            iconProps: { iconName: \"Upload\" },\r\n            href: \"https://developer.microsoft.com/en-us/fluentui\",\r\n          }\r\n          \r\n        ];\r\n        break;\r\n      case 1:\r\n        items = [\r\n          {\r\n            key: \"share\",\r\n            text: \"Share\",\r\n\r\n            iconProps: { iconName: \"Share\" },\r\n            onClick: () => console.log(\"Share\"),\r\n          },\r\n          {\r\n            key: \"download\",\r\n            text: \"Download\",\r\n   \r\n            iconProps: { iconName: \"Download\" },\r\n            onClick: () => console.log(\"Download\"),\r\n          },\r\n         \r\n          {\r\n            key: \"delete\",\r\n            text: \"Delete\",\r\n \r\n            iconProps: { iconName: \"Delete\" },\r\n            onClick: () => console.log(\"Delete\"),\r\n          },\r\n        ];\r\n        break;\r\n      default:\r\n        items = [\r\n          {\r\n            key: \"share\",\r\n            text: \"Share\",\r\n\r\n            iconProps: { iconName: \"Share\" },\r\n            onClick: () => console.log(\"Share\"),\r\n          },\r\n          \r\n          {\r\n            key: \"download\",\r\n            text: \"Download\",\r\n\r\n            iconProps: { iconName: \"Download\" },\r\n            onClick: () => console.log(\"Download\"),\r\n          },\r\n          {\r\n            key: \"delete\",\r\n            text: \"Delete\",\r\n \r\n            iconProps: { iconName: \"Delete\" },\r\n            onClick: () => console.log(\"Delete\"),\r\n          },\r\n        ];\r\n        break;\r\n    }\r\n\r\n    return items;\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    var that = this;\r\n    this._selection = new Selection({\r\n      selectionMode: 2,\r\n      onSelectionChanged: (x, y) => {\r\n        console.log(this._draggedIndex);\r\n        this.setState({ _items: this.cmdItems() });\r\n      },\r\n    });\r\n\r\n    this._dragDropEvents = this._getDragDropEvents();\r\n    this._draggedIndex = -1;\r\n    //const items = [] // createListItems(10, 0);\r\n\r\n    this.state = {\r\n      items: props.items,\r\n      columns: buildColumns(props.items, true),\r\n      isColumnReorderEnabled: false,\r\n      frozenColumnCountFromStart: \"0\",\r\n      frozenColumnCountFromEnd: \"0\",\r\n      _items: this.cmdItems(),\r\n\r\n      _overflowItems: [\r\n        {\r\n          key: \"move\",\r\n          text: \"Move to...\",\r\n          onClick: () => console.log(\"Move to\"),\r\n          iconProps: { iconName: \"MoveToFolder\" },\r\n        },\r\n        {\r\n          key: \"copy\",\r\n          text: \"Copy to...\",\r\n          onClick: () => console.log(\"Copy to\"),\r\n          iconProps: { iconName: \"Copy\" },\r\n        },\r\n        {\r\n          key: \"rename\",\r\n          text: \"Rename...\",\r\n          onClick: () => console.log(\"Rename\"),\r\n          iconProps: { iconName: \"Edit\" },\r\n        },\r\n      ],\r\n\r\n      _farItems: [\r\n        // {\r\n        //   key: \"tile\",\r\n        //   text: \"Grid view\",\r\n        //   // This needs an ariaLabel since it's icon-only\r\n        //   ariaLabel: \"Grid view\",\r\n        //   iconOnly: true,\r\n        //   iconProps: { iconName: \"Tiles\" },\r\n        //   onClick: () => console.log(\"Tiles\"),\r\n        // },\r\n        {\r\n          key: \"info\",\r\n          text: \"Info\",\r\n          // This needs an ariaLabel since it's icon-only\r\n          ariaLabel: \"Info\",\r\n          iconOnly: true,\r\n          iconProps: { iconName: \"Info\" },\r\n          onClick: () => console.log(\"Info\"),\r\n        },\r\n      ],\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      items,\r\n      columns,\r\n      isColumnReorderEnabled,\r\n      frozenColumnCountFromStart,\r\n      frozenColumnCountFromEnd,\r\n      _items,\r\n      _overflowItems,\r\n      _farItems,\r\n    } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <CommandBar\r\n          items={_items}\r\n          overflowItems={_overflowItems}\r\n          overflowButtonProps={overflowProps}\r\n          farItems={_farItems}\r\n          ariaLabel=\"Use left and right arrow keys to navigate between commands\"\r\n        />\r\n        <MarqueeSelection selection={this._selection}>\r\n          <DetailsList\r\n            setKey=\"items\"\r\n            items={items}\r\n            columns={columns}\r\n            selection={this._selection}\r\n            selectionPreservedOnEmptyClick={true}\r\n            onItemInvoked={this._onItemInvoked}\r\n            onRenderItemColumn={this._onRenderItemColumn}\r\n            dragDropEvents={this._dragDropEvents}\r\n            columnReorderOptions={\r\n              this.state.isColumnReorderEnabled\r\n                ? this._getColumnReorderOptions()\r\n                : undefined\r\n            }\r\n            ariaLabelForSelectionColumn=\"Toggle selection\"\r\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\r\n            checkButtonAriaLabel=\"Row checkbox\"\r\n          />\r\n        </MarqueeSelection>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  _handleColumnReorder = (draggedIndex, targetIndex) => {\r\n    const draggedItems = this.state.columns[draggedIndex];\r\n    const newColumns = [...this.state.columns];\r\n\r\n    // insert before the dropped item\r\n    newColumns.splice(draggedIndex, 1);\r\n    newColumns.splice(targetIndex, 0, draggedItems);\r\n    this.setState({ columns: newColumns });\r\n  };\r\n\r\n  _getColumnReorderOptions() {\r\n    return {\r\n      frozenColumnCountFromStart: parseInt(\r\n        this.state.frozenColumnCountFromStart,\r\n        10\r\n      ),\r\n      frozenColumnCountFromEnd: parseInt(\r\n        this.state.frozenColumnCountFromEnd,\r\n        10\r\n      ),\r\n      handleColumnReorder: this._handleColumnReorder,\r\n    };\r\n  }\r\n\r\n  _validateNumber(value) {\r\n    return isNaN(Number(value))\r\n      ? `The value should be a number, actual is ${value}.`\r\n      : \"\";\r\n  }\r\n\r\n  _onChangeStartCountText = (event, text) => {\r\n    this.setState({ frozenColumnCountFromStart: text });\r\n  };\r\n\r\n  _onChangeEndCountText = (event, text) => {\r\n    this.setState({ frozenColumnCountFromEnd: text });\r\n  };\r\n\r\n  _onChangeColumnReorderEnabled = (ev, checked) => {\r\n    this.setState({ isColumnReorderEnabled: checked });\r\n  };\r\n\r\n  _getDragDropEvents() {\r\n    return {\r\n      canDrop: (dropContext, dragContext) => {\r\n        return true;\r\n      },\r\n      canDrag: (item) => {\r\n        return true;\r\n      },\r\n      onDragEnter: (item, event) => {\r\n        // return string is the css classes that will be added to the entering element.\r\n        return dragEnterClass;\r\n      },\r\n      onDragLeave: (item, event) => {\r\n        return;\r\n      },\r\n      onDrop: (item, event) => {\r\n        if (this._draggedItem) {\r\n          this._insertBeforeItem(item);\r\n        }\r\n      },\r\n      onDragStart: (item, itemIndex, selectedItems, event) => {\r\n        this._draggedItem = item;\r\n        this._draggedIndex = itemIndex;\r\n      },\r\n      onDragEnd: (item, event) => {\r\n        this._draggedItem = undefined;\r\n        this._draggedIndex = -1;\r\n      },\r\n    };\r\n  }\r\n\r\n  _onItemInvoked = (item) => {\r\n    alert(`Item invoked: ${item.name}`);\r\n  };\r\n\r\n  _onRenderItemColumn = (item, index, column) => {\r\n    const key = column.key;\r\n    if (key === \"name\") {\r\n      return <Link data-selection-invoke={true}>{item[key]}</Link>;\r\n    }\r\n\r\n    return String(item[key]);\r\n  };\r\n\r\n  _insertBeforeItem(item) {\r\n    const draggedItems = this._selection.isIndexSelected(this._draggedIndex)\r\n      ? this._selection.getSelection()\r\n      : [this._draggedItem];\r\n\r\n    const insertIndex = this.state.items.indexOf(item);\r\n    const items = this.state.items.filter(\r\n      (itm) => draggedItems.indexOf(itm) === -1\r\n    );\r\n\r\n    items.splice(insertIndex, 0, ...draggedItems);\r\n\r\n    this.setState({ items });\r\n  }\r\n}\r\n","import * as React from \"react\";\r\n\r\nlet UserContext = React.createContext();\r\n\r\nlet initialState = {\r\n  user: {},\r\n  license:{}\r\n};\r\n\r\nlet reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"reset\":\r\n      return initialState;\r\n    case \"increment\":\r\n      return { ...state, count: state.count + 1 };\r\n    case \"decrement\":\r\n      return { ...state, count: state.count - 1 };\r\n    case \"set-color\":\r\n      return { ...state, currentColor: action.payload };\r\n  }\r\n};\r\n\r\nfunction UserContextProvider(props) {\r\n  // [A]\r\n  let [state, dispatch] = React.useReducer(reducer, initialState);\r\n  let value = { state, dispatch };\r\n\r\n\r\n  // [B]\r\n  return (\r\n    <UserContext.Provider value={value}>{props.children}</UserContext.Provider>\r\n  );\r\n}\r\n\r\nlet UserContextConsumer = UserContext.Consumer;\r\n\r\n// [C]\r\nexport { UserContext , UserContextProvider , UserContextConsumer  };","import React, { useEffect, useState, useRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport Home from \"./Home\";\r\nimport Onboard from \"./Onboard\";\r\nimport config from \"./config\";\r\nimport {\r\n  authenticate,\r\n  signOut,\r\n  getAdminConsent,\r\n  selectAccount,\r\n} from \"./authenticate\";\r\nimport { getLicenseForUPN } from \"./helpers/License\";\r\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\";\r\nimport {\r\n  Customizer,\r\n  mergeStyles,\r\n  Fabric,\r\n  classNamesFunction,\r\n} from \"office-ui-fabric-react\";\r\nimport { loadTheme } from \"@fluentui/react\";\r\nimport { EVENT, who, trace } from \"./helpers/trace\";\r\n\r\nimport { Router, Link, navigate } from \"@reach/router\";\r\nimport {\r\n  MessageBarButton,\r\n  DefaultButton,\r\n} from \"office-ui-fabric-react/lib/Button\";\r\nimport Boards from \"./containers/Boards\";\r\nimport { indexLaunzhBoards } from \"./helpers/LaunchPad\";\r\nimport { UserContext } from \"./helpers/UserContext\";\r\nimport { inIframe} from \"./helpers\";\r\nimport {\r\n \r\n  \r\n  MessageBar,\r\n  MessageBarType,\r\n  ChoiceGroup,\r\n  IStackProps,\r\n} from \"office-ui-fabric-react\";\r\nexport default class ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    // Update state so the next render will show the fallback UI.\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    // You can also log the error to an error reporting service\r\n    this.setState({ error, info });\r\n    console.log(\"componentDidCatch\", error, info);\r\n    //logErrorToMyService(error, info);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      // You can render any custom fallback UI\r\n      return (\r\n        <div className=\"pageBody\">\r\n          <h1 className=\"errorCenterHeader\">\r\n            Sorry! Something not working as expected\r\n          </h1>\r\n          {this.state.error && this.state.error.message && (\r\n            <h2>{this.state.error.message}</h2>\r\n          )}\r\n          <div className=\"errorCenterHeader\">\r\n            <div>\r\n              <DefaultButton\r\n                style={{ margin: \"16px\", width: \"300px\" }}\r\n                primary\r\n                text=\"Visit our Help Center\"\r\n                onClick={() => {\r\n                  window.open(\r\n                    \"https://jumpto365.zendesk.com/hc/en-us\",\r\n                    \"_blank\"\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n            <div>\r\n              <DefaultButton\r\n                style={{ margin: \"16px\", width: \"300px\" }}\r\n                text=\"Check service availabiliy\"\r\n                onClick={() => {\r\n                  window.open(\"https://uptime.com/s/overview\", \"_blank\");\r\n                }}\r\n              />\r\n            </div>\r\n            {/* <div>\r\n              <DefaultButton\r\n                style={{ margin: \"16px\", width: \"300px\" }}\r\n                text=\"File a support request\"\r\n                onClick={() => {\r\n                  if (window.zE) {\r\n                    zE(function() {\r\n                      debugger;\r\n                    });\r\n                  }\r\n                }}\r\n              />\r\n            </div> */}\r\n\r\n            <div>\r\n              <DefaultButton\r\n                style={{ margin: \"16px\", width: \"300px\" }}\r\n                text=\"View error details\"\r\n                onClick={() => {\r\n                  this.setState({ viewDetails: true });\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          {this.state.info &&\r\n          this.state.info.componentStack &&\r\n          this.state.viewDetails ? (\r\n            <div>\r\n              <textarea\r\n                style={{ width: \"100%\" }}\r\n                readOnly\r\n                rows=\"30\"\r\n                cols=\"80\"\r\n                value={this.state.info.componentStack}\r\n              />{\" \"}\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nvar x = loadTheme({\r\n  defaultFontStyle: {\r\n    fontFamily: \"Monaco, Menlo, Consolas\",\r\n    fontWeight: \"regular\",\r\n  },\r\n  fonts: {\r\n    small: {\r\n      fontSize: \"11px\",\r\n    },\r\n    medium: {\r\n      fontSize: \"13px\",\r\n    },\r\n    large: {\r\n      fontSize: \"20px\",\r\n      fontWeight: \"semibold\",\r\n    },\r\n    xLarge: {\r\n      fontSize: \"22px\",\r\n      fontWeight: \"semibold\",\r\n    },\r\n  },\r\n});\r\n\r\n// // Inject some global styles\r\n// mergeStyles({\r\n//   selectors: {\r\n//     ':global(body), :global(html), :global(#root)': {\r\n//       margin: 0,\r\n//       padding: 0,\r\n//       height: '100vh'\r\n//     }\r\n//   }\r\n// });\r\n\r\nfunction showException(props) {\r\n  ReactDOM.render(\r\n    <Customizer {...FluentCustomizations}>\r\n      <Fabric theme={x}>\r\n        <ErrorBoundary>\r\n          <div\r\n            style={{\r\n              marginTop: \"100px\",\r\n              maxWidth: \"1024px\",\r\n              marginLeft: \"auto\",\r\n              marginRight: \"auto\",\r\n            }}\r\n          >\r\n            <h1> Sorry, can't get you in</h1>\r\n            <h3>{props && props.errorMessage}</h3>\r\n            <p>\r\n              The following checks might give you and indication of what is\r\n              wrong\r\n            </p>\r\n            <Onboard />\r\n            <p>Suggested actions</p>\r\n            <DefaultButton\r\n              onClick={() => {\r\n                localStorage.clear();\r\n                sessionStorage.clear();\r\n                window.location.href = \"/\";\r\n              }}\r\n            >\r\n              Clear cache and login\r\n            </DefaultButton>\r\n          </div>\r\n        </ErrorBoundary>\r\n      </Fabric>\r\n    </Customizer>,\r\n    document.getElementById(\"root\")\r\n  );\r\n}\r\n\r\nfunction Container(props) {\r\n  return (\r\n    <div style={{ minHeight: \"100vh\", minWidth: \"100vw\" }}>\r\n      <div\r\n        style={{ maxWidth: \"1200px\", marginLeft: \"auto\", marginRight: \"auto\" }}\r\n      >\r\n        {props.children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction GotoDefault() {\r\n\r\n  window.location.href = \"/home\";\r\n  return null\r\n}\r\n\r\n\r\nfunction GetAdminConsented() {\r\n  getAdminConsent();\r\n  return null;\r\n}\r\nfunction AdminConsented() {\r\n  return <Container>Thank you for the consent\"</Container>;\r\n}\r\nfunction SignedOut() {\r\n  return <Container>You have been signed out</Container>;\r\n}\r\nfunction SignOut() {\r\n  signOut();\r\n  return null;\r\n}\r\nfunction SelectAccount() {\r\n  selectAccount();\r\n  return null;\r\n}\r\nfunction NoPage() {\r\n  return <Container>Page not found</Container>;\r\n}\r\n\r\nfunction Autorized(props) {\r\n  if (!props && !props.auth) {\r\n    window.location.href = \"/signin?returnto=\" + window.location.href;\r\n    return null;\r\n  }\r\n  return props.children;\r\n}\r\n\r\nfunction NoLicense() {\r\n  useEffect(() => {\r\n    return () => {\r\n      if (window.Chargebee) {\r\n        window.Chargebee.registerAgain();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <Container>\r\n      <a href=\"https://www.jumpto365.com/get-launzh#price\" target=\"_blank\">\r\n        Get a license\r\n      </a>\r\n    </Container>\r\n  );\r\n}\r\nfunction LicenseExpired() {\r\n  return <Container>LicenseExpired</Container>;\r\n}\r\nfunction ShowLicense(props) {\r\n  return <Container>{JSON.stringify(props.license)}</Container>;\r\n}\r\nfunction Debug() {\r\n  return (\r\n    <Container>\r\n      <div>\r\n        <div>\r\n          <a href=\"/getadminconsent\">Get Admin Consent</a>{\" \"}\r\n        </div>\r\n        <div>\r\n          <a href=\"/signout\">Sign Out</a>{\" \"}\r\n        </div>\r\n        <div>\r\n          <a href=\"/selectaccount\">Select Account</a>{\" \"}\r\n        </div>\r\n        <div></div>\r\n        <div></div>\r\n        <div></div>\r\n        <div></div>\r\n      </div>\r\n    </Container>\r\n  );\r\n}\r\nfunction InteractionRequired(props){\r\n  const [showWarning, setShowWarning] = useState(true);\r\n \r\n  if (!props.interactionRequired) return null\r\n  return  <div style={{position:\"fixed\",width:\"100vw\",zIndex:10}}>\r\n  <MessageBar\r\n  messageBarType={MessageBarType.error}\r\n  isMultiline={false}\r\n  onDismiss={() => {\r\n    setShowWarning(false);\r\n  }}\r\n  dismissButtonAriaLabel=\"Close\"\r\n  actions={\r\n    <div>\r\n      {!inIframe() && \r\n      <MessageBarButton\r\n        onClick={() => {\r\n        \r\n          selectAccount();\r\n          \r\n        }}\r\n      >\r\n        {\" \"}\r\n\r\n       Sign in\r\n      </MessageBarButton>\r\n      }\r\n\r\n      {inIframe() && \r\n      <>\r\n      <a href=\"#\" target=\"_blank\">Open in new tab and sign in</a>\r\n{false && \r\n      <MessageBarButton\r\n        onClick={() => {\r\n          debugger\r\n          window.Office.context.ui.displayDialogAsync('https://localhost:3002'); \r\n          //window.location.reload();\r\n          \r\n        }}\r\n      >\r\n        {\" \"}\r\n\r\n       Reload\r\n      </MessageBarButton>\r\n    }\r\n      </>\r\n      }\r\n    </div>\r\n  }\r\n>\r\n We need to sign you in\r\n</MessageBar></div>\r\n}\r\nfunction getUserAndLicense() {\r\n  return new Promise(async (resolve, reject) => {\r\n    var auth = await authenticate(config, (search, search2,interactionRequired) => {\r\n\r\n      return resolve({interactionRequired})\r\n      var errorMessage =\r\n        search && search.error_description\r\n          ? search.error_description\r\n          : search2 && search2.error_description\r\n          ? search2 && search2.error_description\r\n          : \"Unknown error\";\r\n      showException({ errorMessage });\r\n      // this is where you can send a signal to a host that intercati ons is required\r\n    }).catch((error) => {\r\n      reject(error);\r\n    });\r\n    if (!auth) return;\r\n\r\n    var license = await getLicenseForUPN(auth && auth.user ? auth.user.userPrincipalName : null).catch(\r\n      (e) => {\r\n        console.log(\"getLicenseForUPN\", e);\r\n      }\r\n    );\r\n\r\n    who(auth.user.userPrincipalName);\r\n    const key = \"HASLANDED\";\r\n\r\n    var landed = sessionStorage.getItem(key);\r\n    if (!landed) {\r\n      trace(EVENT.LANDING);\r\n      sessionStorage.setItem(key, \"1\");\r\n    }\r\n    resolve({auth, license});\r\n  });\r\n}\r\n\r\nfunction SpeedDateApp() {\r\n  const [auth, setAuth] = useState(null);\r\n\r\n  const [license, setLicense] = useState(null);\r\n  const [interactionRequired, setInteractionRequired] = useState(false);\r\n  // let { userContext, dispatch } = React.useContext(UserContext);\r\n  useEffect(() => {\r\n \r\n      getUserAndLicense()\r\n      .then((result) => {\r\n        \r\n        if (result.interactionRequired){\r\n          setInteractionRequired(true)\r\n        }else{\r\n          setAuth(result.auth);\r\n          setLicense(result.license);\r\n        }\r\n        \r\n       \r\n      })\r\n      .catch((error) => {\r\n        console.log(\"getUserAndLicense\", error);\r\n      });\r\n    \r\n  }, [])\r\nreturn (\r\n  <Customizer {...FluentCustomizations}>\r\n  <Fabric theme={x}>\r\n\r\n  <ErrorBoundary>\r\n        <InteractionRequired interactionRequired={interactionRequired}/>\r\n          <Router>\r\n          <Onboard path=\"/check\" />\r\n            <GotoDefault auth={auth} path=\"/\" />\r\n            <Home auth={auth} path=\"/home\" />\r\n            <App auth={auth} path=\"/board/:board\" signOut={signOut} />\r\n            <GetAdminConsented path=\"/getadminconsent\" />\r\n            <AdminConsented path=\"/adminconsented\" />\r\n            <SignedOut path=\"/signedout\" />\r\n            <SignOut path=\"/signout\" />\r\n            <Debug path=\"/debug\" />\r\n            <NoPage default />\r\n          </Router>\r\n        </ErrorBoundary>\r\n  </Fabric>\r\n  </Customizer>\r\n\r\n  )\r\n/*\r\n  return (\r\n    <Customizer {...FluentCustomizations}>\r\n      <Fabric theme={x}>\r\n        <ErrorBoundary>\r\n        <InteractionRequired interactionRequired={interactionRequired}/>\r\n          <Router>\r\n            <Onboard path=\"/check\" />\r\n            <Boards path=\"/boards\" />\r\n            <GotoDefault path=\"/\" />\r\n            <App auth={auth} path=\"/board/:board\" signOut={signOut} />\r\n            <GetAdminConsented path=\"/getadminconsent\" />\r\n            <AdminConsented path=\"/adminconsented\" />\r\n            <SignedOut path=\"/signedout\" />\r\n            <SignOut path=\"/signout\" />\r\n            <SelectAccount path=\"/selectaccount\" />\r\n            <ShowLicense path=\"/license\" license={license} />\r\n            <NoLicense path=\"/no-license\" />\r\n            <LicenseExpired path=\"/license-expired\" license={license} />\r\n            <Debug path=\"/debug\" />\r\n            <NoPage default />\r\n          </Router>\r\n        </ErrorBoundary>\r\n      </Fabric>\r\n    </Customizer>\r\n  );\r\n  */\r\n}\r\n\r\nasync function start() {\r\n  ReactDOM.render(<SpeedDateApp />, document.getElementById(\"root\"));\r\n}\r\nif (window.Office) window.Office.initialize = () =>{\r\n  console.log(\"Office running\")\r\n}\r\nstart();\r\n","import React from \"react\";\r\nimport _ from \"lodash\";\r\nimport ReactGridLayout, { Responsive } from \"react-grid-layout\";\r\nimport \"./Toolbox.css\";\r\nimport WidthProvider from \"./WidthProvider\"\r\n\r\n\r\nexport const breakpoints = {lg: 1200, md: 996, sm: 768, xs: 480, xxs: 240}\r\nvar ResponsiveReactGridLayout\r\nexport default class ToolboxLayout extends React.Component {\r\n  static defaultProps = {\r\n    className: \"layout\",\r\n    rowHeight: 30,\r\n    onLayoutChange: function () {},\r\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\r\n    initialLayout: generateLayout(),\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    ResponsiveReactGridLayout = WidthProvider(Responsive,props.fixedWidth);\r\n    this.state = {\r\n      currentBreakpoint: \"lg\",\r\n      compactType: \"vertical\",\r\n      mounted: false,\r\n      // layouts: props.layouts\r\n      //   ? props.layouts\r\n      //   : {\r\n      //       lg: props.tools\r\n      //         ? props.tools.map((tool, ix) => {\r\n      //             return {\r\n      //               x: 0,\r\n      //               y: ix,\r\n      //               w: 3,\r\n      //               h: 3,\r\n\r\n      //               i: ix.toString(),\r\n\r\n      //               static: 0, //Math.random() < 0.05,\r\n      //             };\r\n      //           })\r\n      //         : props.initialLayout,\r\n      //     },\r\n      toolbox: { lg: [] },\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setState({ mounted: true });\r\n  }\r\n\r\n  generateDOM(x,y) {\r\n    var that = this;\r\n    \r\n    return _.map(this.props.layouts[this.state.currentBreakpoint], (l) => {\r\n      \r\n      var tile =\r\n        that.props.tools && that.props.tools[l.i] && that.props.tools[l.i].tile\r\n          ? that.props.tools[l.i].tile\r\n          : { title: l.i };\r\n          {var refresh = Date.now()}\r\n      return (\r\n        <div\r\n          style={{\r\n            backgroundColor: tile.color,\r\n            color: tile.textcolor,\r\n            cursor: !this.props.editingLayout ? \"pointer\" : \"default\",\r\n            overflow:\"hidden\"\r\n          }}\r\n          // onClick={() => {\r\n          //   if (this.props.onTileClick && !this.props.editingLayout) {\r\n          //     this.props.onTileClick(tile);\r\n          //   }\r\n          // }}\r\n          key={l.i}\r\n\r\n          data-grid={{w:l.w,h:l.h,x:l.x,y:l.y}}\r\n          className={l.static ? \"static\" : \"\"}\r\n        >\r\n       \r\n          <span >\r\n          \r\n        {/* {refresh} {l.w}x{l.h} */}\r\n            {that.props.getPin(l.i,l.w,l.h,refresh)} \r\n            </span>\r\n        </div>\r\n      );\r\n    });\r\n  }\r\n\r\n  onBreakpointChange = (breakpoint) => {\r\n    this.setState((prevState) => ({\r\n      currentBreakpoint: breakpoint,\r\n      toolbox: {\r\n        ...prevState.toolbox,\r\n        [breakpoint]:\r\n          prevState.toolbox[breakpoint] ||\r\n          prevState.toolbox[prevState.currentBreakpoint] ||\r\n          [],\r\n      },\r\n    }));\r\n  };\r\n\r\n  onCompactTypeChange = () => {\r\n    const { compactType: oldCompactType } = this.state;\r\n    const compactType =\r\n      oldCompactType === \"horizontal\"\r\n        ? \"vertical\"\r\n        : oldCompactType === \"vertical\"\r\n        ? null\r\n        : \"horizontal\";\r\n    this.setState({ compactType });\r\n  };\r\n\r\n  onTakeItem = (item) => {\r\n    this.setState((prevState) => ({\r\n      toolbox: {\r\n        ...prevState.toolbox,\r\n        [prevState.currentBreakpoint]: prevState.toolbox[\r\n          prevState.currentBreakpoint\r\n        ].filter(({ i }) => i !== item.i),\r\n      },\r\n      layouts: {\r\n        ...prevState.layouts,\r\n        [prevState.currentBreakpoint]: [\r\n          ...prevState.layouts[prevState.currentBreakpoint],\r\n          item,\r\n        ],\r\n      },\r\n    }));\r\n  };\r\n\r\n  onPutItem = (item) => {\r\n    this.setState((prevState) => {\r\n      return {\r\n        toolbox: {\r\n          ...prevState.toolbox,\r\n          [prevState.currentBreakpoint]: [\r\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\r\n            item,\r\n          ],\r\n        },\r\n        layouts: {\r\n          ...prevState.layouts,\r\n          [prevState.currentBreakpoint]: prevState.layouts[\r\n            prevState.currentBreakpoint\r\n          ].filter(({ i }) => i !== item.i),\r\n        },\r\n      };\r\n    });\r\n  };\r\n\r\n  onLayoutChange = (layout, layouts) => {\r\n    saveToLS(\"layouts\", layouts);\r\n\r\n    if (this.props.persist) {\r\n      this.props.persist(layouts);\r\n    }\r\n    this.setState({ layouts });\r\n  };\r\n\r\n  onNewLayout = () => {\r\n    this.setState({\r\n      layouts: { lg: generateLayout() },\r\n    });\r\n  };\r\n  onResize = () =>{\r\n    if (!this.props.tools) return\r\n    \r\n    this.props.tools.forEach(tool => {\r\n      if (tool.onResize) tool.onResize()\r\n    });\r\n\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        {/* <div>\r\n          Current Breakpoint: {this.state.currentBreakpoint} (\r\n          {this.props.cols[this.state.currentBreakpoint]} columns)\r\n        </div>\r\n        <div>\r\n          Compaction type:{\" \"}\r\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\r\n        </div>\r\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\r\n        <button onClick={this.onCompactTypeChange}>\r\n          Change Compaction Type\r\n        </button> */}\r\n\r\n        {/* <ToolBox\r\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\r\n          onTakeItem={this.onTakeItem}\r\n        /> */}\r\n\r\n        <ResponsiveReactGridLayout\r\n       \r\n         breakpoints={breakpoints }\r\n         cols={{lg: 12, md: 10, sm: 6, xs: 4, xxs: 2}}\r\n          {...this.props}\r\n          margin={[0,0]}\r\n          containerPadding={[0,0]}\r\n\r\n          layouts={this.props.layouts}\r\n          onBreakpointChange={this.onBreakpointChange}\r\n          onLayoutChange={this.onLayoutChange}\r\n          // WidthProvider option\r\n          measureBeforeMount={false}\r\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\r\n          // and set `measureBeforeMount={true}`.\r\n          useCSSTransforms={true}\r\n          compactType={this.state.compactType}\r\n          preventCollision={!this.state.compactType}\r\n          onResize={this.onResize}\r\n          isDraggable={this.props.editMode}\r\n          isResizable={this.props.editMode}\r\n        >\r\n          {this.generateDOM(this)}\r\n        </ResponsiveReactGridLayout>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nfunction getFromLS(key) {\r\n  let ls = {};\r\n  if (global.localStorage) {\r\n    try {\r\n      ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\r\n    } catch (e) {\r\n      /*Ignore*/\r\n    }\r\n  }\r\n  return ls[key];\r\n}\r\n\r\nfunction saveToLS(key, value) {\r\n  if (global.localStorage) {\r\n    global.localStorage.setItem(\r\n      \"rgl-8\",\r\n      JSON.stringify({\r\n        [key]: value,\r\n      })\r\n    );\r\n  }\r\n}\r\nfunction generateLayout() {\r\n  return _.map(_.range(0, 25), function (item, i) {\r\n    var y = Math.ceil(Math.random() * 4) + 1;\r\n    return {\r\n      x: (_.random(0, 5) * 2) % 12,\r\n      y: Math.floor(i / 6) * y,\r\n      w: 2,\r\n      h: y,\r\n      i: i.toString(),\r\n      static: Math.random() < 0.05,\r\n    };\r\n  });\r\n}\r\n"],"sourceRoot":""}